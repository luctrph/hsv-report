<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.20.0.final using JasperReports Library version 6.20.0-2bc7ab61c56f459e8176eb05c7705e145cd400ad  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Rpt_BCQuanTriGiaThanhNgao" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="842" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="4023df51-1b73-46d9-adf6-650e3c9f2034">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="psql"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
	<parameter name="StartDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date(100,0,1)]]></defaultValueExpression>
	</parameter>
	<parameter name="EndDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date(100,0,1)]]></defaultValueExpression>
	</parameter>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[1000000]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["dev/"]]></defaultValueExpression>
	</parameter>
	<parameter name="EXPORT_TYPE" class="java.lang.String"/>
	<parameter name="AD_Org_ID" class="java.lang.Integer"/>
	<queryString language="SQL">
		<![CDATA[select l.description,cast(l.value as integer) as value,l.name,sum(t.cp) as cp,sum(t.cp1) as cp1
			,sum(case when t.nhom='I' then t.slb else case when t.nhom='II' then l.hsv_dinhmuc else l.hsv_dinhmuc end end ) as slb
			,sum(case when t.nhom='I' then t.slb1 else case when t.nhom='II' then l.hsv_dinhmuc1 else l.hsv_dinhmuc1 end end ) as slb1
			,sum(case when t.nhom='I' then t.slb5 else case when t.nhom='II' then l.hsv_dinhmuc05 else l.hsv_dinhmuc05  end end ) as slb5
			--Cot de cong
			,sum( case when t.nhom in ('II','III') then l.hsv_dinhmuc  else 0 end ) as slbc
			,sum(case when t.nhom in ('II','III') then l.hsv_dinhmuc1 else 0 end ) as slbc1
			,sum( case when t.nhom in ('II','III') then l.hsv_dinhmuc05  else 0 end ) as slbc5
			
			,sum(case when t.nhom='I' then 0 else case when t.nhom='II' and t.chitieu<>'17' and t.chitieu<>'18' then l.hsv_dinhmuc*sx.slb+l.hsv_dinhmuc1*sx.slb1+l.hsv_dinhmuc05*sx.slb5 else l.hsv_dinhmuc*xb.slb+l.hsv_dinhmuc1*xb.slb1+l.hsv_dinhmuc05*xb.slb5 end end ) as tdm
, sum(case when l.value = '2' then t.slb end) as a1,
sum(case when l.value = '2' then t.slb1 end) as a2,
sum(case when l.value ='2' then t.slb5 end) as a3
from (  select 'I' as nhom,'1' as chitieu,0 as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1  from ad_client where ad_client_id=1000003

		union all
--Chi tieu so 2 so luong san xuat		
		select 'I' as nhom,'2' as chitieu,0 as cp,COALESCE(sum(t.slb),0) as slb,COALESCE(sum(t.slb1),0) as slb1,COALESCE(sum(t.slb5),0) as slb5,0 as cp1
		from(select distinct pl.m_productionplan_id as m_productionline_id,pl.m_product_id,pl.productionqty as slb,0 as slb1,0 as slb5,pl.m_attributesetinstance_id 
        			from m_productionplan pl
					join m_product hh on pl.m_product_id=hh.m_product_id and  hh.M_AttributeSet_ID=1000000 
					join m_production p on pl.m_production_id=p.m_production_id  and p.docstatus in ('CO','CL') and  (p.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
												AND p.movementdate>=$P{StartDate} and p.movementdate<=$P{EndDate}
					join (select tt.m_attributesetinstance_id from m_attributeinstance tt
	              join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000013 and gtt.m_attribute_id=1000001 
	              WHERE tt.ad_client_id=1000003 
					     ) tt on pl.m_attributesetinstance_id=tt.m_attributesetinstance_id
					where  pl.ad_client_id=1000003 
				
				union all
				
				select distinct pl.m_productionplan_id as m_productionline_id,pl.m_product_id,0 as slb,pl.productionqty as slb1,0 as slb5,pl.m_attributesetinstance_id 
                from m_productionplan pl
				join m_product hh on pl.m_product_id=hh.m_product_id and  hh.M_AttributeSet_ID=1000000 
				join m_production p on pl.m_production_id=p.m_production_id  and p.docstatus in ('CO','CL') and  (p.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
											AND p.movementdate>=$P{StartDate} and p.movementdate<=$P{EndDate}
				join (select tt.m_attributesetinstance_id from m_attributeinstance tt
              join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000005 and gtt.m_attribute_id=1000001 
              WHERE tt.ad_client_id=1000003 
				     ) tt on pl.m_attributesetinstance_id=tt.m_attributesetinstance_id
				where  pl.ad_client_id=1000003 
				
				union all
				
				select distinct pl.m_productionplan_id as m_productionline_id,pl.m_product_id,0 as slb,0 as slb1,pl.productionqty as slb5,pl.m_attributesetinstance_id 
                from m_productionplan pl
				join m_product hh on pl.m_product_id=hh.m_product_id and  hh.M_AttributeSet_ID=1000000 
				join m_production p on pl.m_production_id=p.m_production_id  and p.docstatus in ('CO','CL') and  (p.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
							AND p.movementdate>=$P{StartDate} and p.movementdate<=$P{EndDate}
				join (select tt.m_attributesetinstance_id from m_attributeinstance tt
              join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id in('1000006','1000007','1000019') and gtt.m_attribute_id=1000001 
              WHERE tt.ad_client_id=1000003 
				     ) tt on pl.m_attributesetinstance_id=tt.m_attributesetinstance_id
				where  pl.ad_client_id=1000003 

			) as t

		union all
--Chi tieu so 3 so luong xuat ban
		select 'I' as nhom,'3' as chitieu,0 as cp,COALESCE(sum(t.slb),0) as slb,COALESCE(sum(t.slb1),0) as slb1,COALESCE(sum(t.slb5),0) as slb5,0 as cp1
		from(select COALESCE(sum(io.movementqty),0) as slb,0 as slb1,0 as slb5,'3' as chitieu	from m_inoutline io 
      		join m_inout iol on io.m_inout_id=iol.m_inout_id and iol.docstatus in ('CO','CL') and iol.C_DocType_ID=1000152
        			AND iol.movementdate>=$P{StartDate} and iol.movementdate<=$P{EndDate}and  (iol.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
      		join m_product hh on io.m_product_id=hh.m_product_id and hh. M_AttributeSet_ID=1000000
          join (select tt.m_attributesetinstance_id from m_attributeinstance tt
                join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000013 and gtt.m_attribute_id=1000001 
                WHERE tt.ad_client_id=1000003 
				        ) tt on IO.m_attributesetinstance_id=tt.m_attributesetinstance_id
				   where io.ad_client_id=1000003 
				   
          union all
           
          select 0 as slb,COALESCE(sum(io.movementqty),0) as slb1,0 as slb5,'3' as chitieu	from m_inoutline io 
      		join m_inout iol on io.m_inout_id=iol.m_inout_id and iol.docstatus in ('CO','CL') and iol.C_DocType_ID=1000152
        			AND iol.movementdate>=$P{StartDate} and iol.movementdate<=$P{EndDate} and  (iol.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
      		join m_product hh on io.m_product_id=hh.m_product_id and hh. M_AttributeSet_ID=1000000
          join (select tt.m_attributesetinstance_id from m_attributeinstance tt
                join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000005 and gtt.m_attribute_id=1000001 
                WHERE tt.ad_client_id=1000003 
				        ) tt on IO.m_attributesetinstance_id=tt.m_attributesetinstance_id
				   where io.ad_client_id=1000003  

          union all
           
          select 0 as slb,0 as slb1,COALESCE(sum(io.movementqty),0) as slb5,'3' as chitieu	from m_inoutline io 
      		join m_inout iol on io.m_inout_id=iol.m_inout_id and iol.docstatus in ('CO','CL') and iol.C_DocType_ID=1000152
        			AND iol.movementdate>=$P{StartDate} and iol.movementdate<=$P{EndDate} and  (iol.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
      		join m_product hh on io.m_product_id=hh.m_product_id and hh. M_AttributeSet_ID=1000000
          join (select tt.m_attributesetinstance_id from m_attributeinstance tt
                join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id in('1000006','1000007','1000019') and gtt.m_attribute_id=1000001 
                WHERE tt.ad_client_id=1000003 
				        ) tt on IO.m_attributesetinstance_id=tt.m_attributesetinstance_id
				   where io.ad_client_id=1000003  

        ) as t
        
        union all
--Chi tieu so 4 
        select 'I' as nhom,'4' as chitieu,0 as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1  from ad_client where ad_client_id=1000003
        
        union all
--Chi tieu so 5: chi phi san xuat
        select 'I' as nhom,'5' as chitieu,0 as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1  from ad_client where ad_client_id=1000003
        
--Chi tieu so 6: chi phi thu mua tai khoan 6276
        union all
        
        select 'II' as nhom,	'6' as chitieu,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224						
					
					        union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6276')

--Chi tieu so 7: Chi phi tien dien tai khoan 6275

        union all
        
        select 	'II' as nhom,'7' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003')and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=318 and Fact_Acct.C_BPartner_ID in ('1000147','1000741')
					
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6275')

--Chi tieu so 8: chi phi tien nuoc tai khoan 6275 voi khach hang la C_BPartner_ID=1000247
		
        union all
        
        select 	'II' as nhom,'8' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=318 and Fact_Acct.C_BPartner_ID in ('1000247')
					
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6275')

--chi tieu so 9:Chi phi than dot lo bang phat sinh tai khoan 6275-chi phi dien, nuoc
        union all
        
        select 	'II' as nhom,'9' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
					        union all
					        -- tru di chi phi dien
					        SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=318 and Fact_Acct.C_BPartner_ID in ('1000147','1000741')
					          
                  union all
                  -- tru di chi phi tien nuoc				

					        SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=318 and Fact_Acct.C_BPartner_ID in ('1000247','1000')
					          				
                  union all						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6275')

--Chi tieu so 10: bao bi PA(gom ca truc in) xuat kho su dung voi M_PartType_ID=1000076

      union all
      
      select 	'II' as nhom,'10' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctcr ),0) as cp1
		  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000076
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t
--Chi tieu so 11: Bao bi PE voi xuat kho su dung voi M_PartType_ID=1000077
      union all
      
      select 	'II' as nhom,'11' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctcr ),0) as cp1
		  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000077
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t
		
--Chi tieu so 12: Bao bi tem nhan voi xuat kho su dung voi M_PartType_ID=1000078
      union all
      
      select 	'II' as nhom,'12' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctcr ),0) as cp1
		  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000078
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t
						 

--Chi tieu so 13: Bao bi carton voi xuat kho su dung voi M_PartType_ID=1000079
      union all
      
      select 	'II' as nhom,'13' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctcr ),0) as cp1
		  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000079
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t

--Chi tieu so 14: Bao bi xop dem voi xuat kho su dung voi M_PartType_ID=1000080
      union all
      
      select 	'II' as nhom,'14' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctcr ),0) as cp1
		  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000080
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t

--Chi tieu so 15: Bao bi PE voi xuat kho su dung voi M_PartType_ID=1000081
      union all
      
      select 	'II' as nhom,'15' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctcr ),0) as cp1
		  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000081
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t
--Chi tieu so 16: Vat tu khac bang phat sinh tai khoan 6272,6278 tru chi chi tieu 10,11,12,13,14,15
          
        union all
      
        select 	'II' as nhom,'16' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
					        union all
					        -- tru di chi phi chi tieu 10
                  SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
              		FROM Fact_Acct 
    					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
    					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000076
                  WHERE  
    					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
    					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
    					          				and Fact_Acct.ad_table_id=321 
                  union all
                  -- tru di chi phi chi tieu 11				

                  SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
              		FROM Fact_Acct 
    					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
    					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000077
                  WHERE  
    					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
    					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
    					          				and Fact_Acct.ad_table_id=321 
    					          				
                  union all						 
                  --Tru di chi phi chi tieu 12
                  SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
              		FROM Fact_Acct 
    					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
    					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000078
                  WHERE  
    					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
    					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
    					          				and Fact_Acct.ad_table_id=321 
    					          				
                  union all
                  --Tru di chi phi chi tieu 13
                  SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
              		FROM Fact_Acct 
    					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
    					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000079
                  WHERE  
    					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
    					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
    					          				and Fact_Acct.ad_table_id=321 
    					          				
                  union all
                  --tru di chi phi chi tieu 14
                  SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
              		FROM Fact_Acct 
    					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
    					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000080
                  WHERE  
    					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
    					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
    					          				and Fact_Acct.ad_table_id=321 
    					          				
                  union all
                  --tru di chi phi chi tieu 15
                  SELECT Fact_Acct.dateacct,-1*Fact_Acct.amtacctdr,-1*Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
              		FROM Fact_Acct 
    					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
    					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000081
                  WHERE  
    					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
    					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
    					          				and Fact_Acct.ad_table_id=321 

                  union all

					      	SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      	WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and (left(tk.value,4) in ('6278','6272'))--or left(tk.value,5) in ('62720'))
 

        --Chi tieu 17: day dai
        union all
        
      select 	'II' as nhom,'17' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1
	 from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000083
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t
        
        union all
        --Chi tieu 18:Bang dinh
        
      select 	'II' as nhom,'18' as chitieu, COALESCE(sum( t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1
	 from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.m_product_id,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
          		FROM Fact_Acct 
					    join  M_Inventory m on Fact_Acct.record_id=m.M_Inventory_id and m.docstatus in ('CO','CL') and m.C_DocType_ID=1000167
					    join m_product hh on Fact_Acct.m_product_id=hh.m_product_id and hh.M_PartType_ID=1000084
              WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=321 and Fact_Acct.amtacctcr<>0
					
						 ) as t

        --Chi tieu 19:Kiem ho giao dich tai khoan 6277
        Union all
        
        select 	'II' as nhom,'19' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
					        union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6277')        
  
        union all
     --Chi tieu 20: Chi phi van chuyen tai khoan 6412
        select 	'III' as nhom,'20' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6412') 
			  
        --Chi tieu 21:Duong bo
        union all
        
       select 	'III' as nhom,'21' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6413')      
        
        --Chi tieu 22: chi phi cang
        union all
        
        select 'I' as nhom,'22' as chitieu,0 as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1  from ad_client where ad_client_id=1000003

        --Chi tieu 23: Chi phi duong bien
        union all
        
        select 'I' as nhom,'23' as chitieu,0 as cp,0 as slb,0 as slb1,0 as slb5,0 as cp1  from ad_client where ad_client_id=1000003
        
        union all
        --Chi tieu 24:phi thanh toan LC tai khoan 6352
        
        select 'II' as nhom,	'24' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6352') 

        --Chi tieu 25:Chi phi sua chua thuong xuyen tai khoan 6273,6274(Ngay 16/10/2020 them tai khoan 6274)
        union all
        
        select 	'II' as nhom,'25' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6273','6274') 
			  
        --Chi tieu 26:Chi phi nhan cong truc tiep voi tai khoan 6221
        union all
        
        select 	'II' as nhom,'26' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6221') 
			  
        --Chi tieu 27:Chi phi nhan cong quan ly tai khoan 6411,6421,6271
        union all

        select 	'II' as nhom,'27' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5  ,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6421','6411','6271') 

        --Chi tieu 28:chi phi an ca,bao hiem
        union all
        
        select 	'II' as nhom,'28' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5        ,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6423','6424')   
			  
        --Chi tieu 29:Chi phi phat trien thi truong tai khoan 6418
        union all
        
        select 	'II' as nhom,'29' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5        ,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6418') 
			  
        --Chi tieu 30: Chi phi khac phuc vu san xuat
        union all
        
        select 	'II' as nhom,'30' as chitieu, COALESCE(sum( t.amtacctdr-t.amtacctcr ),0) as cp,0 as slb,0 as slb1,0 as slb5        ,COALESCE( sum( t.amtacctdr-t.amtacctcr ),0) as cp1
			  from
						( SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					          		FROM Fact_Acct 
					          WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id<>224 
					
				          union all						 

					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	   FROM Fact_Acct 
					            join gl_journalline gl on  Fact_Acct.record_id=gl.gl_journal_id
					                  and Fact_Acct.line_id=gl.gl_journalline_id and Fact_Acct.Account_ID=gl.Account_ID  and gl.IsGenerated='N'
					            join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					      		WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
					          				and Fact_Acct.ad_table_id=224
					      					 					      					 
					      	 union all
						 
					      	 SELECT Fact_Acct.dateacct,Fact_Acct.amtacctdr,Fact_Acct.amtacctcr,Fact_Acct.account_id ,Fact_Acct.description ,Fact_Acct.AD_Client_ID
					      	     FROM Fact_Acct 
					              join gl_journal a on a.gl_journal_id =Fact_Acct.record_id and a.docstatus in ('CO','CL')	
					       	 WHERE  
					                  Fact_Acct.dateacct<=$P{EndDate} and Fact_Acct.dateacct>=$P{StartDate}
					          				and  Fact_Acct.AD_Client_ID in ('1000003') and  (Fact_Acct.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
  					        	 			and Fact_Acct.line_id is null
						 ) as t
			  inner join c_elementvalue tk 	on t.account_id=tk.c_elementvalue_id and tk.AD_Client_ID in ('1000003') and left(tk.value,4) in ('6422','6426') 
      
	) as t
join hsv_giathanh l on t.chitieu=l.value and ad_client_id=1000003

--Lien ket de lay so luong san xuat
left	join(select 'II' as nhom,'2' as chitieu,0 as cp,COALESCE(sum(t.slb),0) as slb,COALESCE(sum(t.slb1),0) as slb1,COALESCE(sum(t.slb5),0) as slb5       
			from(select distinct pl.m_productionplan_id as m_productionline_id,pl.m_product_id,pl.productionqty as slb,0 as slb1,0 as slb5,pl.m_attributesetinstance_id 
	        			from m_productionplan pl
						join m_product hh on pl.m_product_id=hh.m_product_id and  hh.M_AttributeSet_ID=1000000 
						join m_production p on pl.m_production_id=p.m_production_id  and p.docstatus in ('CO','CL') and  (p.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
													AND p.movementdate>=$P{StartDate} and p.movementdate<=$P{EndDate}
						join (select tt.m_attributesetinstance_id from m_attributeinstance tt
		              join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000013 and gtt.m_attribute_id=1000001 
		              WHERE tt.ad_client_id=1000003 
						     ) tt on pl.m_attributesetinstance_id=tt.m_attributesetinstance_id
						where  pl.ad_client_id=1000003 
					
					union all
					
					select distinct pl.m_productionplan_id as m_productionline_id,pl.m_product_id,0 as slb,pl.productionqty as slb1,0 as slb5,pl.m_attributesetinstance_id 
	                from m_productionplan pl
					join m_product hh on pl.m_product_id=hh.m_product_id and  hh.M_AttributeSet_ID=1000000 
					join m_production p on pl.m_production_id=p.m_production_id  and p.docstatus in ('CO','CL') and  (p.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
												AND p.movementdate>=$P{StartDate} and p.movementdate<=$P{EndDate}
					join (select tt.m_attributesetinstance_id from m_attributeinstance tt
	              join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000005 and gtt.m_attribute_id=1000001 
	              WHERE tt.ad_client_id=1000003 
					     ) tt on pl.m_attributesetinstance_id=tt.m_attributesetinstance_id
					where  pl.ad_client_id=1000003 
					
					union all
					
					select distinct pl.m_productionplan_id as m_productionline_id,pl.m_product_id,0 as slb,0 as slb1,pl.productionqty as slb5,pl.m_attributesetinstance_id 
	                from m_productionplan pl
					join m_product hh on pl.m_product_id=hh.m_product_id and  hh.M_AttributeSet_ID=1000000 
					join m_production p on pl.m_production_id=p.m_production_id  and p.docstatus in ('CO','CL') and  (p.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
								AND p.movementdate>=$P{StartDate} and p.movementdate<=$P{EndDate}
					join (select tt.m_attributesetinstance_id from m_attributeinstance tt
	              join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id in('1000006','1000007','1000019') and gtt.m_attribute_id=1000001 
	              WHERE tt.ad_client_id=1000003 
					     ) tt on pl.m_attributesetinstance_id=tt.m_attributesetinstance_id
					where  pl.ad_client_id=1000003 
	
				) as t
			) as sx on t.nhom=sx.nhom
			
--Lien ket de lay so luong xuat ban
	left join (		select 'III' as nhom,'3' as chitieu,0 as cp,COALESCE(sum(t.slb),0) as slb,COALESCE(sum(t.slb1),0) as slb1,COALESCE(sum(t.slb5),0) as slb5     
						from(select COALESCE(sum(io.movementqty),0) as slb,0 as slb1,0 as slb5,'3' as chitieu	from m_inoutline io 
				      		join m_inout iol on io.m_inout_id=iol.m_inout_id and iol.docstatus in ('CO','CL') and iol.C_DocType_ID=1000152
				        			AND iol.movementdate>=$P{StartDate} and iol.movementdate<=$P{EndDate}and  (iol.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
				      		join m_product hh on io.m_product_id=hh.m_product_id and hh. M_AttributeSet_ID=1000000
				          join (select tt.m_attributesetinstance_id from m_attributeinstance tt
				                join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000013 and gtt.m_attribute_id=1000001 
				                WHERE tt.ad_client_id=1000003 
								        ) tt on IO.m_attributesetinstance_id=tt.m_attributesetinstance_id
								   where io.ad_client_id=1000003 
								   
				          union all
				           
				          select 0 as slb,COALESCE(sum(io.movementqty),0) as slb1,0 as slb5,'3' as chitieu	from m_inoutline io 
				      		join m_inout iol on io.m_inout_id=iol.m_inout_id and iol.docstatus in ('CO','CL') and iol.C_DocType_ID=1000152
				        			AND iol.movementdate>=$P{StartDate} and iol.movementdate<=$P{EndDate}and  (iol.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
				      		join m_product hh on io.m_product_id=hh.m_product_id and hh. M_AttributeSet_ID=1000000
				          join (select tt.m_attributesetinstance_id from m_attributeinstance tt
				                join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id=1000005 and gtt.m_attribute_id=1000001 
				                WHERE tt.ad_client_id=1000003 
								        ) tt on IO.m_attributesetinstance_id=tt.m_attributesetinstance_id
								   where io.ad_client_id=1000003  
				
				          union all
				           
				          select 0 as slb,0 as slb1,COALESCE(sum(io.movementqty),0) as slb5,'3' as chitieu	from m_inoutline io 
				      		join m_inout iol on io.m_inout_id=iol.m_inout_id and iol.docstatus in ('CO','CL') and iol.C_DocType_ID=1000152
				        			AND iol.movementdate>=$P{StartDate} and iol.movementdate<=$P{EndDate}and  (iol.AD_org_id=$P{AD_Org_ID} or $P{AD_Org_ID} is null) 
				      		join m_product hh on io.m_product_id=hh.m_product_id and hh. M_AttributeSet_ID=1000000
				          join (select tt.m_attributesetinstance_id from m_attributeinstance tt
				                join m_attributevalue gtt on tt.m_attributevalue_id=gtt.m_attributevalue_id and hsv_c_thuoctinh_id in('1000006','1000007','1000019') and gtt.m_attribute_id=1000001 
				                WHERE tt.ad_client_id=1000003 
								        ) tt on IO.m_attributesetinstance_id=tt.m_attributesetinstance_id
								   where io.ad_client_id=1000003  
				
	        ) as t
		)	xb on t.nhom=xb.nhom		
group by t.nhom,l.description,cast(l.value as integer),l.name
order by cast(value as integer) asc]]>
	</queryString>
	<field name="description" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="description"/>
		<property name="com.jaspersoft.studio.field.label" value="description"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="hsv_giathanh"/>
	</field>
	<field name="value" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="value"/>
		<property name="com.jaspersoft.studio.field.label" value="value"/>
	</field>
	<field name="name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="name"/>
		<property name="com.jaspersoft.studio.field.label" value="name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="hsv_giathanh"/>
	</field>
	<field name="cp" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="cp"/>
		<property name="com.jaspersoft.studio.field.label" value="cp"/>
	</field>
	<field name="cp1" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="cp1"/>
		<property name="com.jaspersoft.studio.field.label" value="cp1"/>
	</field>
	<field name="slb" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="slb"/>
		<property name="com.jaspersoft.studio.field.label" value="slb"/>
	</field>
	<field name="slb1" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="slb1"/>
		<property name="com.jaspersoft.studio.field.label" value="slb1"/>
	</field>
	<field name="slb5" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="slb5"/>
		<property name="com.jaspersoft.studio.field.label" value="slb5"/>
	</field>
	<field name="slbc" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="slbc"/>
		<property name="com.jaspersoft.studio.field.label" value="slbc"/>
	</field>
	<field name="slbc1" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="slbc1"/>
		<property name="com.jaspersoft.studio.field.label" value="slbc1"/>
	</field>
	<field name="slbc5" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="slbc5"/>
		<property name="com.jaspersoft.studio.field.label" value="slbc5"/>
	</field>
	<field name="tdm" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="tdm"/>
		<property name="com.jaspersoft.studio.field.label" value="tdm"/>
	</field>
	<field name="a1" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="a1"/>
		<property name="com.jaspersoft.studio.field.label" value="a1"/>
	</field>
	<field name="a2" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="a2"/>
		<property name="com.jaspersoft.studio.field.label" value="a2"/>
	</field>
	<field name="a3" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="a3"/>
		<property name="com.jaspersoft.studio.field.label" value="a3"/>
	</field>
	<variable name="TB1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{slbc1}]]></variableExpression>
	</variable>
	<variable name="TCPTT" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{cp1}]]></variableExpression>
	</variable>
	<variable name="TB" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{slbc}]]></variableExpression>
	</variable>
	<variable name="TB5" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{slbc5}]]></variableExpression>
	</variable>
	<variable name="TCPDM" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{tdm}]]></variableExpression>
	</variable>
	<variable name="TCL" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{cp}.subtract( $F{tdm} )]]></variableExpression>
	</variable>
	<variable name="sum_a1" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{a1}]]></variableExpression>
	</variable>
	<variable name="sum_a2" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{a2}]]></variableExpression>
	</variable>
	<variable name="sum_a3" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{a3}]]></variableExpression>
	</variable>
	<group name="Nhom">
		<groupExpression><![CDATA[$F{description}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band>
				<property name="local_mesure_unitheight" value="pixel"/>
				<property name="com.jaspersoft.studio.unit.height" value="px"/>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="127">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<printWhenExpression><![CDATA[$P{EXPORT_TYPE}==null || $P{EXPORT_TYPE}=="PDF"]]></printWhenExpression>
			<textField>
				<reportElement x="12" y="85" width="816" height="20" uuid="78c9e16a-13e7-4ab9-ad70-f3b3971b2459">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Kỳ báo cáo : " + new SimpleDateFormat("dd/MM/yyyy").format($P{StartDate}) + " To "  + new SimpleDateFormat("dd/MM/yyyy").format($P{EndDate})]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-2" x="586" y="10" width="190" height="19" forecolor="#000000" backcolor="#FFFFFF" uuid="60934052-ee8f-49bd-9d0a-7ae83bb2a10f"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["Trang " + $V{PAGE_NUMBER} + " / "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" pattern="" isBlankWhenNull="false">
				<reportElement key="textField-3" x="780" y="10" width="36" height="19" forecolor="#000000" backcolor="#FFFFFF" uuid="289fbb8e-6542-4e0c-9ff4-c35b72356357"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["" + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="13" y="63" width="816" height="20" uuid="0f051dca-ba94-4491-aa78-c32e22ab5c19">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="16" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["BÁO CÁO QUẢN TRỊ GIÁ THÀNH NGAO"]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement x="10" y="10" width="373" height="51" uuid="0ef0b471-6ea4-415d-bf69-ad27f7f1f740"/>
				<subreportParameter name="AD_Client_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"CompanyHeader.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement x="15" y="100" width="814" height="21" uuid="a774db19-1746-4a1e-9bce-1e6c3652210b"/>
				<subreportParameter name="AD_Org_ID">
					<subreportParameterExpression><![CDATA[$P{AD_Org_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"BoPhan.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</title>
	<columnHeader>
		<band height="57" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<staticText>
				<reportElement x="10" y="1" width="50" height="56" uuid="9b25b95e-b85e-44d8-95c8-0b7b1661b48c"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[STT]]></text>
			</staticText>
			<staticText>
				<reportElement x="60" y="1" width="230" height="56" uuid="edfe045e-26e4-4b3c-8d08-1bd0f99baca6">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Chỉ tiêu giá thành]]></text>
			</staticText>
			<staticText>
				<reportElement x="394" y="27" width="86" height="30" uuid="8a5bbc35-31b1-46a3-b331-486d7ccc51da">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Đóng bulk]]></text>
			</staticText>
			<staticText>
				<reportElement x="480" y="27" width="90" height="30" uuid="757e94b3-2509-464e-b79e-d1132de20cf5"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Đóng túi 1kg]]></text>
			</staticText>
			<staticText>
				<reportElement x="570" y="27" width="80" height="30" uuid="6039adaf-72cb-44ca-acac-4169eecaac44"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Đóng túi 0,5kg]]></text>
			</staticText>
			<staticText>
				<reportElement x="741" y="1" width="89" height="56" uuid="26ed9662-4efc-4509-be0a-dade0b29fa2d"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Chênh lệch]]></text>
			</staticText>
			<staticText>
				<reportElement x="290" y="1" width="104" height="56" uuid="54b4a9bb-bf79-4347-b90a-4ac0138ada32">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Chi phí thực tế]]></text>
			</staticText>
			<staticText>
				<reportElement x="650" y="1" width="91" height="56" uuid="9ca7f94b-e818-4aad-8811-70528230d812"/>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Tổng chi phí định mức]]></text>
			</staticText>
			<staticText>
				<reportElement x="394" y="1" width="256" height="26" uuid="6850250c-6016-4feb-9653-20e79245001d">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Chi phí định mức]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="27" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<textField>
				<reportElement x="10" y="0" width="50" height="27" uuid="238320d9-52f4-4b8d-997b-4a9ee348cf20">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="60" y="0" width="230" height="27" uuid="d5d34af4-7867-4347-82a4-03db48dd2fc2">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{description}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="290" y="0" width="104" height="27" uuid="28dd3c2e-37c4-4b18-abe1-9bc77e3b45bb">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cp}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="480" y="0" width="90" height="27" uuid="32089575-eb4f-4ece-9c4d-9aa3c8ed19d7">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{slb1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="570" y="0" width="80" height="27" uuid="436ae9de-db13-4eea-9935-9d795b330a02">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{slb5}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="741" y="0" width="89" height="27" uuid="ad8a628d-a337-49e6-9c36-9ea25bcb549e">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cp}.subtract( $F{tdm} )]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="394" y="0" width="86" height="27" uuid="5ffd5b31-090a-453f-8304-6c14ba94a979">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{slb}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="651" y="0" width="90" height="27" uuid="9c1afae2-92c8-48a1-8484-3f3d20f46f93">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tdm}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="99">
			<printWhenExpression><![CDATA[$P{EXPORT_TYPE}==null || $P{EXPORT_TYPE}=="PDF"]]></printWhenExpression>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-4" x="510" y="65" width="227" height="19" forecolor="#000000" backcolor="#FFFFFF" uuid="26c2a31c-7c51-4f79-8242-3a5bf4892e52"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["Ngày in: " + new SimpleDateFormat("dd/MM/yyyy hh24:mm").format(new Date())]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-8" positionType="Float" stretchType="RelativeToTallestObject" x="552" y="82" width="148" height="16" uuid="7e444384-a93a-4097-84ef-e251613901c5"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Kiểm soát]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-8" positionType="Float" stretchType="RelativeToTallestObject" x="67" y="83" width="118" height="16" uuid="5b337119-c93f-4b0b-9db5-bd89ec2894fa"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Lập biểu]]></text>
			</staticText>
			<textField>
				<reportElement x="10" y="0" width="280" height="27" uuid="9794f009-0dfc-4e8c-a3cf-3a57b3245645">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Tổng cộng :"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="290" y="0" width="104" height="27" uuid="777823af-4d0b-4f88-a79a-00df90b6e888">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TCPTT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="741" y="0" width="89" height="27" uuid="1b90c82f-a580-4ddd-9c91-7dd53cc32a25">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TCL}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="394" y="0" width="86" height="27" uuid="aaaf8cc2-7f4b-4c2e-80ea-2691c18c87c3">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TB}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="480" y="0" width="91" height="27" uuid="72252504-0610-4858-b232-2b12f6f46f3e">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TB1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="571" y="0" width="79" height="27" uuid="21595799-a75c-461b-9df9-130033aebad2">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TB5}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="650" y="0" width="91" height="27" uuid="60c34b79-c22b-41fb-bf00-bf292c3ec52f">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TCPDM}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="10" y="27" width="280" height="27" uuid="fc5a1338-dba7-4664-a30e-15bf79e7f736">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["CP vượt định mức/1 kg Ngao theo đơn hàng"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="290" y="27" width="104" height="27" uuid="40b6febf-14fd-4d22-829e-af6c5ec35ec0">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="480" y="27" width="91" height="27" uuid="e05fb020-8fe9-47cc-87d4-653960d0636c">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="394" y="27" width="86" height="27" uuid="d90a81ae-2c4f-43db-b3a7-48c779f34f36">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="571" y="27" width="79" height="27" uuid="303e5a26-7d25-4c15-b231-cd8ae7bd4249">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="650" y="27" width="91" height="27" uuid="2f5864aa-4285-4575-8ca8-baa1ce6bf2d4">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="741" y="27" width="89" height="27" uuid="6e73de16-9196-4a6c-8d20-08c80e28e179">
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.2" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new Double(($V{sum_a1}+$V{sum_a2}+$V{sum_a3}) == 0 ? 0 :
($V{TCL}.doubleValue()/($V{sum_a1}+$V{sum_a2}+$V{sum_a3})))]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
