<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.4.3.final using JasperReports Library version 6.4.3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="giathanh_surumi" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="2082e08c-aeac-4f2d-8b67-39d5c7dbdac5">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HSV"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<parameter name="StartDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date(118,0,1)]]></defaultValueExpression>
	</parameter>
	<parameter name="EndDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[NOW()]]></defaultValueExpression>
	</parameter>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[1000019]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["dev/"]]></defaultValueExpression>
	</parameter>
	<queryString language="SQL">
		<![CDATA[SELECT 'I' AS nhom,k.description, k.name,k.hsv_dinhmuc,k.id,round(k.qty,2) as qty,round(k.tt,2) as tt,  round(k.dg,2) as dg FROM
(
SELECT tp.description, tp.name, tp.hsv_dinhmuc, tp.value AS id, NULL::int4 AS qty, NULL::int4 AS tt, NULL::int4 AS dg
FROM hsv_giathanhvan tp
WHERE "value" = '1' AND ad_client_id = $P{AD_CLIENT_ID}
UNION ALL    
SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, NULL::int4 AS tt, NULL::int4  AS dg
FROM (
    SELECT '2' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
	) AS k
RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '2'
UNION ALL
SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt AS tt, CASE WHEN qtytt<>0 THEN k.tt/qtytt ELSE 0 END  AS dg
FROM (
    SELECT id, sum(qty) AS qty, sum(tt) AS tt, sum(qtytt) AS qtytt
    FROM (
        SELECT '3' AS id,  sum(fc.qty) AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt", 0 AS qtytt
        FROM fact_acct fc
        JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
        WHERE fc.C_Activity_ID = 1000273 AND ad_table_id = 325 AND M_Product_ID = 1015083 AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
        UNION ALL
        SELECT '3' AS id, 0 AS qty, 0 AS tt, sum(civ.productionqty) AS qtytt
        FROM m_production ci
        JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
        WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
        ) AS k GROUP BY id
	) AS k
RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '3'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt AS tt, CASE WHEN qtytt<>0 THEN k.tt/qtytt ELSE 0 END  AS dg
FROM (
    SELECT id, sum(qty) AS qty, sum(tt) AS tt, sum(qtytt) AS qtytt
    FROM (
        SELECT '4' AS id,  sum(fc.qty) AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt", 0 AS qtytt
        FROM fact_acct fc
        JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
        WHERE fc.C_Activity_ID = 1000273 AND ad_table_id = 325 AND M_Product_ID = 1015097 AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
        UNION ALL
        SELECT '4' AS id, 0 AS qty, 0 AS tt, sum(civ.productionqty) AS qtytt
        FROM m_production ci
        JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
        WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
        ) AS k GROUP BY id
	) AS k
RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id =  $P{AD_CLIENT_ID}  AND tp.value = '4'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt AS tt, CASE WHEN qty<>0 THEN k.tt/qty ELSE 0 END  AS dg
FROM(
	SELECT '5' AS id, -1*sum(fc.qty) AS qty, -1*sum(fc.amtacctdr-fc.amtacctcr) AS "tt"
	FROM fact_acct fc    
	WHERE  ad_table_id = 318 AND fc.m_product_id =1015088 AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} AND fc.ad_client_id = $P{AD_CLIENT_ID}
	GROUP BY id
) AS k
RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '5'
) as k
UNION ALL
SELECT 'II' AS nhom,k.description, k.name,k.hsv_dinhmuc,k.id,round(k.qty,2) as qty,round(k.tt,2) as tt,  round(k.dg,2) as dg FROM
(
SELECT tp.description, tp.name, tp.hsv_dinhmuc, tp.value AS id, NULL::int4 AS qty, NULL::int4 AS tt, NULL::int4 AS dg
FROM hsv_giathanhvan tp
WHERE "value" = '6' AND ad_client_id = $P{AD_CLIENT_ID}

UNION ALL
SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt AS tt, CASE WHEN qty<>0 THEN k.tt/qty ELSE 0 END  AS dg
FROM (
select id, sum(qty) as qty, sum(tt) as tt
FROM(
    SELECT '7' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
	
	UNION ALL
	
	SELECT '7' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
        FROM fact_acct fc
        JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6211')
        JOIN m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_Category_ID in (1000492,1000493)
        WHERE fc.C_Activity_ID = 1000273 AND ad_table_id = 321 and  fc.C_Campaign_ID=1000062  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
) as k group by id
) as k 
RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '7'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '8' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '8' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6213')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '8'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '9' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '9' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000053
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '9'
UNION ALL
SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (

SELECT '10' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
    
    
UNION ALL
    SELECT '10' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000054
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '10'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '11' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
    
UNION ALL
    SELECT '11' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000055
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '11'
UNION ALL
SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '12' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
    UNION ALL
    SELECT '12' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000056
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '12'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '13' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
    UNION ALL
    SELECT '13' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000057
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '13'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '14' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
   
UNION ALL
    SELECT '14' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6221')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '14'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '15' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
   UNION ALL
    SELECT '15' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6223')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '15'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
 
    SELECT '16' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '16' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6271')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '16'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '17' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '17' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6272')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '17'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
   
    SELECT '18' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '18' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000058
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '18'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '19' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '19' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000060
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '19'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
   
    SELECT '20' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '20' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000059
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '20'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
  
    SELECT '21' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '21' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6273')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '21'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
   
    SELECT '22' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '22' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6274')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '22'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '23' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '23' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6275')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '23'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '24' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '24' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6276')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '24'
UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '25' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '25' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000065
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '25'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '26' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '26' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000061
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '26'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '27' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '27' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000062
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '27'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt, CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '28' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '28' AS id, 0 AS qty, sum(fc.amtacctcr - fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 2) IN ('15')
    JOIN m_product hh ON fc.m_product_id = hh.m_product_id AND hh.M_PartType_ID=1000063
	WHERE fc.C_Activity_ID = 1000273  AND ad_table_id = 321  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '28'
UNION ALL
SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    
    SELECT '29' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
UNION ALL
    SELECT '29' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6277')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '29'


UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (

    SELECT '30' AS id, sum(civ.productionqty) AS qty,0 AS tt
	FROM m_production ci
	JOIN m_productionplan  civ ON ci.m_production_id = civ.m_production_id 
	JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000088 
	WHERE ci.docstatus IN ('CO','CL') AND ci.c_activity_id = 1000273 AND ci.c_campaign_id=1000062  AND ci.movementdate>=$P{StartDate} AND ci.movementdate<=$P{EndDate} 
	
	UNION ALL
    SELECT '30' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6278')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '30'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '31' AS id,sum(qtyinvoiced) AS qty,0 AS tt FROM c_invoice ci 
    JOIN c_invoiceline civ ON ci.c_invoice_id = civ.c_invoice_id AND civ.m_product_id = 1015088 AND ci.issotrx = 'Y'
    WHERE ci.docstatus IN ('CO','CL') AND ci.dateacct>=$P{StartDate} AND ci.dateacct<=$P{EndDate} 
    UNION ALL
    SELECT '31' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6411')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '31'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
    SELECT '32' AS id,sum(qtyinvoiced) AS qty,0 AS tt FROM c_invoice ci 
    JOIN c_invoiceline civ ON ci.c_invoice_id = civ.c_invoice_id AND civ.m_product_id = 1015088 AND ci.issotrx = 'Y'
    WHERE ci.docstatus IN ('CO','CL') AND ci.dateacct>=$P{StartDate} AND ci.dateacct<=$P{EndDate}
UNION ALL
    SELECT '32' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6417')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '32'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
 SELECT '33' AS id,sum(qtyinvoiced) AS qty,0 AS tt FROM c_invoice ci 
    JOIN c_invoiceline civ ON ci.c_invoice_id = civ.c_invoice_id AND civ.m_product_id = 1015088 AND ci.issotrx = 'Y'
    WHERE ci.docstatus IN ('CO','CL') AND ci.dateacct>=$P{StartDate} AND ci.dateacct<=$P{EndDate}UNION ALL
    SELECT '33' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr) AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6418')
	WHERE fc.C_Activity_ID = 1000273  AND fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '33'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
 SELECT '34' AS id,sum(qtyinvoiced) AS qty,0 AS tt FROM c_invoice ci 
    JOIN c_invoiceline civ ON ci.c_invoice_id = civ.c_invoice_id AND civ.m_product_id = 1015088 AND ci.issotrx = 'Y'
    WHERE ci.docstatus IN ('CO','CL') AND ci.dateacct>=$P{StartDate} AND ci.dateacct<=$P{EndDate}UNION ALL
    SELECT '34' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr)/2 AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6421')
	WHERE    fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '34'

UNION ALL

SELECT tp.description, tp.name,  tp.hsv_dinhmuc, tp.value, k.qty, k.tt,  CASE WHEN k.qty<>0 THEN round(k.tt / k.qty,2) ELSE 0 END AS dg
FROM(
SELECT id, sum(qty) AS qty, sum(tt)AS tt 
FROM (
 SELECT '35' AS id,sum(qtyinvoiced) AS qty,0 AS tt FROM c_invoice ci 
    JOIN c_invoiceline civ ON ci.c_invoice_id = civ.c_invoice_id AND civ.m_product_id = 1015088 AND ci.issotrx = 'Y'
    WHERE ci.docstatus IN ('CO','CL') AND ci.dateacct>=$P{StartDate} AND ci.dateacct<=$P{EndDate}
    UNION ALL
    SELECT '35' AS id, 0 AS qty, sum(-fc.amtacctcr + fc.amtacctdr)/2 AS "tt"
	FROM fact_acct fc
    JOIN c_elementvalue acct ON fc.account_id = acct.c_elementvalue_id AND LEFT(acct.value, 4) IN ('6428')
	WHERE   fc.dateacct>=$P{StartDate} AND fc.dateacct<=$P{EndDate} 
	GROUP BY id
	) AS k GROUP BY id) AS k
	RIGHT JOIN hsv_giathanhvan tp ON tp.value = k.id
WHERE ad_client_id = $P{AD_CLIENT_ID} AND tp.value = '35'
) as k]]>
	</queryString>
	<field name="nhom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="nhom"/>
	</field>
	<field name="description" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="description"/>
	</field>
	<field name="name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="name"/>
	</field>
	<field name="hsv_dinhmuc" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="hsv_dinhmuc"/>
	</field>
	<field name="id" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="id"/>
	</field>
	<field name="qty" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="qty"/>
	</field>
	<field name="tt" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="tt"/>
	</field>
	<field name="dg" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="dg"/>
	</field>
	<variable name="sum_qty" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1" calculation="Sum">
		<variableExpression><![CDATA[$F{qty}]]></variableExpression>
	</variable>
	<variable name="sum_tt" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1" calculation="Sum">
		<variableExpression><![CDATA[$F{tt}]]></variableExpression>
	</variable>
	<variable name="sum_dg" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1" calculation="Sum">
		<variableExpression><![CDATA[$F{dg}]]></variableExpression>
	</variable>
	<group name="Group1">
		<groupExpression><![CDATA[$F{nhom}]]></groupExpression>
	</group>
	<background>
		<band height="23" splitType="Stretch">
			<textField>
				<reportElement x="533" y="-18" width="27" height="23" uuid="0e2e1a0f-324e-463a-a7cd-784df7dcbd52">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="560" y="-18" width="27" height="23" uuid="8675d993-7278-465f-9fcb-551140e29a1f">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA["/"+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</background>
	<title>
		<band height="79" splitType="Stretch">
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement key="textField-5" x="-1" y="56" width="575" height="23" uuid="85705d2f-379a-4e7c-a004-fc3f83846c1d"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression><![CDATA["Kỳ báo cáo : " + new SimpleDateFormat("dd/MM/yyyy").format($P{StartDate}) + " To "  + new SimpleDateFormat("dd/MM/yyyy").format($P{EndDate})]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement key="textField-6" x="0" y="37" width="575" height="23" uuid="94e3feae-09a9-4625-af10-ae0b90cfa6c5"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="14" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression><![CDATA["BÁO CÁO GIÁ THÀNH SẢN XUẤT SURUMI"]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement x="0" y="0" width="180" height="36" uuid="ec5d3101-e927-4ef1-94a5-80e590ae76f9"/>
				<subreportParameter name="StartDate">
					<subreportParameterExpression><![CDATA[$P{StartDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="EndDate">
					<subreportParameterExpression><![CDATA[$P{EndDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"CompanyHeader.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</title>
	<columnHeader>
		<band height="23" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="25" height="23" uuid="db41a5b5-a514-4072-bd71-71085f71c123">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="91ce3f4c-6d55-4ccc-94e8-4ed36947c934"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[TT]]></text>
			</staticText>
			<staticText>
				<reportElement x="25" y="0" width="195" height="23" uuid="7f5435ad-e24e-4516-8c37-09826071a96f">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="5b5132f1-d48e-4f23-b364-f9bdb80c5da8"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Nội dung]]></text>
			</staticText>
			<staticText>
				<reportElement x="220" y="0" width="60" height="23" uuid="85bd9d41-ad78-4c0f-9e03-7be301dc8661">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="18363adc-9698-4c2b-bd90-1f9d075cd5c5"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Định mức]]></text>
			</staticText>
			<staticText>
				<reportElement x="280" y="0" width="90" height="23" uuid="0066fae6-b7d1-4c41-b038-08979d5a58c2">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d481c971-43ab-4e3d-a7f4-8eae078cd86d"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Số lượng]]></text>
			</staticText>
			<staticText>
				<reportElement x="370" y="0" width="110" height="23" uuid="acf9c05c-8244-40fd-b011-2cd65d8e830c">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b96f583c-a735-47ee-8fb4-3702c5963143"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Thành tiền]]></text>
			</staticText>
			<staticText>
				<reportElement x="480" y="0" width="95" height="23" uuid="6b72fef0-614c-4054-8ac9-c2a5e0dca85b">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3bf5caf0-e606-4983-ab5c-caa558941fd6"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Giá thành đv]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="23" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="0" width="25" height="23" uuid="bf0f5476-c111-438c-a41d-2dea19dc96db">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="91ce3f4c-6d55-4ccc-94e8-4ed36947c934"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{description}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="25" y="0" width="195" height="23" uuid="820034da-267f-4e6d-b619-eb376dae01cd">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="5b5132f1-d48e-4f23-b364-f9bdb80c5da8"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{name}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="220" y="0" width="60" height="23" uuid="d3d1c84b-d4a0-42ab-bb5b-8bac31a6f956">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="18363adc-9698-4c2b-bd90-1f9d075cd5c5"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{hsv_dinhmuc}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="280" y="0" width="90" height="23" uuid="1db8a9bc-a0e7-4108-99f5-177ed267e9c5">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d481c971-43ab-4e3d-a7f4-8eae078cd86d"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{qty}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="370" y="0" width="110" height="23" uuid="06f68fe4-2482-420a-aeea-8e0efa18d76b">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b96f583c-a735-47ee-8fb4-3702c5963143"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tt}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="480" y="0" width="95" height="23" uuid="62a31600-3ee4-4a1d-8cb8-c0aef790e918">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3bf5caf0-e606-4983-ab5c-caa558941fd6"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dg}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="148" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-8" positionType="Float" stretchType="RelativeToTallestObject" x="399" y="123" width="170" height="16" uuid="3251dacc-9105-482f-b6d4-ff70a7d59378">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Giám đốc]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-8" positionType="Float" stretchType="RelativeToTallestObject" x="-4" y="123" width="170" height="16" uuid="0c97c800-2ac6-43ee-b462-3b702e61b3ae">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Lập biểu]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-8" positionType="Float" stretchType="RelativeToTallestObject" x="195" y="123" width="170" height="16" uuid="a4c6ccb0-4b34-4ddd-a247-3c2f6a5e79c4">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Kiểm soát]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-4" x="378" y="98" width="196" height="19" forecolor="#000000" backcolor="#FFFFFF" uuid="2f9dc811-d13e-4093-818d-5e0e38fe7bfa"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["Ngày in: " + new SimpleDateFormat("dd/MM/yyyy hh24:mm").format(new Date())]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement x="0" y="23" width="575" height="23" uuid="7a85a63e-88a7-4a46-9dd0-f5ebe62d7be2">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<subreportParameter name="StartDate">
					<subreportParameterExpression><![CDATA[$P{StartDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="EndDate">
					<subreportParameterExpression><![CDATA[$P{EndDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"tyle_trencan.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement x="0" y="0" width="575" height="23" uuid="de69be10-0d60-4e58-8ea5-23e30de6e99d">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<subreportParameter name="StartDate">
					<subreportParameterExpression><![CDATA[$P{StartDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="EndDate">
					<subreportParameterExpression><![CDATA[$P{EndDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"tyle_tongchiphi.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement x="0" y="46" width="575" height="23" uuid="b9eee93a-14e7-404c-b742-738ed0764e2e">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<subreportParameter name="StartDate">
					<subreportParameterExpression><![CDATA[$P{StartDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="EndDate">
					<subreportParameterExpression><![CDATA[$P{EndDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"tyle_giathanhsurumi.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement x="0" y="69" width="575" height="23" uuid="c52178d6-a37f-487a-a21d-b9bb99d89a91">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<subreportParameter name="StartDate">
					<subreportParameterExpression><![CDATA[$P{StartDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="EndDate">
					<subreportParameterExpression><![CDATA[$P{EndDate}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"tyle_laigop.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</summary>
</jasperReport>
