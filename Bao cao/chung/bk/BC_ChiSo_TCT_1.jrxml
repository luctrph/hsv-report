<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.4.3.final using JasperReports Library version 6.4.3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="BC_ChiSo_TCT" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="52c83257-8786-4859-904a-18ef67322e14">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HSV"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
	<parameter name="StartDate" class="java.util.Date"/>
	<parameter name="EndDate" class="java.util.Date"/>
	<parameter name="DateFrom" class="java.util.Date"/>
	<queryString language="SQL">
		<![CDATA[select '1' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '1' and ad_client_id = 1000019

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '2' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty2) <> 0 then sum(qty1) / sum(qty2) else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493) and fc.C_Campaign_ID = 1000060 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and ad_table_id = 321
			
			union all
			
			select 0 as qty1, sum(qty) - sum(qty1) as qty2
			from (
				select sum(civ.productionqty) as qty, 0 as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty2) <> 0 then sum(qty1) / sum(qty2) else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493) and fc.C_Campaign_ID = 1000060 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and ad_table_id = 321
			
			union all
			
			select 0 as qty1, sum(qty) - sum(qty1) as qty2
			from (
				select sum(civ.productionqty) as qty, 0 as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '2'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '3' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty2) <> 0 then sum(qty1) / sum(qty2) else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000272 and ad_table_id = 321 and M_Product_ID = 1015083 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate} and fc.C_Campaign_ID = 1000060
			
			union all
			
			select 0 as qty1, sum(qty) as qty2
			from (
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015086 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty2) <> 0 then sum(qty1) / sum(qty2) else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000272 and ad_table_id = 321 and M_Product_ID = 1015083 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate} and fc.C_Campaign_ID = 1000060
			
			union all
			
			select 0 as qty1, sum(qty) as qty2
			from (
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015086 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '3'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '4' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty3) <> 0 then (sum(qty1) - sum(qty2)) / sum(qty3) else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2, 0 as qty3
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493) and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty1, - 1 * sum(fc.qty) as qty2, 0 as qty3
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440) and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty1, 0 as qty2, sum(fc.qty) as qty3
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15') and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 325 and M_Product_ID = 1015088 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty3) <> 0 then (sum(qty1) - sum(qty2)) / sum(qty3) else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2, 0 as qty3
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493) and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty1, - 1 * sum(fc.qty) as qty2, 0 as qty3
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440) and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty1, 0 as qty2, sum(fc.qty) as qty3
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15') and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 325 and M_Product_ID = 1015088 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '4'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '5' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty2) <> 0 then sum(qty1) / sum(qty2) else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440) and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty1, sum(fc.qty) as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.C_Campaign_ID = 1000062 and ad_table_id = 325 and M_Product_ID = 1016903 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty2) <> 0 then sum(qty1) / sum(qty2) else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty1, 0 as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440) and fc.C_Campaign_ID = 1000062
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty1, sum(fc.qty) as qty2
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.C_Campaign_ID = 1000062 and ad_table_id = 325 and M_Product_ID = 1016903 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '5'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '6' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty, 0 as qty1
		from (
			select sum(fc.amtacctcr - fc.amtacctdr) as tt, 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493) and fc.C_Campaign_ID = 1000060 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and ad_table_id = 321
			
			union all
			
			select 0 as tt, sum(qty) - sum(qty1) as qty
			from (
				select sum(civ.productionqty) as qty, 0 as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty1
		from (
			select sum(fc.amtacctcr - fc.amtacctdr) as tt, 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			join m_product hh on fc.m_product_id = hh.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493) and fc.C_Campaign_ID = 1000060 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and ad_table_id = 321
			
			union all
			
			select 0 as tt, sum(qty) - sum(qty1) as qty
			from (
				select sum(civ.productionqty) as qty, 0 as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '6'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '7' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty, 0 as qty1
		from (
			select sum(fc.amtacctcr - fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000272 and ad_table_id = 321 and M_Product_ID = 1015083 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate} and fc.C_Campaign_ID = 1000060
			
			union all
			
			select 0 as "tt", sum(qty) as qty
			from (
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015086 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty1, case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty1
		from (
			select sum(fc.amtacctcr - fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000272 and ad_table_id = 321 and M_Product_ID = 1015083 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate} and fc.C_Campaign_ID = 1000060
			
			union all
			
			select 0 as "tt", sum(qty) as qty
			from (
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015086 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select sum(civ.productionqty) as qty
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id and docstatus in ('CO', 'CL')
				inner join m_attributeinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id
				inner join m_attributevalue attv on tt.m_attribute_id = attv.m_attribute_id and tt.m_attributevalue_id = attv.m_attributevalue_id and attv.M_AttributeValue_ID = 1000333
				where ci.ad_client_id = 1000019 and civ.M_Product_ID = 1015087 and ci.C_Campaign_ID = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '7'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '8' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then k.tt / qty else 0 end qty, 0 as qty1
		from (
			select id, sum(qty) - sum(qty6) as qty, sum(tt) - sum(tt6) as tt
			from (
				select '7' as id, sum(civ.productionqty) as qty, 0 as tt, 0 as qty6, 0 as tt6
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
				where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select '7' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty6, 0 as tt6
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6211'
				join m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493)
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.C_Campaign_ID = 1000062 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select '7' as id, 0 as qty, 0 as "tt", sum(civ.productionqty) as qty6, 0 as tt6
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088 and hh.m_product_id = 1016903
				where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select '7' as id, 0 as qty, 0 as tt, 0 as qty6, sum(- fc.amtacctcr + fc.amtacctdr) as tt6
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6211'
				join m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440)
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.C_Campaign_ID = 1000062 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				) as k
			group by id
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then k.tt / qty else 0 end qty1
		from (
			select id, sum(qty) - sum(qty6) as qty, sum(tt) - sum(tt6) as tt
			from (
				select '7' as id, sum(civ.productionqty) as qty, 0 as tt, 0 as qty6, 0 as tt6
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
				where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select '7' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty6, 0 as tt6
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6211'
				join m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_Category_ID in (1000492, 1000493,1016440)
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.C_Campaign_ID = 1000062 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select '7' as id, 0 as qty, 0 as "tt", sum(civ.productionqty) as qty6, 0 as tt6
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088 and hh.m_product_id = 1016903
				where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select '7' as id, 0 as qty, 0 as tt, 0 as qty6, sum(- fc.amtacctcr + fc.amtacctdr) as tt6
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6211'
				join m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_ID in (1016501, 1016346)
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.C_Campaign_ID = 1000062 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				) as k
			group by id
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '8'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '9' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then k.tt / qty else 0 end as qty, 0 as qty1
		from (
			select id, sum(qty) as qty, sum(tt) as tt
			from (
				select '6' as id, sum(civ.productionqty) as qty, 0 as tt
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088 and hh.m_product_id = 1016903
				where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select '6' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6211'
				join m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440)
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.C_Campaign_ID = 1000062 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				) as k
			group by id
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then k.tt / qty else 0 end as qty1
		from (
			select id, sum(qty) as qty, sum(tt) as tt
			from (
				select '6' as id, sum(civ.productionqty) as qty, 0 as tt
				from m_production ci
				join m_productionplan civ on ci.m_production_id = civ.m_production_id
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088 and hh.m_product_id = 1016903
				where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
				
				union all
				
				select '6' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6211'
				join m_product hh on hh.m_product_id = fc.m_product_id and hh.M_Product_ID in (1016501, 1016346,1016440)
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and ad_table_id = 321 and fc.C_Campaign_ID = 1000062 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				) as k
			group by id
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '9'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '10' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select sum(a5) as qty, 0 as qty1
		from (
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '10' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '10' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6221'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '10'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '11' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '11' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6223'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '11'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '12' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '12' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6271'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '12'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '13' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '13' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6272'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '13'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '17' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '17' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6273'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '17'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '18' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '18' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6274'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '18'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '19' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '19' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6275'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '19'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '20' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '20' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6276'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '20'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '21' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '21' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6277'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '21'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '22' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '22' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6278'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '22'
			) as k
		
		union all
		
		select 0 as qty, sum(a5) as qty1
		from (
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '10' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '10' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6221'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '10'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '12' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '12' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6271'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '12'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '13' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '13' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6272'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '13'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '17' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '17' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6273'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '17'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '18' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '18' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6274'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '18'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '19' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '19' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6275'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '19'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '20' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '20' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6276'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '20'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '21' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '21' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6277'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '21'
			
			union all
			
			select id, "name" as a1, hsv_dinhmuc as a2, qty as a3, tt as a4, case when qty <> 0 then tt / qty else 0 end as a5
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '22' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000272 and ci.c_campaign_id = 1000060 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '22' as id, 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6278'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanh tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '22'
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '10'

union all

select hm.value as id, hm.description as stt, hm.name, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '11' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select sum(dg) as qty, 0 as qty1
		from (
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '14' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '14' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6221'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '14'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '15' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '15' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6223'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '15'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '16' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '16' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6271'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '16'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '17' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '17' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6272'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '17'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '21' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '21' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6273'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '21'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '22' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '22' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6274'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '22'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '23' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '23' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6275'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '23'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '24' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '24' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6276'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '24'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '29' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '29' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6277'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '29'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '30' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '30' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6278'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '30'
			) as k
		
		union all
		
		select 0 as qty, sum(dg) as qty1
		from (
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '14' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '14' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6221'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '14'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '15' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '15' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6223'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '15'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '16' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '16' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6271'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '16'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '17' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '17' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6272'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '17'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '21' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '21' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6273'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '21'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '22' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '22' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6274'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '22'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '23' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '23' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6275'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '23'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '24' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '24' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6276'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '24'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '29' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '29' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6277'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '29'
			
			union all
			
			select tp.description, tp.name, tp.hsv_dinhmuc, tp.value, k.qty, k.tt, case when k.qty <> 0 then round(k.tt / k.qty, 2) else 0 end as dg
			from (
				select id, sum(qty) as qty, sum(tt) as tt
				from (
					select '30' as id, sum(civ.productionqty) as qty, 0 as tt
					from m_production ci
					join m_productionplan civ on ci.m_production_id = civ.m_production_id
					join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000088
					where ci.docstatus in ('CO', 'CL') and ci.c_activity_id = 1000273 and ci.c_campaign_id = 1000062 and ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate}
					
					union all
					
					select '30' as id, 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
					from fact_acct fc
					join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value = '6278'
					where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
					group by id
					) as k
				group by id
				) as k
			right join hsv_giathanhvan tp on tp.value = k.id
			where ad_client_id = 1000019 and tp.value = '30'
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '11'

union all

select hm.value as id, hm.description as stt, concat ("name", '(', hm.hsv_dinhmuc1, '%)') as name, hm.hsv_dinhmuc, case when k.qty <> 0 and hsv_dinhmuc1 <> 0 and hsv_dinhmuc1 is not null then round((k.tt * hsv_dinhmuc1
						) / (k.qty * 100), 0) else 0 end as a1, case when k.qty1 <> 0 and hsv_dinhmuc1 <> 0 and hsv_dinhmuc1 is not null then round((k.tt1 * hsv_dinhmuc1) / (k.qty1 * 100), 0) else 0 end as a2
from (
	select '12' as id, sum(qty) as qty, sum(tt) as tt, sum(qty1) as qty1, sum(tt1) as tt1
	from (
		select sum(qty) as qty, sum(tt) as tt, 0 as qty1, 0 as tt1
		from (
			select sum(qtyinvoiced) as qty, 0 as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'Y'
			join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
			where ci.ad_client_id = 1000019 and ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6421', '6428')
			where fc.ad_client_id = 1000019 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, 0 as tt, sum(qty) as qty1, sum(tt) as tt1
		from (
			select sum(qtyinvoiced) as qty, 0 as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'Y'
			join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086
			where ci.ad_client_id = 1000019 and ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6421', '6428')
			where fc.ad_client_id = 1000019 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '12'

union all

select hm.value as id, hm.description as stt, concat ("name", '(', hm.hsv_dinhmuc1, '%)') as name, hm.hsv_dinhmuc, case when k.qty <> 0 and hsv_dinhmuc1 <> 0 and hsv_dinhmuc1 is not null then round((k.tt * hsv_dinhmuc1
						) / (k.qty * 100), 0) else 0 end as a1, case when k.qty1 <> 0 and hsv_dinhmuc1 <> 0 and hsv_dinhmuc1 is not null then round((k.tt1 * hsv_dinhmuc1) / (k.qty1 * 100), 0) else 0 end as a2
from (
	select '13' as id, sum(qty) as qty, sum(tt) as tt, sum(qty1) as qty1, sum(tt1) as tt1
	from (
		select sum(qty) as qty, sum(tt) as tt, 0 as qty1, 0 as tt1
		from (
			select sum(qtyinvoiced) as qty, 0 as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'Y'
			join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1015088
			where ci.ad_client_id = 1000019 and ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6421', '6428')
			where fc.ad_client_id = 1000019 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, 0 as tt, sum(qty) as qty1, sum(tt) as tt1
		from (
			select sum(qtyinvoiced) as qty, 0 as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'Y'
			join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1015088
			where ci.ad_client_id = 1000019 and ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6421', '6428')
			where fc.ad_client_id = 1000019 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '13'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '14' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then round(tt / qty, 0) else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where fc.ad_client_id = 1000019 and ad_table_id = 318 and fc.m_product_id = 1015087 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate} and fc.amtacctdr = 0
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then round(tt / qty, 0) else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where fc.ad_client_id = 1000019 and ad_table_id = 318 and fc.m_product_id = 1015087 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate} and fc.amtacctdr = 0
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '14'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '15' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then round(tt / qty, 0) else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where ad_table_id = 318 and fc.m_product_id = 1015086 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate} and fc.ad_client_id = 1000019
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then round(tt / qty, 0) else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where ad_table_id = 318 and fc.m_product_id = 1015086 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate} and fc.ad_client_id = 1000019
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '15'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '16' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then k.tt / qty else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where ad_table_id = 318 and fc.m_product_id = 1015088 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate} and fc.ad_client_id = 1000019 and fc.amtacctdr = 0
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then k.tt / qty else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where ad_table_id = 318 and fc.m_product_id = 1015088 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate} and fc.ad_client_id = 1000019 and fc.amtacctdr = 0
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '16'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '17' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then k.tt / qty else 0 end as qty, 0 as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where ad_table_id = 318 and fc.m_product_id = 1016903 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate} and fc.ad_client_id = 1000019 and fc.amtacctdr = 0
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then k.tt / qty else 0 end as qty1
		from (
			select - 1 * sum(fc.qty) as qty, - 1 * sum(fc.amtacctdr - fc.amtacctcr) as "tt"
			from fact_acct fc
			where ad_table_id = 318 and fc.m_product_id = 1016903 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate} and fc.ad_client_id = 1000019 and fc.amtacctdr = 0
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '17'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '18' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(qty) as qty, sum(tt) as tt
			from (
				select sum(qtyinvoiced) as qty, 0 as tt
				from c_invoice ci
				join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'Y'
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086 and ci.C_Activity_ID = 1000272
				where ci.ad_client_id = 1000019 and ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6418', '6411', '6417')
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(qty) as qty, sum(tt) as tt
			from (
				select sum(qtyinvoiced) as qty, 0 as tt
				from c_invoice ci
				join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'Y'
				join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_AttributeSet_ID = 1000086 and ci.C_Activity_ID = 1000272
				where ci.ad_client_id = 1000019 and ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(fc.amtacctdr - fc.amtacctcr) as "tt"
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6418', '6411', '6417')
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000272 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '18'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '19' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when k.qty <> 0 then k.tt / k.qty else 0 end as qty, 0 as qty1
		from (
			select sum(qty) as qty, sum(tt) as tt
			from (
				select sum(qtyinvoiced) as qty, 0 as tt
				from c_invoice ci
				join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and civ.m_product_id = 1015088 and ci.issotrx = 'Y'
				where ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6411', '6417', '6418')
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when k.qty <> 0 then k.tt / k.qty else 0 end as qty1
		from (
			select sum(qty) as qty, sum(tt) as tt
			from (
				select sum(qtyinvoiced) as qty, 0 as tt
				from c_invoice ci
				join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and civ.m_product_id = 1015088 and ci.issotrx = 'Y'
				where ci.docstatus in ('CO', 'CL') and ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and acct.value in ('6411', '6417', '6418')
				where fc.ad_client_id = 1000019 and fc.C_Activity_ID = 1000273 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '19'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '20' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when (sum(qty3) + sum(qty4)) <> 0 then sum(qty2) / (sum(qty3) + sum(qty4)) else 0 end as qty, 0 as qty1
		from (
			select sum(fc.qty) as qty2, 0 as qty3, 0 as qty4
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000273 and ad_table_id = 325 and M_Product_ID = 1016237 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty2, sum(fc.qty) as qty3, 0 as qty4
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000273 and fc.C_Campaign_ID = 1000062 and ad_table_id = 325 and M_Product_ID = 1015088 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty2, 0 as qty3, sum(fc.qty) as qty4
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000273 and fc.C_Campaign_ID = 1000062 and ad_table_id = 325 and M_Product_ID = 1016903 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when (sum(qty3) + sum(qty4)) <> 0 then sum(qty2) / (sum(qty3) + sum(qty4)) else 0 end as qty1
		from (
			select sum(fc.qty) as qty2, 0 as qty3, 0 as qty4
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000273 and ad_table_id = 325 and M_Product_ID = 1016237 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty2, sum(fc.qty) as qty3, 0 as qty4
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000273 and fc.C_Campaign_ID = 1000062 and ad_table_id = 325 and M_Product_ID = 1015088 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as qty2, 0 as qty3, sum(fc.qty) as qty4
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and LEFT(acct.value, 2) in ('15')
			where fc.C_Activity_ID = 1000273 and fc.C_Campaign_ID = 1000062 and ad_table_id = 325 and M_Product_ID = 1016903 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '20'

union all

select '21' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '21' and ad_client_id = 1000019

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '22' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty, 0 as qty1
		from (
			select sum(civ.productionqty) as qty, 0 as tt
			from m_production ci
			join m_productionplan civ on ci.m_production_id = civ.m_production_id
			join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_Product_ID = 1000017
			where ci.docstatus in ('CO', 'CL') and ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate} and ci.ad_client_id = 1000003 and ci.ad_org_id = 1000049
			
			union all
			
			select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('621', '622', '627', '642')
			where fc.ad_client_id = 1000003 and fc.ad_org_id = 1000049 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty1
		from (
			select sum(civ.productionqty) as qty, 0 as tt
			from m_production ci
			join m_productionplan civ on ci.m_production_id = civ.m_production_id
			join m_product hh on civ.m_product_id = hh.m_product_id and hh.M_Product_ID = 1000017
			where ci.docstatus in ('CO', 'CL') and ci.movementdate >= $P{DateFrom} and ci.movementdate <= '01-31-2019' and ci.ad_client_id = 1000003 and ci.ad_org_id = 1000049
			
			union all
			
			select 0 as qty, sum(- fc.amtacctcr + fc.amtacctdr) as "tt"
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('621', '622', '627', '642')
			where fc.ad_client_id = 1000003 and fc.ad_org_id = 1000049 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '22'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '23' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qtyinvoiced) <> 0 then sum(linetotalamt) / sum(qtyinvoiced) else 0 end as qty, 0 as qty1
		from c_invoiceline civ
		join c_invoice ci on ci.c_invoice_id = civ.c_invoice_id and ci.docstatus in ('CO', 'CL') and ci.issotrx = 'N' and civ.m_product_id = 1000017
		where ci.ad_client_id = 1000003 and ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
		
		union all
		
		select 0 as qty, case when sum(qtyinvoiced) <> 0 then sum(linetotalamt) / sum(qtyinvoiced) else 0 end as qty1
		from c_invoiceline civ
		join c_invoice ci on ci.c_invoice_id = civ.c_invoice_id and ci.docstatus in ('CO', 'CL') and ci.issotrx = 'N' and civ.m_product_id = 1000017
		where ci.ad_client_id = 1000003 and ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '23'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '24' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty1 <> 0 then qty / qty1 else 0 end as qty, 0 as qty1
		from (
			select sum(qty) as qty, sum(qty1) as qty1
			from (
				select sum(qtyinternaluse) as qty, 0 as qty1
				from m_inventoryline civ
				join m_inventory ci on ci.m_inventory_id = civ.m_inventory_id
				where ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 1000007
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_productionplan civ
				join m_production ci on civ.m_production_id = ci.m_production_id
				join m_product hh on hh.m_product_id = civ.m_product_id and m_product_category_id = 1000017
				where ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 1000007
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty1 <> 0 then qty / qty1 else 0 end as qty1
		from (
			select sum(qty) as qty, sum(qty1) as qty1
			from (
				select sum(qtyinternaluse) as qty, 0 as qty1
				from m_inventoryline civ
				join m_inventory ci on ci.m_inventory_id = civ.m_inventory_id
				where ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 1000007
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_productionplan civ
				join m_production ci on civ.m_production_id = ci.m_production_id
				join m_product hh on hh.m_product_id = civ.m_product_id and m_product_category_id = 1000017
				where ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 1000007
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '24'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '25' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty1 <> 0 then qty / qty1 else 0 end as qty, 0 as qty1
		from (
			select sum(qty) as qty, sum(qty1) as qty1
			from (
				select sum(qtyinternaluse) as qty, 0 as qty1
				from m_inventoryline civ
				join m_inventory ci on ci.m_inventory_id = civ.m_inventory_id
				where ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 100018
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_productionplan civ
				join m_production ci on civ.m_production_id = ci.m_production_id
				join m_product hh on hh.m_product_id = civ.m_product_id and m_product_category_id = 1000017
				where ci.movementdate >= $P{StartDate} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 100018
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty1 <> 0 then qty / qty1 else 0 end as qty1
		from (
			select sum(qty) as qty, sum(qty1) as qty1
			from (
				select sum(qtyinternaluse) as qty, 0 as qty1
				from m_inventoryline civ
				join m_inventory ci on ci.m_inventory_id = civ.m_inventory_id
				where ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 1000018
				
				union all
				
				select 0 as qty, sum(civ.productionqty) as qty1
				from m_productionplan civ
				join m_production ci on civ.m_production_id = ci.m_production_id
				join m_product hh on hh.m_product_id = civ.m_product_id and m_product_category_id = 1000017
				where ci.movementdate >= $P{DateFrom} and ci.movementdate <= $P{EndDate} and ci.c_campaign_id = 1000018
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '25'
UNION ALL
select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, 1.5 * k.qty as a1, 1.5 * k.qty1 as a2
from (
	select '26' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(civ.qtyinvoiced) as qty, sum(civ.linenetamt) as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'N' and civ.m_product_id = 1000017 and ci.docstatus in ('CL', 'CO')
			where dateacct >= $P{StartDate} and dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(civ.qtyinvoiced) as qty, sum(civ.linenetamt) as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.issotrx = 'N' and civ.m_product_id = 1000017 and ci.docstatus in ('CL', 'CO')
			where dateacct >= $P{DateFrom} and dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '26'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '27' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('622', '627')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(ci.productionqty) as qty
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.ad_client_id = 1000003 and civ.movementdate >= $P{StartDate} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('622', '627')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(ci.productionqty) as qty
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.ad_client_id = 1000003 and civ.movementdate >= $P{DateFrom} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '27'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '28' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('642')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(ci.productionqty) as qty
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id and civ.docstatus in ('CO', 'CL')
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.ad_client_id = 1000003 and civ.C_Activity_ID = 1000053 and civ.movementdate >= $P{StartDate} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('642')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(ci.productionqty) as qty
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id and civ.docstatus in ('CO', 'CL')
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.ad_client_id = 1000003 and civ.C_Activity_ID = 1000053 and civ.movementdate >= $P{DateFrom} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '28'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '29' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('641')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(qtyentered)
				from m_inout ci
				join m_inoutline civ on ci.m_inout_id = civ.m_inout_id and ci.issotrx = 'Y' and ci.docstatus in ('CL', 'CO')
				join m_attributesetinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('641')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(qtyentered)
				from m_inout ci
				join m_inoutline civ on ci.m_inout_id = civ.m_inout_id and ci.issotrx = 'Y' and ci.docstatus in ('CL', 'CO')
				join m_attributesetinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '29'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '30' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('6412')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(qtyentered)
				from m_inout ci
				join m_inoutline civ on ci.m_inout_id = civ.m_inout_id and ci.issotrx = 'Y' and ci.docstatus in ('CL', 'CO')
				join m_attributesetinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(tt) as tt, sum(qty) as qty
			from (
				select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
				from fact_acct fc
				join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('6412')
				where fc.ad_client_id = 1000003 and fc.C_Activity_ID = 1000053 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
				
				union all
				
				select 0 as tt, sum(qtyentered)
				from m_inout ci
				join m_inoutline civ on ci.m_inout_id = civ.m_inout_id and ci.issotrx = 'Y' and ci.docstatus in ('CL', 'CO')
				join m_attributesetinstance tt on tt.m_attributesetinstance_id = civ.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
				where ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '30'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '31' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when qty <> 0 then tt / qty else 0 end as qty, 0 as qty1
		from (
			select sum(qtyinvoiced) as qty, sum(totallines) as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.docstatus in ('CL', 'CO') and issotrx = 'Y' and ci.ad_client_id = 1000003
			join m_attributesetinstance tt on civ.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
			where ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when qty <> 0 then tt / qty else 0 end as qty1
		from (
			select sum(qtyinvoiced) as qty, sum(totallines) as tt
			from c_invoice ci
			join c_invoiceline civ on ci.c_invoice_id = civ.c_invoice_id and ci.docstatus in ('CL', 'CO') and issotrx = 'Y' and ci.ad_client_id = 1000003
			join m_attributesetinstance tt on civ.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000000
			where ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '31'

union all

select '33' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '33' and ad_client_id = 1000019

union all

select '34' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '34' and ad_client_id = 1000019

union all

select '35' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '35' and ad_client_id = 1000019

union all

select '36' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '36' and ad_client_id = 1000019

union all

select '37' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '37' and ad_client_id = 1000019

union all

select '38' as id, hm.description as stt, name, null::int4 as hsv_dinhmuc, null::int4 as a1, null::int4 as a2
from hsv_chiso hm
where value = '38' and ad_client_id = 1000019

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '39' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty, 0 as qty1
		from (
			select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('622', '627')
			where fc.ad_client_id = 1000006 and fc.C_Activity_ID = 1000072 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as tt, sum(a1) - sum(a2) as qty
			from (
				select sum(ci.productionqty) as a1, 0 as a2
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{StartDate} and civ.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as a1, sum(ci.qtyinternaluse) as a2
				from m_inventoryline ci
				join m_inventory civ on ci.m_inventory_id = civ.m_inventory_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{StartDate} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty1
		from (
			select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('622', '627')
			where fc.ad_client_id = 1000006 and fc.C_Activity_ID = 1000072 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as tt, sum(a1) - sum(a2) as qty
			from (
				select sum(ci.productionqty) as a1, 0 as a2
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{DateFrom} and civ.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as a1, sum(ci.qtyinternaluse) as a2
				from m_inventoryline ci
				join m_inventory civ on ci.m_inventory_id = civ.m_inventory_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{DateFrom} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '39'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '40' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty, 0 as qty1
		from (
			select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('642')
			where fc.ad_client_id = 1000006 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as tt, sum(a1) - sum(a2) as qty
			from (
				select sum(ci.productionqty) as a1, 0 as a2
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{StartDate} and civ.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as a1, sum(ci.qtyinternaluse) as a2
				from m_inventoryline ci
				join m_inventory civ on ci.m_inventory_id = civ.m_inventory_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{StartDate} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty1
		from (
			select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('642')
			where fc.ad_client_id = 1000006 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as tt, sum(a1) - sum(a2) as qty
			from (
				select sum(ci.productionqty) as a1, 0 as a2
				from m_productionplan ci
				join m_production civ on ci.m_production_id = civ.m_production_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{DateFrom} and civ.movementdate <= $P{EndDate}
				
				union all
				
				select 0 as a1, sum(ci.qtyinternaluse) as a2
				from m_inventoryline ci
				join m_inventory civ on ci.m_inventory_id = civ.m_inventory_id
				join m_attributesetinstance tt on ci.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
				where ci.ad_client_id = 1000006 and civ.movementdate >= $P{DateFrom} and civ.movementdate <= $P{EndDate}
				) as k
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '40'

union all

select hm.value as id, hm.description as stt, NAME, hm.hsv_dinhmuc, k.qty as a1, k.qty1 as a2
from (
	select '41' as id, sum(qty) as qty, sum(qty1) as qty1
	from (
		select case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty, 0 as qty1
		from (
			select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('641')
			where fc.ad_client_id = 1000006 and fc.dateacct >= $P{StartDate} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as tt, sum(qtyentered) as qty
			from m_inout ci
			join m_inoutline civ on ci.m_inout_id = civ.m_inout_id and ci.issotrx = 'Y' and ci.docstatus in ('CO', 'CL')
			join m_attributesetinstance tt on civ.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
			where ci.ad_client_id = 1000006 and ci.dateacct >= $P{StartDate} and ci.dateacct <= $P{EndDate}
			) as k
		
		union all
		
		select 0 as qty, case when sum(qty) <> 0 then sum(tt) / sum(qty) else 0 end as qty1
		from (
			select sum(- fc.amtacctcr + fc.amtacctdr) as "tt", 0 as qty
			from fact_acct fc
			join c_elementvalue acct on fc.account_id = acct.c_elementvalue_id and left(acct.value, 3) in ('641')
			where fc.ad_client_id = 1000006 and fc.dateacct >= $P{DateFrom} and fc.dateacct <= $P{EndDate}
			
			union all
			
			select 0 as tt, sum(qtyentered) as qty
			from m_inout ci
			join m_inoutline civ on ci.m_inout_id = civ.m_inout_id and ci.issotrx = 'Y' and ci.docstatus in ('CO', 'CL')
			join m_attributesetinstance tt on civ.m_attributesetinstance_id = tt.m_attributesetinstance_id and tt.M_AttributeSet_ID = 1000064
			where ci.ad_client_id = 1000006 and ci.dateacct >= $P{DateFrom} and ci.dateacct <= $P{EndDate}
			) as k
		) as k
	) as k
join hsv_chiso hm on k.id = hm.value and hm.value = '41']]>
	</queryString>
	<field name="id" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="id"/>
	</field>
	<field name="stt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="stt"/>
	</field>
	<field name="name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="name"/>
	</field>
	<field name="hsv_dinhmuc" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="hsv_dinhmuc"/>
	</field>
	<field name="a1" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a1"/>
	</field>
	<field name="a2" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a2"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch">
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement key="textField-5" x="-1" y="56" width="575" height="23" uuid="1ef15771-7fb0-4d46-af68-bc2c09bc069b"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression><![CDATA["Kỳ báo cáo : " + new SimpleDateFormat("dd/MM/yyyy").format($P{StartDate}) + " To "  + new SimpleDateFormat("dd/MM/yyyy").format($P{EndDate})]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement key="textField-6" x="0" y="37" width="575" height="23" uuid="009c72d4-f50e-4c68-9e8c-d4900272c965"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="14" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression><![CDATA["BÁO CÁO TỶ LỆ  SẢN XUẤT"]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="23" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="30" height="23" uuid="f7a88de7-7450-4fab-b21c-13057f97ec56">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8290ae61-3963-4a21-94c1-b81aef6a3e01"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[STT]]></text>
			</staticText>
			<staticText>
				<reportElement x="30" y="0" width="230" height="23" uuid="f9fe0237-502e-491c-a560-c2f7d6d7284c">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b7f74287-541b-4601-80b1-27a886774e29"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Nội dung]]></text>
			</staticText>
			<staticText>
				<reportElement x="260" y="0" width="73" height="23" uuid="fde50dda-09df-440e-be37-d8069ffdaf42">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="df5ce22c-34e7-4a51-8b85-eae521725ebd"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Định mức]]></text>
			</staticText>
			<staticText>
				<reportElement x="333" y="0" width="111" height="23" uuid="fac0ab38-3bcd-4c34-99f6-8d99d36093fc">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b8b51d58-e664-4165-9b78-13d89f29686e"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Phát sinh trong kỳ]]></text>
			</staticText>
			<staticText>
				<reportElement x="444" y="0" width="111" height="23" uuid="facc89ac-9038-4f31-8d6c-27f0ac759218">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="4acd74a4-8372-45b6-8885-315de2a8274f"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Lũy kế từ đầu]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="23" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="30" height="23" uuid="a2cccc46-a1b0-4939-acf1-9397b4108ad5">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8290ae61-3963-4a21-94c1-b81aef6a3e01"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{stt}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="30" y="0" width="230" height="23" uuid="afea2517-12fd-4900-874a-e77174e7aac0">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b7f74287-541b-4601-80b1-27a886774e29"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{name}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement x="260" y="0" width="73" height="23" uuid="9d63a1a5-d1fa-4410-8855-42560d0df2e0">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="df5ce22c-34e7-4a51-8b85-eae521725ebd"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{hsv_dinhmuc}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement x="333" y="0" width="111" height="23" uuid="5a01a75b-f30e-46e0-bd5f-bf6710762495">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b8b51d58-e664-4165-9b78-13d89f29686e"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##" isBlankWhenNull="true">
				<reportElement x="444" y="0" width="111" height="23" uuid="1ff7d5a9-8570-4730-89b8-cb602f80a0ea">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="4acd74a4-8372-45b6-8885-315de2a8274f"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a2}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="30" splitType="Stretch">
			<textField>
				<reportElement x="-9" y="0" width="268" height="30" uuid="067894fc-aae8-4bbf-a59c-c80e09165369">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="260" y="0" width="295" height="30" uuid="b826f7cc-1eca-4fb4-b94e-58e2a0bf9031">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression><![CDATA["/"+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="46" splitType="Stretch">
			<staticText>
				<reportElement x="11" y="26" width="89" height="20" uuid="321ada2e-336e-430a-b822-8420368b8d0f">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Người lập]]></text>
			</staticText>
			<staticText>
				<reportElement x="201" y="26" width="119" height="20" uuid="9dffa546-5ea0-4f84-85c9-422752bf572a">
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Kiểm soát]]></text>
			</staticText>
			<staticText>
				<reportElement x="406" y="5" width="50" height="20" uuid="0c9361ae-fe87-4697-abf6-bfd0696dae4b"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[Ngày in:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH:mm">
				<reportElement x="460" y="5" width="84" height="21" uuid="87a470dd-c72f-4cda-82ef-cc62fb130ce7"/>
				<textElement verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="382" y="26" width="160" height="20" uuid="e1c9ef74-e2fe-47be-b89f-07fc6429f773">
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Giám đốc]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
