<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.4.3.final using JasperReports Library version 6.4.3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="sanxuat_c3" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="792" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="065b1d87-137b-43b5-b1e2-5aa23a87fc7d">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HSV"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<queryString>
		<![CDATA[
SELECT 'III. Tỷ lệ NL/TP' AS a2,
case when a23<>0 then round(a3/a23,2) else 0 end as a3,
case when a24<>0 then round(a3/a24,2) else 0 end as a4,
case when a25<>0 then round(a3/a25,2) else 0 end as a5,
case when a26<>0 then round(a3/a26,2) else 0 end as a6,
case when a27<>0 then round(a3/a27,2) else 0 end as a7,
case when a28<>0 then round(a3/a28,2) else 0 end as a8,
case when a29<>0 then round(a3/a29,2) else 0 end as a9,
case when a30<>0 then round(a3/a30,2) else 0 end as a10
FROM(
SELECT sum(a3) AS a3,sum(a4) AS a4,sum(a5) AS a5,sum(a6) AS a6,sum(a7) AS a7,sum(a8) AS a8,sum(a9) AS a9,sum(a10) AS a10,sum(a23) AS a23,sum(a24) AS a24,sum(a25) AS a25,sum(a26) AS a26,sum(a27) AS a27,sum(a28) AS a28, sum(a29) AS a29, sum(a30) AS a30
FROM(

SELECT id, sum(a3) AS a3,sum(a4) AS a4,sum(a5) a5,sum(a6) AS a6,sum(a7) AS a7,sum(a8) AS a8,sum(a9) AS a9,sum(a10) AS a10,0 AS a23, 0 AS a24, 0 AS a25, 0 AS a26, 0 AS a27, 0 AS a28, 0 AS a29, 0 AS a30 FROM (
SELECT '1' AS id,'I.Nguyên Liệu'AS a2,NULL::int4 AS a3,NULL::int4 AS a4,NULL::int4 AS a5,NULL::int4 AS a6,NULL::int4 AS a7,NULL::int4 AS a8,NULL::int4 AS a9,NULL::int4 AS a10
UNION ALL
-----
SELECT id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9,(t.a7-t.a8-t.a9)-(t.a3-t.a4-t.a5-t.a6) AS a10 FROM
(
    SELECT '1' AS id, '1. Ván sấy  loại A' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT  CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT  0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT  0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073 AND ci.issotrx = 'N'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT  0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL
   --a7.1--
   
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
     
 
    --a8--
        UNION ALL
        SELECT  0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073 AND ci.issotrx = 'Y'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
        
    --a9--
        UNION ALL
    
        SELECT  0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004073
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t

UNION ALL 
SELECT '1' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9,(t.a7-t.a8-t.a9)-(t.a3-t.a4-t.a5-t.a6) AS a10 FROM
(
SELECT  '2. Ván sấy Loại A+' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT  CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT  0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT  0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071 AND ci.issotrx = 'N'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT  0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL

   --a7.1--
   
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
    UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071 AND ci.issotrx = 'Y'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004071
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
---
UNION ALL
SELECT '1' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9,(t.a7-t.a8-t.a9)-(t.a3-t.a4-t.a5-t.a6) AS a10 FROM
(
    SELECT '3. Ván sấy Loai B' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072 AND ci.issotrx = 'N'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        
        
        UNION ALL

   --a7.1--
   
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
         
    
        UNION ALL
   
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072 AND ci.issotrx = 'Y'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004072
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
UNION ALL
SELECT '1' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9,(t.a7-t.a8-t.a9)-(t.a3-t.a4-t.a5-t.a6) AS a10 FROM
(
    SELECT '4. Ván sấy  Loại C' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070 AND ci.issotrx = 'N'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL

   --a7.1--
   
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
   
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070 AND ci.issotrx = 'Y'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1004070
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
UNION ALL
SELECT '1' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9,(t.a7-t.a8-t.a9)-(t.a3-t.a4-t.a5-t.a6) AS a10 FROM
(
    SELECT '5. Ván may , p loại dở dang cuối kỳ' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052 AND ci.issotrx = 'N'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
    
        UNION ALL
   
   --a7.1--
   
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052 AND ci.issotrx = 'Y'
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL') AND civ.M_Product_ID=1013052
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        ) AS k
    ) AS t
)AS f GROUP BY id

----------------------------
UNION ALL
SELECT id, 0 AS a3,0 AS a4,0 AS a5,0 AS a6, 0 AS a7, 0 AS a7,0 AS a8,0 AS a10,sum(a3) AS a23, sum(a4) AS a24, sum(a5) AS a25, sum(a6) AS a26,sum(a7) AS a27,sum(a8)AS a28,sum(a9) AS a29,sum(a10) AS a30 FROM(
SELECT '2' AS id,'II. Thành phẩm'AS a2,NULL::int4 AS a3,NULL::int4 AS a4,NULL::int4 AS a5,NULL::int4 AS a6,NULL::int4 AS a7,NULL::int4 AS a8,NULL::int4 AS a9,NULL::int4 AS a10
UNION ALL
SELECT '2' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9, (t.a3 -t.a7) - (t.a5+t.a6) + (t.a8+t.a9) AS a10 
FROM (
    SELECT '2' AS id, '1. Ván cốt thiếu' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7, 0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7, 0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7, 0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'N'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7, 0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7, 0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL
        --a7.1--
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'Y'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000080
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
UNION ALL
SELECT '2' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9, (t.a3 -t.a7) - (t.a5+t.a6) + (t.a8+t.a9) AS a10 
FROM (
    SELECT '2. Ván cốt đủ' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'N'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL
      --a7.1--
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'Y'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000070
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
UNION ALL
SELECT '2' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9, (t.a3 -t.a7) - (t.a5+t.a6) + (t.a8+t.a9) AS a10 
FROM (
    SELECT '3. Ván thành phẩm DH' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'N'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL
      --a7.1--
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'Y'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000064
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
UNION ALL
SELECT '2' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9, (t.a3 -t.a7) - (t.a5+t.a6) + (t.a8+t.a9) AS a10 
FROM (
    SELECT '4. Ván bị lỗi thanh lý' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
 
        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'N'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL
      --a7.1--
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'Y'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000081
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
    ) AS k
) AS t
UNION ALL
SELECT '2' AS id, t.a2,t.a3,t.a4,t.a5,t.a6,t.a7,t.a8,t.a9, (t.a3 -t.a7) - (t.a5+t.a6) + (t.a8+t.a9) AS a10 
FROM (
    SELECT '5. Ván dở dang tồn kho' AS a2, sum(a4) + sum(a5)+ sum(a6)+ sum(a3) AS a3, sum (a4) AS a4 , sum(a5) AS a5, sum(a6) AS a6,sum(a7)+sum("a7.1")+sum(a8)+sum(a9) AS a7, sum(a8) AS a8, sum(a9) AS a9 
    FROM(
    --a3--
        SELECT CASE WHEN civ.qtycount>=civ.qtybook  THEN  civ.qtycount - civ.qtybook ELSE 0 END AS a3,0 AS a4, 0 AS A5,0 AS a6,0 AS a7,0 AS "a7.1", 0 AS a8,0 AS a9  FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 

        UNION ALL
    --a4--
        SELECT 0 AS a3,civ.productionqty AS a4, 0 AS a5 ,0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_productionplan civ 
        JOIN m_production ci ON ci.m_production_id = civ.m_production_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        UNION ALL
    --a5--
        SELECT 0 AS a3,0 AS a4, movementqty AS a5, 0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'N'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a6--
        UNION ALL 
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  movementqty AS a6,0 AS a7,0 AS "a7.1",0 AS a8,0 AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locatorto_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
   
        UNION ALL
    --a7--
        SELECT 0 AS a3, 0 AS a4,0 AS a5,0 AS a6, CASE WHEN civ.qtycount<civ.qtybook  THEN  civ.qtybook - civ.qtycount ELSE 0 END AS a7,0 AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047  
    
        UNION ALL
   
      --a7.1--
        SELECT  0 AS a3, 0 AS a4,0 AS a5,0 AS a6, 0 AS a7, civ.qtyinternaluse  AS "a7.1", 0 AS a8,0 AS a9 
        FROM m_inventoryline civ 
        JOIN m_inventory ci ON ci.m_inventory_id = civ.m_inventory_id AND ci.docstatus IN ('CO', 'CL') 
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
        UNION ALL
    --a8--
   
        SELECT 0 AS a3,0 AS a4, 0 AS a5, 0 AS a6, 0 AS a7,0 AS "a7.1",movementqty AS a8,0 AS a9 FROM m_inoutline civ 
        JOIN m_inout ci ON ci.m_inout_id = civ.m_inout_id AND ci.docstatus IN ('CO', 'CL')  AND ci.issotrx = 'Y'
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        WHERE  ci.dateacct >='01-01-2018' AND ci.dateacct <='12-31-2018' AND ci.ad_org_id = 1000047
    --a9--
        UNION ALL
    
        SELECT 0 AS a3,0 AS a4, 0 AS a5,  0 AS a6,0 AS a7,0 AS "a7.1",0 AS a8,movementqty AS a9
        FROM m_movementline civ  JOIN m_movement ci ON civ.m_movement_id = ci.m_movement_id  AND ci.docstatus IN ('CO', 'CL')
        JOIN m_product hh ON civ.m_product_id = hh.m_product_id AND hh.M_AttributeSet_ID=1000083
        JOIN m_locator lo ON lo.m_locator_id = civ.m_locator_id AND lo.ad_org_id = 1000047
        WHERE ci.movementdate >='01-01-2018' AND ci.movementdate <='12-31-2018' AND ci.ad_org_id = 1000047 
    
        ) AS k
    ) AS t
) AS f GROUP BY id
) AS g
) as j]]>
	</queryString>
	<field name="a2" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="a2"/>
	</field>
	<field name="a3" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a3"/>
	</field>
	<field name="a4" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a4"/>
	</field>
	<field name="a5" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a5"/>
	</field>
	<field name="a6" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a6"/>
	</field>
	<field name="a7" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a7"/>
	</field>
	<field name="a8" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a8"/>
	</field>
	<field name="a9" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a9"/>
	</field>
	<field name="a10" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="a10"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<detail>
		<band height="23" splitType="Stretch">
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="524" y="0" width="75" height="23" uuid="ccae3316-0609-4264-9d6e-877e0edec09d">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="ea020885-eecc-4fd5-b78f-9ec6a62a9b01"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a8}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="599" y="0" width="75" height="23" uuid="85d5a760-f405-4863-b055-b5a75dbfb890">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="132b6c61-671d-4e78-9b05-3c8a2c2c14fe"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a9}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="299" y="0" width="75" height="23" uuid="8e5f40e7-ecef-49f7-a4f7-fe9685883ee1">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="b08dc631-ed92-479e-95d4-1022cdb0ce89"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a5}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="374" y="0" width="75" height="23" uuid="4c316b1a-2cfa-4bac-b912-a405bba03d3e">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="08413aca-e4e7-465b-9fcc-9a8db819e166"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a6}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="674" y="0" width="75" height="23" uuid="e076ae4e-e9ec-4372-8280-b3ffd1a9dcbf">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="e9e3e274-4a45-4066-920a-f89d37fde3cc"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a10}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="449" y="0" width="75" height="23" uuid="e74ad1c6-a54d-4468-9064-888cd39608e5">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="e0bb69a1-9af6-4bba-bb4a-faa43ba3a6d6"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a7}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="149" y="0" width="75" height="23" uuid="d45c4cad-9387-4dd6-95c6-353b5af3ea4b">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="64adf199-f111-4839-9c68-14ed2a43c0ef"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a3}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement x="224" y="0" width="75" height="23" uuid="a33e52b6-e421-432c-be9b-84b9a39e96e8">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d4972b30-a9b3-4848-9908-c26d186721fe"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a4}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement key="" x="-1" y="0" width="150" height="23" uuid="842583b7-ba99-48a0-9ebe-aa3f042d6c06">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="aee75f36-b2cb-4686-a0e9-1b2027b29aea"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
					<paragraph lineSpacing="Double"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{a2}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
