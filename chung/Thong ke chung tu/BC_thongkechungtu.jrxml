<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.17.0.final using JasperReports Library version 6.17.0-6d93193241dd8cc42629e188b94f9e0bc5722efd  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="BC_thongkechungtu" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="f42e49ae-f945-4196-93ef-500de810ee0b">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="adempiere7.1"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer"/>
	<parameter name="C_Period_ID" class="java.lang.Integer"/>
	<parameter name="AD_User_ID" class="java.lang.Integer"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["dev/"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[
select ROW_NUMBER() OVER (PARTITION BY noidung ORDER BY noidung) AS stt,noidung ,nguoicapnhat,hoanthanh,khongdung, cham,tyle
from(

select 'Phiếu xuất bán' as noidung,nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from m_inout mi
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'Y' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name


union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from m_inout mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.issotrx = 'Y' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,count(*) as cham 
from m_inout mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'Y' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k
union all 

select 'Phiếu nhập mua' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from m_inout mi
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'N' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from m_inout mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.issotrx = 'N' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,count(*) as cham 
from m_inout mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'N' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k

union all 

select 'Hóa đơn mua' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from c_invoice mi
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'N' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from c_invoice mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.issotrx = 'N' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,count(*) as cham 
from c_invoice mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'N' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k

union all 

select 'Hóa đơn bán' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from c_invoice mi
join ad_user us on us.ad_user_id = mi.updatedby 

 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'Y' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name





union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from c_invoice mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.issotrx = 'Y' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,count(*) as cham 
from c_invoice mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.issotrx = 'Y' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k


union all

select 'Phiếu xuất kho sử dụng' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from m_inventory mi
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMI' and docsubtypeinv ='IU'
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO'  and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from m_inventory mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMI' and docsubtypeinv ='IU'
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,count(*) as cham 
from m_inventory mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMI' and docsubtypeinv ='IU'
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k
union all 

select 'Phiếu nhập kho do sản xuất' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from m_production mi
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO'  and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from m_production mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,count(*) as cham 
from m_production mi
join ad_user us on us.ad_user_id = mi.updatedby
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k

union all
select 'Phiếu kiểm kê' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from m_inventory mi
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMI' and docsubtypeinv ='PI'
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO'  and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 

select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from m_inventory mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMI' and docsubtypeinv ='PI'
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,COUNT(*) as cham
from m_inventory mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMI' and docsubtypeinv ='PI'
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k

union all

select 'Phiếu chuyển kho' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from m_movement mi
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMM' 
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO'  and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 

select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from m_movement mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMM' 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.movementdate >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.movementdate <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,COUNT(*) as cham
from m_movement mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='MMM' 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k
union all 

select 'Phiếu kế toán' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from gl_journal mi
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='GLJ'  
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO'  and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 

select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from gl_journal mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='GLJ' 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,COUNT(*) as cham
from gl_journal mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype ='GLJ' 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k

union all 

select 'Phiếu thanh toán' as noidung, nguoicapnhat,hoanthanh,khongdung, cham, case when hoanthanh<>0 then 100*khongdung/hoanthanh else 0 end as tyle
from(
select nguoicapnhat,sum(sohoanthanh) as hoanthanh,sum(khongdung) as khongdung, sum(cham) as cham
from(
select us.name as nguoicapnhat,
 count(*) as sohoanthanh, 0 as khongdung,0 as cham
from c_payment mi
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype in ('APP','ARR') 
join ad_user us on us.ad_user_id = mi.updatedby 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO'  and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name

union all 

select us.name as nguoicapnhat,
0 as sohoanthanh, count (*)/2 khongdung, 0 as cham
from c_payment mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype in ('APP','ARR')
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'RE' and mi.dateacct >= (select StartDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) and mi.dateacct <= (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID}) 
group by us.name
union all 
select us.name as nguoicapnhat,
0 as sohoanthanh, 0 as khongdung,COUNT(*) as cham
from c_payment mi
join ad_user us on us.ad_user_id = mi.updatedby
join c_doctype doc on mi.c_doctype_id  = doc.c_doctype_id and docbasetype in ('APP','ARR') 
 where mi.ad_client_id = $P{AD_CLIENT_ID} and (us.ad_user_id = $P{AD_User_ID} or $P{AD_User_ID} is null) and  mi.docstatus = 'CO' and mi.updated > (select EndDate from c_period cp where cp.c_period_id =$P{C_Period_ID} and ad_client_id =$P{AD_CLIENT_ID})  
group by us.name
) as k
group by nguoicapnhat

) as k
) as k
]]>
	</queryString>
	<field name="stt" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="stt"/>
		<property name="com.jaspersoft.studio.field.label" value="stt"/>
	</field>
	<field name="noidung" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="noidung"/>
		<property name="com.jaspersoft.studio.field.label" value="noidung"/>
	</field>
	<field name="nguoicapnhat" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="nguoicapnhat"/>
		<property name="com.jaspersoft.studio.field.label" value="nguoicapnhat"/>
	</field>
	<field name="hoanthanh" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="hoanthanh"/>
		<property name="com.jaspersoft.studio.field.label" value="hoanthanh"/>
	</field>
	<field name="khongdung" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="khongdung"/>
		<property name="com.jaspersoft.studio.field.label" value="khongdung"/>
	</field>
	<field name="cham" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="cham"/>
		<property name="com.jaspersoft.studio.field.label" value="cham"/>
	</field>
	<field name="tyle" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="tyle"/>
		<property name="com.jaspersoft.studio.field.label" value="tyle"/>
	</field>
	<variable name="sum_hoanthanh" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1" calculation="Sum">
		<variableExpression><![CDATA[$F{hoanthanh}]]></variableExpression>
	</variable>
	<variable name="sum_khongdung" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1" calculation="Sum">
		<variableExpression><![CDATA[$F{khongdung}]]></variableExpression>
	</variable>
	<variable name="sum_cham" class="java.math.BigDecimal" resetType="Group" resetGroup="Group1" calculation="Sum">
		<variableExpression><![CDATA[$F{cham}]]></variableExpression>
	</variable>
	<group name="Group1">
		<groupExpression><![CDATA[$F{noidung}]]></groupExpression>
		<groupHeader>
			<band height="30">
				<textField>
					<reportElement x="0" y="0" width="555" height="30" uuid="09d0fdf8-7dd0-4af0-a462-3609b215161d"/>
					<box padding="2">
						<pen lineWidth="0.25"/>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font fontName="Arial" size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{noidung}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="30">
				<textField pattern="#,##0.##">
					<reportElement x="371" y="0" width="92" height="30" uuid="8a0fdfad-94dd-4287-adc9-ebb851f54fc1">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="61d8c343-b538-43b3-9e0c-60226dcba4f7"/>
					</reportElement>
					<box padding="2">
						<pen lineWidth="0.25"/>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_cham}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="0" y="0" width="187" height="30" uuid="17fa8b89-333d-4da2-b748-c37004bf57dd">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1403e46c-403f-4641-a311-067b82f79e95"/>
					</reportElement>
					<box padding="2">
						<pen lineWidth="0.25"/>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font fontName="Arial" size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Cộng tổng"]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.##">
					<reportElement x="463" y="0" width="92" height="30" uuid="311b2604-b05f-4f48-916b-97789aaded71">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="54bc58bd-6b0d-4262-9782-77fbdb2ae51d"/>
					</reportElement>
					<box padding="2">
						<pen lineWidth="0.25"/>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[new Double($V{sum_hoanthanh}.doubleValue() == 0 ? 0 :
($V{sum_khongdung}.doubleValue()/$V{sum_hoanthanh}.doubleValue()))]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.##">
					<reportElement x="279" y="0" width="92" height="30" uuid="3f7a042a-7fa8-4842-bb07-71ca3e736c04">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="5de0fe3a-ed4b-40ec-bfff-6a26a2cdeb16"/>
					</reportElement>
					<box padding="2">
						<pen lineWidth="0.25"/>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_khongdung}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.##">
					<reportElement x="187" y="0" width="92" height="30" uuid="4ad2d242-8a79-40ca-b1e8-7a565d5c2ca8">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1418c201-d722-495b-a791-37dd059fd8c1"/>
					</reportElement>
					<box padding="2">
						<pen lineWidth="0.25"/>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="11" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_hoanthanh}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="90" splitType="Stretch">
			<subreport>
				<reportElement x="0" y="0" width="375" height="49" uuid="a74d8ca2-d19a-4c57-9000-5511145e94f8"/>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_User_ID">
					<subreportParameterExpression><![CDATA[$P{AD_User_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="C_Period_ID">
					<subreportParameterExpression><![CDATA[$P{C_Period_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"CompanyHeader.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement x="0" y="44" width="555" height="30" uuid="46480819-c94a-402c-97c5-9d8dea25fc09">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="18" isBold="true"/>
				</textElement>
				<text><![CDATA[THỐNG KÊ CHỨNG TỪ LỖI]]></text>
			</staticText>
			<subreport>
				<reportElement x="0" y="70" width="555" height="20" uuid="33d8fec0-141b-42b2-991d-f9197d486947"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="C_Period_ID">
					<subreportParameterExpression><![CDATA[$P{C_Period_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_User_ID">
					<subreportParameterExpression><![CDATA[$P{AD_User_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"sub_Ky_ketoan.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</title>
	<columnHeader>
		<band height="30" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="50" height="30" uuid="8480f867-faaa-49ef-8d94-698bbaac5ef2">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="2cd3190a-da1a-4195-aa6a-2dda883d5828"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[STT]]></text>
			</staticText>
			<staticText>
				<reportElement x="50" y="0" width="137" height="30" uuid="c043d4ca-64a4-4258-bc51-37de5d15e4cb">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1403e46c-403f-4641-a311-067b82f79e95"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[nguoicapnhat]]></text>
			</staticText>
			<staticText>
				<reportElement x="187" y="0" width="92" height="30" uuid="f0332831-9fe8-4df1-b973-dd9c5c508689">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1418c201-d722-495b-a791-37dd059fd8c1"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[hoanthanh]]></text>
			</staticText>
			<staticText>
				<reportElement x="279" y="0" width="92" height="30" uuid="2c32ac6e-40e5-479f-bae4-51b251e193d6">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="5de0fe3a-ed4b-40ec-bfff-6a26a2cdeb16"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[khongdung]]></text>
			</staticText>
			<staticText>
				<reportElement x="371" y="0" width="92" height="30" uuid="6996c025-6f79-44fc-8721-d6dcb54cc03c">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="61d8c343-b538-43b3-9e0c-60226dcba4f7"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[cham]]></text>
			</staticText>
			<staticText>
				<reportElement x="463" y="0" width="92" height="30" uuid="1836a5c6-5308-4217-ac5e-cab33242f24f">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="54bc58bd-6b0d-4262-9782-77fbdb2ae51d"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[tyle]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="30" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="50" height="30" uuid="e48e99c4-5f9b-49be-88bd-04f281c8dd80">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="2cd3190a-da1a-4195-aa6a-2dda883d5828"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{stt}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="50" y="0" width="137" height="30" uuid="0f58ea51-c4f1-4fa9-8eb5-04202415fdac">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1403e46c-403f-4641-a311-067b82f79e95"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nguoicapnhat}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##">
				<reportElement x="187" y="0" width="92" height="30" uuid="4be4a799-8fb0-46aa-8957-f78cec340bab">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1418c201-d722-495b-a791-37dd059fd8c1"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{hoanthanh}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##">
				<reportElement x="279" y="0" width="92" height="30" uuid="863cdd80-1458-4257-8f1e-97cf564f5961">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="5de0fe3a-ed4b-40ec-bfff-6a26a2cdeb16"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{khongdung}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##">
				<reportElement x="371" y="0" width="92" height="30" uuid="2d796db4-c917-4638-abd1-511d2543660a">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="61d8c343-b538-43b3-9e0c-60226dcba4f7"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cham}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##">
				<reportElement x="463" y="0" width="92" height="30" uuid="ae9e3b8a-11cf-448b-87f7-eee9bd937cde">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="54bc58bd-6b0d-4262-9782-77fbdb2ae51d"/>
				</reportElement>
				<box padding="2">
					<pen lineWidth="0.25"/>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tyle}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="25" splitType="Stretch">
			<textField>
				<reportElement x="-18" y="0" width="295" height="25" uuid="db85b10a-c786-4ce3-b6b8-a03df60608a6">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Bottom"/>
				<textFieldExpression><![CDATA["- "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="277" y="0" width="295" height="25" uuid="85b7ca8f-3be5-46d2-9d8f-a697f9b0c9ec">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Bottom"/>
				<textFieldExpression><![CDATA["/" +$V{PAGE_NUMBER}+ " -"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch">
			<staticText>
				<reportElement x="11" y="22" width="89" height="20" uuid="93a52767-8fce-4df5-ba20-244b571491dc">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Người lập]]></text>
			</staticText>
			<staticText>
				<reportElement x="201" y="22" width="119" height="20" uuid="57fe958b-425e-40c5-b450-6d73926e5c78">
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Kiểm soát]]></text>
			</staticText>
			<staticText>
				<reportElement x="382" y="22" width="160" height="20" uuid="55cec62b-4178-4953-aab9-658914e39994">
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Giám đốc]]></text>
			</staticText>
			<staticText>
				<reportElement x="406" y="2" width="50" height="20" uuid="8b887127-b0ee-4038-a00e-2de66c683623"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Ngày in:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH:mm">
				<reportElement x="456" y="2" width="115" height="20" uuid="0b5458d2-e16b-49ba-8af2-c082cfa6262c">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
