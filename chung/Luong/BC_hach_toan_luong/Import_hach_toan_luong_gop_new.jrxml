<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.19.1.final using JasperReports Library version 6.19.1-867c00bf88cd4d784d404379d6c05e1b419e8a4c  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="hach_toan_luong" pageWidth="1080" pageHeight="709" orientation="Landscape" columnWidth="1080" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="f36939f8-610e-4105-80ec-11593e266e7b">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="true"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="true"/>
	<property name="net.sf.jasperreports.export.xls.ignore.cell.border" value="false"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HSV"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer"/>
	<parameter name="C_Period_ID" class="java.lang.Integer"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["dev/"]]></defaultValueExpression>
	</parameter>
	<parameter name="AD_Org_ID" class="java.lang.Integer"/>
	<parameter name="C_DocType_ID" class="java.lang.Integer"/>
	<parameter name="GL_Category_ID" class="java.lang.Integer"/>
	<queryString language="SQL">
		<![CDATA[select	 case when stt=10 then   t.org_name else null end as header_org
,case when stt=10 then   t.sche_name else null end as header_sche
,case when stt=10 then concat('LNG.', to_char(t.ngay,'DDMMYY')) else null end  as header_sct
,case when stt=10 then concat('Chi phí tiền lương ', t.org_name, to_char(t.ngay,' MM/YYYY')) else null end as header_desc
, case when stt=10 then t.c_type else null end as header_type
, case when stt=10 then q.name else null end as header_gl
,case when stt=10 then to_char(t.ngay,'YYYY-MM-DD') else null end  as header_date
,case when stt=10 then to_char(t.ngay,'MM-YYYY') else null end as header_period
,z.org as detail_org, concat('LNG.', to_char(t.ngay,'DDMMYY'))  as detail_sct, stt  as detail_stt, concat('Chi phí ',z.cotluong,' - ',z.doitac_name)  as detail_desc ,doitac as detail_doitac,tk as detail_tk,hoatdong as detail_hoatdong,currency as detail_curencty,  round(tno,0) as detail_tno,  round(tco,0) as detail_tco
from ( 
	select 1 as id,cp.enddate as ngay, tye.name as c_type, org.name as org_name, sche.name  as sche_name from c_period cp,C_DocType tye,AD_Org org, C_AcctSchema sche
	where cp.ad_client_id = $P{AD_CLIENT_ID} and cp.c_period_id = $P{C_Period_ID} and  tye.c_doctype_id = $P{C_DocType_ID}
	and (org.ad_org_id = $P{AD_Org_ID} or $P{AD_Org_ID} is null) and org.ad_client_id = $P{AD_CLIENT_ID} and sche.ad_client_id = $P{AD_CLIENT_ID}
) as t 
join (select 1 as id, name from GL_Category where GL_Category_ID = $P{GL_Category_ID} and ad_client_id = $P{AD_CLIENT_ID}) as q on q.id = t.id
join (
select 1 as id,org ,row_number() over(order by id) * 10 as stt,mota,cotluong,doitac,doitac_name,tk,hoatdong,currency , sum(tno) as tno, sum(tco) as tco  
from(
select id,org,mota,cotluong,doitac,doitac_name,tk,hoatdong,currency ,  round(tno,0) as tno, round(tco,0) as tco  
from(

------
select k.id,t.org,'' as mota,t.cotluong,t.doitac,t.doitac_name,t.tk,t.hoatdong,t.currency ,  0 as "tno",
case  when t.hsv_cotluong = 'tru_bhxh' then  k.a10 else 
case when t.hsv_cotluong= 'tru_anca' then k.a11 else 
 k.a12 end  end as tco  
from( 
	select 1 as id, org.name as org, lb.hsv_cotluong, lb.name as cotluong,cb.value as doitac, cb.name as doitac_name, ce.value as tk,ac.value as hoatdong, cc.c_currency_id as currency
	from hsv_luongbep lb 
	join ad_client cl on cl.ad_client_id = lb.ad_client_id
	join ad_org org on org.ad_org_id = lb.ad_org_id 
	join c_bpartner cb on cb.c_bpartner_id = lb.c_bpartner_id  
	join c_elementvalue ce on ce.c_elementvalue_id = lb.account_id 
	join c_activity ac on ac.c_activity_id = lb.c_activity_id 
	join c_currency cc on cc.c_currency_id = lb.c_currency_id 
	where lb.ad_client_id = $P{AD_CLIENT_ID}  and hsv_cotluong in ('tru_bhxh','tru_anca','tru_congdoan')
) as t
join (
select 1 as id,sum(a10) as a10, sum(a11) as a11,sum(a12) as a12
from(
select  a0,cb.value as doitac,sum(coalesce(a2,0)) as a2,sum(coalesce(a3,0)) as a3,sum(coalesce(a4,0)) as a4,sum(coalesce(a5,0)) as a5,sum(coalesce(a6,0)) as a6,sum(coalesce(a7,0)) as a7,sum(coalesce(a8,0)) as a8,sum(coalesce(a9,0)) as a9,sum(coalesce(a10,0)) as a10,sum(coalesce(a11,0)) as a11,sum(coalesce(a12,0)) as a12,sum(coalesce(a13,0)) as a13 ,sum(((coalesce(a4,0)+coalesce(a5,0)+coalesce(a6,0)+coalesce(a7,0)+coalesce(a8,0))-(coalesce(a10,0) +coalesce(a11,0)+coalesce(a12,0)+coalesce(a13,0)))) as a14,sum(coalesce(a15,0)) as a15 
from( 
----begin 4---
select org.name as  org,t.hsv_toluong_id,tl.name as a0,tl.c_bpartner_id,nv.name as  a1,a2,a3,a4,a5,a6,a7,a8, a4+a5+a6+a7+a8 as a9,a10,a11,
case when a2 = 0 then 0 else  case when ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100>t.hsv_max_kpcd then t.hsv_max_kpcd else ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100 end end as a12,a13,a15
from(
---begin 3--
select t.ad_org_id,t.hsv_toluong_id,  a1, a2,  a3,   a4, case when  a2=0 then 0 else case when   (a3*a16)<a5 then (a3* a16) else a5 end end as a5,a6,a7,a8+ t.hsv_phucap + case when t.hsv_maxcong <> 0  and a2 >= congmax then  t.hsv_luongcd/t.hsv_maxcong*a15*congmax  else case when t.hsv_maxcong <> 0 then t.hsv_luongcd/t.hsv_maxcong*a15*a2 else  0 end end as a8 , a10 , 
	t.hsv_tlkpcd, t.hsv_max_kpcd, a11, a13, a15
from(
--BEGIN 2--
select k.ad_org_id,k.hsv_toluong_id,k.a1 as a1, hsv_ngaycong as a2,coalesce(hsv_luongbhxh,0) as a3,
case when tongcong <>0 then(hsv_ngaycong* hsv_hesoluong)* (tongluong/tongcong) else 0 end as a4,
case when hsv_htbhxh = 'Y' then  hsv_maxHTBHXH else 0 end as a5,
hsv_ngayanca*hsv_ht_anca as a6,
(hsv_ngaytangca2*hsv_muc_tc2+ hsv_ngaytangca3*hsv_muc_tc3+hsv_congdem* hsv_bddem) as a7,
hsv_luongspnv as a8,(coalesce(hsv_luongbhxh,0)*hsv_tlbhxh/100) as a10,
hsv_tlkpcd,hsv_max_kpcd,hsv_muc_anca*hsv_ngayanca+hsv_congdem*hsv_andem + hsv_ngaytangca2 * hsv_antangca2 + hsv_ngaytangca3*hsv_antangca3 as a11,hsv_ckluong as a13,hsv_hesoluong as a15,hsv_tlhtbhxh/100 as a16,case when hsv_ngaycong <> 0 then coalesce(t.hsv_phucap,0) else 0 end as hsv_phucap,coalesce(t.hsv_luongcd,0) as hsv_luongcd, coalesce(t.congmax,0) as congmax, coalesce(t.hsv_maxcong,0) as hsv_maxcong
from
(
--BEGIN 1---
	select k.ad_org_id,k.hsv_toluong_id,k.hsv_nhanvien_id as a1, coalesce(hsv_ngaycong,0) as hsv_ngaycong, coalesce(hsv_hesoluong,0) as hsv_hesoluong, coalesce(hsv_ngayanca,0) as hsv_ngayanca, coalesce(hsv_ngaytangca2,0) as hsv_ngaytangca2,
	coalesce(hsv_congdem,0) as hsv_congdem,coalesce(hsv_ckluong,0) as hsv_ckluong ,coalesce(hsv_ngaytangca3,0) as hsv_ngaytangca3 ,coalesce(hsv_luongspnv,0) as hsv_luongspnv ,coalesce(hsv_luongbhxh,0) as hsv_luongbhxh ,
	coalesce(hsv_maxHTBHXH,0) as hsv_maxHTBHXH,coalesce(hsv_ht_anca,0) as hsv_ht_anca,coalesce(hsv_muc_tc2,0) as hsv_muc_tc2,coalesce(hsv_muc_tc3,0) as hsv_muc_tc3,coalesce(hsv_bddem,0) as hsv_bddem,coalesce(hsv_tlbhxh,0) as hsv_tlbhxh,hsv_htbhxh , coalesce(hsv_tlkpcd,0) as hsv_tlkpcd,
	coalesce(hsv_max_kpcd,0) as hsv_max_kpcd,coalesce(hsv_muc_anca,0) as hsv_muc_anca,coalesce(hsv_tlhtbhxh,0) as hsv_tlhtbhxh, coalesce(tongcong,0) as tongcong,coalesce(tongluong,0) as tongluong,coalesce(hsv_andem,0) as hsv_andem,coalesce(hsv_antangca2,0) as hsv_antangca2,coalesce(hsv_antangca3,0) as hsv_antangca3 
	from(
		select b.ad_org_id,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_luongbhxh else 0 end as hsv_luongbhxh,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_htbhxh  end as hsv_htbhxh,b.hsv_toluong_id,b.hsv_nhanvien_id, b.hsv_ngaycong,
			b.hsv_hesoluong, b.hsv_ngayanca,b.hsv_ngaytangca2, b.hsv_congdem, b.hsv_ckluong,b.hsv_ngaytangca3,b.hsv_luongspnv
		from (							
				select  nv.hsv_nhanvien_id, MAX(nv.hsv_ngaycong) as ngaycongk,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh 						
				from hsv_nkluong nk
				join hsv_nkluongnv nv on nk.hsv_nkluong_id = nv.hsv_nkluong_id 
				join hsv_luongbhxhline bhxh on bhxh.hsv_nhanvien_id = nv.hsv_nhanvien_id and bhxh.hsv_luongbhxh >0 
				where  nk.ad_client_id = $P{AD_CLIENT_ID} and nk.c_period_id =  $P{C_Period_ID} 
					and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto	                                                                                                                                                                                                                                                                                                                          
					and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                         
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                      
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto					
				group by nv.hsv_nhanvien_id,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh											
			) as a
			right join (
				select  hsv_nkluongnv_id,0 as hsv_luongbhxh, nkl.ad_org_id,nkl.hsv_toluong_id,nklnv.hsv_nhanvien_id, hsv_ngaycong,nklnv.hsv_hesoluong, nklnv.hsv_ngayanca,
				nklnv.hsv_ngaytangca2, nklnv.hsv_congdem, nklnv.hsv_ckluong,nklnv.hsv_ngaytangca3,nklnv.hsv_luongspnv
				from hsv_NkluongNV nklnv
				join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 		  
				where  nkl.ad_client_id = $P{AD_CLIENT_ID} and nkl.c_period_id =  $P{C_Period_ID} and nklnv.isactive = 'Y' 								
		) as b on a.hsv_nhanvien_id =b.hsv_nhanvien_id and a.ngaycongk =  b.hsv_ngaycong 																
	) as k 
	left join ( --- che do luong----
		select tl.hsv_toluong_id ,hsv_maxHTBHXH,cdl.hsv_ht_anca,cdl.hsv_muc_tc2,cdl.hsv_muc_tc3,cdl.hsv_bddem,cdl.hsv_tlbhxh, cdl.hsv_tlkpcd,cdl.hsv_max_kpcd,cdl.hsv_muc_anca,cdl.hsv_andem,cdl.hsv_antangca2,cdl.hsv_antangca3 	
		,cdl.hsv_tlhtbhxh 
		from hsv_chedo cd 		
		left join hsv_cd_luong cdl on cd.hsv_chedo_id = cdl.hsv_chedo_id and cdl.isactive = 'Y'
		left join hsv_toluong tl on tl.hsv_chedo_id = cd.hsv_chedo_id and tl.isactive = 'Y'
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= cdl.dateto	                                                                                                                                                                                                                                                                                                                              
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=cdl.datefrom                                                                                                                                                                                                                                                                                                                            
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= cdl.datefrom                                                                                                                                                                                                                                                                                                                         
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=cdl.dateto                                                                                                                                                                                                                             		
		and cd.isactive = 'Y'
	)as w on w.hsv_toluong_id = k.hsv_toluong_id 
	left join ( --- tong luong ---
		select nkl.hsv_toluong_id,sum(nklsp.amount) as tongluong 
		from hsv_nkluongsp nklsp
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklsp.hsv_nkluong_id 			
		where nkl.c_period_id = $P{C_Period_ID} and nklsp.isactive = 'Y' and nkl.isactive = 'Y'
		group by nkl.hsv_toluong_id
	) as h on k.hsv_toluong_id = h.hsv_toluong_id 
	left join( ---- tong cong--- 
		select nkl.hsv_toluong_id, sum(nklnv.hsv_ngaycong* nklnv.hsv_hesoluong) as tongcong 
		from hsv_nkluongnv nklnv
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 
		where nkl.c_period_id = $P{C_Period_ID} and nklnv.isactive = 'Y' and nkl.isactive = 'Y'		
		group by nkl.hsv_toluong_id 
	) as z on k.hsv_toluong_id = z.hsv_toluong_id	
	---END 1--
	) as k 
	left join (		
		select lc.hsv_toluong_id, lc.hsv_nhanvien_id as a1,  coalesce(hsv_phucap,0) as hsv_phucap, coalesce(hsv_luongcd,0) as hsv_luongcd,coalesce(congmax,0) as congmax,coalesce(hsv_maxcong,0) as hsv_maxcong 
		from hsv_luongcung lc		  
			where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= lc.dateto	                                                                                                                                                                                                                                                                                                                          
				and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=lc.datefrom                                                                                                                                                                                                                                                                                                                         
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= lc.datefrom                                                                                                                                                                                                                                                                                                                      
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=lc.dateto                                                                                                                                                                                                                                                                                                                         
				and lc.ad_client_id =$P{AD_CLIENT_ID}  and lc.isactive = 'Y'				
		  
	) as t on k.hsv_toluong_id=t.hsv_toluong_id  and k.a1 =t.a1
	---end begin 2--
	) as t
	) as t 
		join hsv_toluong tl on t.hsv_toluong_id = tl.hsv_toluong_id
		join hsv_nhanvien nv on t.a1 = nv.hsv_nhanvien_id  
		join ad_org org on t.ad_org_id = org.ad_org_id 
		where (t.ad_org_id =$P{AD_Org_ID} or $P{AD_Org_ID} is null)		
		and nv.ad_client_id = $P{AD_CLIENT_ID}
	---end begin 3-----
) as z join c_bpartner cb on cb.c_bpartner_id = z.c_bpartner_id 
where a9<>0
group by a0,org, value
) as k
) as k on k.id =t.id 

union all

select  k.id,k.org,k.a0 as mota,t.cotluong,k.doitac,k.doitac_name,t.tk,t.hoatdong,t.currency ,  0 as "tno",k.a14 as tco
from( 
	select 2 as id, lb.hsv_cotluong, lb.name as cotluong,cb.value as doitac,cb.name as doitac_name, ce.value as tk,ac.value as hoatdong, cc.c_currency_id as currency
	from hsv_luongbep lb 
	join ad_client cl on cl.ad_client_id = lb.ad_client_id
	join c_bpartner cb on cb.c_bpartner_id = lb.c_bpartner_id  
	join c_elementvalue ce on ce.c_elementvalue_id = lb.account_id 
	join c_activity ac on ac.c_activity_id = lb.c_activity_id 
	join c_currency cc on cc.c_currency_id = lb.c_currency_id 
	where lb.ad_client_id = $P{AD_CLIENT_ID}  and hsv_cotluong in ('luong_conlai')
) as t
join (
select 2 as id,org,a0,doitac, doitac_name, a13+a14 as a14
from(
select  org,a0,cb.value as doitac,cb.name as doitac_name,sum(coalesce(a2,0)) as a2,sum(coalesce(a3,0)) as a3,sum(coalesce(a4,0)) as a4,sum(coalesce(a5,0)) as a5,sum(coalesce(a6,0)) as a6,sum(coalesce(a7,0)) as a7,sum(coalesce(a8,0)) as a8,sum(coalesce(a9,0)) as a9,sum(coalesce(a10,0)) as a10,sum(coalesce(a11,0)) as a11,sum(coalesce(a12,0)) as a12,sum(coalesce(a13,0)) as a13 ,sum(((coalesce(a4,0)+coalesce(a5,0)+coalesce(a6,0)+coalesce(a7,0)+coalesce(a8,0))-(coalesce(a10,0) +coalesce(a11,0)+coalesce(a12,0)+coalesce(a13,0)))) as a14,sum(coalesce(a15,0)) as a15 
from( 
----begin 4---
select org.name as  org,t.hsv_toluong_id,tl.name as a0,tl.c_bpartner_id,nv.name as  a1,a2,a3,a4,a5,a6,a7,a8, a4+a5+a6+a7+a8 as a9,a10,a11,
case when a2 = 0 then 0 else  case when ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100>t.hsv_max_kpcd then t.hsv_max_kpcd else ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100 end end as a12,a13,a15
from(
---begin 3--
select t.ad_org_id,t.hsv_toluong_id,  a1, a2,  a3,   a4, case when  a2=0 then 0 else case when   (a3*a16)<a5 then (a3* a16) else a5 end end as a5,a6,a7,a8+t.hsv_phucap + case when t.hsv_maxcong <> 0  and a2 >= congmax then  t.hsv_luongcd/t.hsv_maxcong*a15*congmax  else case when t.hsv_maxcong <> 0 then t.hsv_luongcd/t.hsv_maxcong*a15*a2 else  0 end end as a8 , a10 , 
	t.hsv_tlkpcd, t.hsv_max_kpcd, a11, a13, a15
from(
--BEGIN 2--
select k.ad_org_id,k.hsv_toluong_id,k.a1 as a1, hsv_ngaycong as a2,coalesce(hsv_luongbhxh,0) as a3,
case when tongcong <>0 then(hsv_ngaycong* hsv_hesoluong)* (tongluong/tongcong) else 0 end as a4,
case when hsv_htbhxh = 'Y' then  hsv_maxHTBHXH else 0 end as a5,
hsv_ngayanca*hsv_ht_anca as a6,
(hsv_ngaytangca2*hsv_muc_tc2+ hsv_ngaytangca3*hsv_muc_tc3+hsv_congdem* hsv_bddem) as a7,
hsv_luongspnv as a8,(coalesce(hsv_luongbhxh,0)*hsv_tlbhxh/100) as a10,
hsv_tlkpcd,hsv_max_kpcd,hsv_muc_anca*hsv_ngayanca+hsv_congdem*hsv_andem + hsv_ngaytangca2 * hsv_antangca2 + hsv_ngaytangca3*hsv_antangca3 as a11,hsv_ckluong as a13,hsv_hesoluong as a15,hsv_tlhtbhxh/100 as a16,case when hsv_ngaycong <> 0 then coalesce(t.hsv_phucap,0) else 0 end as hsv_phucap,coalesce(t.hsv_luongcd,0) as hsv_luongcd, coalesce(t.congmax,0) as congmax, coalesce(t.hsv_maxcong,0) as hsv_maxcong
from
(
--BEGIN 1---
	select k.ad_org_id,k.hsv_toluong_id,k.hsv_nhanvien_id as a1, coalesce(hsv_ngaycong,0) as hsv_ngaycong, coalesce(hsv_hesoluong,0) as hsv_hesoluong, coalesce(hsv_ngayanca,0) as hsv_ngayanca, coalesce(hsv_ngaytangca2,0) as hsv_ngaytangca2,
	coalesce(hsv_congdem,0) as hsv_congdem,coalesce(hsv_ckluong,0) as hsv_ckluong ,coalesce(hsv_ngaytangca3,0) as hsv_ngaytangca3 ,coalesce(hsv_luongspnv,0) as hsv_luongspnv ,coalesce(hsv_luongbhxh,0) as hsv_luongbhxh ,
	coalesce(hsv_maxHTBHXH,0) as hsv_maxHTBHXH,coalesce(hsv_ht_anca,0) as hsv_ht_anca,coalesce(hsv_muc_tc2,0) as hsv_muc_tc2,coalesce(hsv_muc_tc3,0) as hsv_muc_tc3,coalesce(hsv_bddem,0) as hsv_bddem,coalesce(hsv_tlbhxh,0) as hsv_tlbhxh,hsv_htbhxh , coalesce(hsv_tlkpcd,0) as hsv_tlkpcd,
	coalesce(hsv_max_kpcd,0) as hsv_max_kpcd,coalesce(hsv_muc_anca,0) as hsv_muc_anca,coalesce(hsv_tlhtbhxh,0) as hsv_tlhtbhxh, coalesce(tongcong,0) as tongcong,coalesce(tongluong,0) as tongluong,coalesce(hsv_andem,0) as hsv_andem,coalesce(hsv_antangca2,0) as hsv_antangca2,coalesce(hsv_antangca3,0) as hsv_antangca3 
	from(
		select b.ad_org_id,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_luongbhxh else 0 end as hsv_luongbhxh,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_htbhxh  end as hsv_htbhxh,b.hsv_toluong_id,b.hsv_nhanvien_id, b.hsv_ngaycong,
			b.hsv_hesoluong, b.hsv_ngayanca,b.hsv_ngaytangca2, b.hsv_congdem, b.hsv_ckluong,b.hsv_ngaytangca3,b.hsv_luongspnv
		from (							
				select  nv.hsv_nhanvien_id, MAX(nv.hsv_ngaycong) as ngaycongk,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh 						
				from hsv_nkluong nk
				join hsv_nkluongnv nv on nk.hsv_nkluong_id = nv.hsv_nkluong_id 
				join hsv_luongbhxhline bhxh on bhxh.hsv_nhanvien_id = nv.hsv_nhanvien_id and bhxh.hsv_luongbhxh >0 
				where  nk.ad_client_id = $P{AD_CLIENT_ID} and nk.c_period_id =  $P{C_Period_ID} 
					and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto	                                                                                                                                                                                                                                                                                                                          
					and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                         
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                      
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto					
				group by nv.hsv_nhanvien_id,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh											
			) as a
			right join (
				select  hsv_nkluongnv_id,0 as hsv_luongbhxh, nkl.ad_org_id,nkl.hsv_toluong_id,nklnv.hsv_nhanvien_id, hsv_ngaycong,nklnv.hsv_hesoluong, nklnv.hsv_ngayanca,
				nklnv.hsv_ngaytangca2, nklnv.hsv_congdem, nklnv.hsv_ckluong,nklnv.hsv_ngaytangca3,nklnv.hsv_luongspnv
				from hsv_NkluongNV nklnv
				join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 		  
				where  nkl.ad_client_id = $P{AD_CLIENT_ID} and nkl.c_period_id =  $P{C_Period_ID} and nklnv.isactive = 'Y' 								
		) as b on a.hsv_nhanvien_id =b.hsv_nhanvien_id and a.ngaycongk =  b.hsv_ngaycong 																
	) as k 
	left join ( --- che do luong----
		select tl.hsv_toluong_id ,hsv_maxHTBHXH,cdl.hsv_ht_anca,cdl.hsv_muc_tc2,cdl.hsv_muc_tc3,cdl.hsv_bddem,cdl.hsv_tlbhxh, cdl.hsv_tlkpcd,cdl.hsv_max_kpcd,cdl.hsv_muc_anca,cdl.hsv_andem,cdl.hsv_antangca2,cdl.hsv_antangca3 	
		,cdl.hsv_tlhtbhxh 
		from hsv_chedo cd 		
		left join hsv_cd_luong cdl on cd.hsv_chedo_id = cdl.hsv_chedo_id and cdl.isactive = 'Y'
		left join hsv_toluong tl on tl.hsv_chedo_id = cd.hsv_chedo_id and tl.isactive = 'Y'
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= cdl.dateto	                                                                                                                                                                                                                                                                                                                              
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=cdl.datefrom                                                                                                                                                                                                                                                                                                                            
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= cdl.datefrom                                                                                                                                                                                                                                                                                                                         
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=cdl.dateto                                                                                                                                                                                                                             		
		and cd.isactive = 'Y'
	)as w on w.hsv_toluong_id = k.hsv_toluong_id 
	left join ( --- tong luong ---
		select nkl.hsv_toluong_id,sum(nklsp.amount) as tongluong 
		from hsv_nkluongsp nklsp
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklsp.hsv_nkluong_id 			
		where nkl.c_period_id = $P{C_Period_ID} and nklsp.isactive = 'Y' and nkl.isactive = 'Y'
		group by nkl.hsv_toluong_id
	) as h on k.hsv_toluong_id = h.hsv_toluong_id 
	left join( ---- tong cong--- 
		select nkl.hsv_toluong_id, sum(nklnv.hsv_ngaycong* nklnv.hsv_hesoluong) as tongcong 
		from hsv_nkluongnv nklnv
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 
		where nkl.c_period_id = $P{C_Period_ID} and nklnv.isactive = 'Y' and nkl.isactive = 'Y'		
		group by nkl.hsv_toluong_id 
	) as z on k.hsv_toluong_id = z.hsv_toluong_id	
	---END 1--
	) as k 
	left join (		
		select lc.hsv_toluong_id, lc.hsv_nhanvien_id as a1,  coalesce(hsv_phucap,0) as hsv_phucap, coalesce(hsv_luongcd,0) as hsv_luongcd,coalesce(congmax,0) as congmax,coalesce(hsv_maxcong,0) as hsv_maxcong 
		from hsv_luongcung lc		  
			where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= lc.dateto	                                                                                                                                                                                                                                                                                                                          
				and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=lc.datefrom                                                                                                                                                                                                                                                                                                                         
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= lc.datefrom                                                                                                                                                                                                                                                                                                                      
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=lc.dateto                                                                                                                                                                                                                                                                                                                         
				and lc.ad_client_id =$P{AD_CLIENT_ID}  and lc.isactive = 'Y'				
		  
	) as t on k.hsv_toluong_id=t.hsv_toluong_id  and k.a1 =t.a1
	---end begin 2--
	) as t
	) as t 
		join hsv_toluong tl on t.hsv_toluong_id = tl.hsv_toluong_id
		join hsv_nhanvien nv on t.a1 = nv.hsv_nhanvien_id  
		join ad_org org on t.ad_org_id = org.ad_org_id 
		where (t.ad_org_id =$P{AD_Org_ID} or $P{AD_Org_ID} is null)		
		and nv.ad_client_id = $P{AD_CLIENT_ID}
	---end begin 3-----
) as z join c_bpartner cb on cb.c_bpartner_id = z.c_bpartner_id 
where a9<>0
group by a0,org, value,cb.name
) as k
) as k on k.id =t.id 



union all

select  k.id,k.org,k.a0 as mota,t.cotluong,k.doitac,k.doitac_name, k.tk,k.hoatdong,t.currency , k.a8 as tno, 0 as tco  
from( 
	select 3 as id, lb.hsv_cotluong, lb.name as cotluong,cb.value as doitac,cb.name as doitac_name, ce.value as tk,ac.value as hoatdong, cc.c_currency_id as currency
	from hsv_luongbep lb 
	join ad_client cl on cl.ad_client_id = lb.ad_client_id
	
	join c_bpartner cb on cb.c_bpartner_id = lb.c_bpartner_id  
	join c_elementvalue ce on ce.c_elementvalue_id = lb.account_id 
	join c_activity ac on ac.c_activity_id = lb.c_activity_id 
	join c_currency cc on cc.c_currency_id = lb.c_currency_id 
	where lb.ad_client_id = $P{AD_CLIENT_ID}  and hsv_cotluong in ('luong')
) as t
join (
select 3 as id,org,a0,doitac, doitac_name,hoatdong,value as tk, a4+a8 as a8 
from(
select org, a0,cb.value as doitac,cb.name as doitac_name,ac.value as hoatdong,ev.value,sum(coalesce(a2,0)) as a2,sum(coalesce(a3,0)) as a3,sum(coalesce(a4,0)) as a4,sum(coalesce(a5,0)) as a5,sum(coalesce(a6,0)) as a6,sum(coalesce(a7,0)) as a7,sum(coalesce(a8,0)) as a8,sum(coalesce(a9,0)) as a9,sum(coalesce(a10,0)) as a10,sum(coalesce(a11,0)) as a11,sum(coalesce(a12,0)) as a12,sum(coalesce(a13,0)) as a13 ,sum(((coalesce(a4,0)+coalesce(a5,0)+coalesce(a6,0)+coalesce(a7,0)+coalesce(a8,0))-(coalesce(a10,0) +coalesce(a11,0)+coalesce(a12,0)+coalesce(a13,0)))) as a14,sum(coalesce(a15,0)) as a15 
from( 
----begin 4---
select org.name as  org,t.hsv_toluong_id,tl.name as a0,tl.c_activity_id, tl.account_id, tl.c_bpartner_id,nv.name as  a1,a2,a3,a4,a5,a6,a7,a8, a4+a5+a6+a7+a8 as a9,a10,a11,
case when a2 = 0 then 0 else  case when ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100>t.hsv_max_kpcd then t.hsv_max_kpcd else ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100 end end as a12,a13,a15
from(
---begin 3--
select t.ad_org_id,t.hsv_toluong_id,  a1, a2,  a3,   a4, case when  a2=0 then 0 else case when   (a3*a16)<a5 then (a3* a16) else a5 end end as a5,a6,a7,a8+t.hsv_phucap + case when t.hsv_maxcong <> 0  and a2 >= congmax then  t.hsv_luongcd/t.hsv_maxcong*a15*congmax  else case when t.hsv_maxcong <> 0 then t.hsv_luongcd/t.hsv_maxcong*a15*a2 else  0 end end as a8 , a10 , 
	t.hsv_tlkpcd, t.hsv_max_kpcd, a11, a13, a15
from(
--BEGIN 2--
select k.ad_org_id,k.hsv_toluong_id,k.a1 as a1, hsv_ngaycong as a2,coalesce(hsv_luongbhxh,0) as a3,
case when tongcong <>0 then(hsv_ngaycong* hsv_hesoluong)* (tongluong/tongcong) else 0 end as a4,
case when hsv_htbhxh = 'Y' then  hsv_maxHTBHXH else 0 end as a5,
hsv_ngayanca*hsv_ht_anca as a6,
(hsv_ngaytangca2*hsv_muc_tc2+ hsv_ngaytangca3*hsv_muc_tc3+hsv_congdem* hsv_bddem) as a7,
hsv_luongspnv as a8,(coalesce(hsv_luongbhxh,0)*hsv_tlbhxh/100) as a10,
hsv_tlkpcd,hsv_max_kpcd,hsv_muc_anca*hsv_ngayanca+hsv_congdem*hsv_andem + hsv_ngaytangca2 * hsv_antangca2 + hsv_ngaytangca3*hsv_antangca3 as a11,hsv_ckluong as a13,hsv_hesoluong as a15,hsv_tlhtbhxh/100 as a16,case when hsv_ngaycong <> 0 then coalesce(t.hsv_phucap,0) else 0 end as hsv_phucap,coalesce(t.hsv_luongcd,0) as hsv_luongcd, coalesce(t.congmax,0) as congmax, coalesce(t.hsv_maxcong,0) as hsv_maxcong
from
(
--BEGIN 1---
	select k.ad_org_id,k.hsv_toluong_id,k.hsv_nhanvien_id as a1, coalesce(hsv_ngaycong,0) as hsv_ngaycong, coalesce(hsv_hesoluong,0) as hsv_hesoluong, coalesce(hsv_ngayanca,0) as hsv_ngayanca, coalesce(hsv_ngaytangca2,0) as hsv_ngaytangca2,
	coalesce(hsv_congdem,0) as hsv_congdem,coalesce(hsv_ckluong,0) as hsv_ckluong ,coalesce(hsv_ngaytangca3,0) as hsv_ngaytangca3 ,coalesce(hsv_luongspnv,0) as hsv_luongspnv ,coalesce(hsv_luongbhxh,0) as hsv_luongbhxh ,
	coalesce(hsv_maxHTBHXH,0) as hsv_maxHTBHXH,coalesce(hsv_ht_anca,0) as hsv_ht_anca,coalesce(hsv_muc_tc2,0) as hsv_muc_tc2,coalesce(hsv_muc_tc3,0) as hsv_muc_tc3,coalesce(hsv_bddem,0) as hsv_bddem,coalesce(hsv_tlbhxh,0) as hsv_tlbhxh,hsv_htbhxh , coalesce(hsv_tlkpcd,0) as hsv_tlkpcd,
	coalesce(hsv_max_kpcd,0) as hsv_max_kpcd,coalesce(hsv_muc_anca,0) as hsv_muc_anca,coalesce(hsv_tlhtbhxh,0) as hsv_tlhtbhxh, coalesce(tongcong,0) as tongcong,coalesce(tongluong,0) as tongluong,coalesce(hsv_andem,0) as hsv_andem,coalesce(hsv_antangca2,0) as hsv_antangca2,coalesce(hsv_antangca3,0) as hsv_antangca3 
	from(
		select b.ad_org_id,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_luongbhxh else 0 end as hsv_luongbhxh,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_htbhxh  end as hsv_htbhxh,b.hsv_toluong_id,b.hsv_nhanvien_id, b.hsv_ngaycong,
			b.hsv_hesoluong, b.hsv_ngayanca,b.hsv_ngaytangca2, b.hsv_congdem, b.hsv_ckluong,b.hsv_ngaytangca3,b.hsv_luongspnv
		from (							
				select  nv.hsv_nhanvien_id, MAX(nv.hsv_ngaycong) as ngaycongk,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh 						
				from hsv_nkluong nk
				join hsv_nkluongnv nv on nk.hsv_nkluong_id = nv.hsv_nkluong_id 
				join hsv_luongbhxhline bhxh on bhxh.hsv_nhanvien_id = nv.hsv_nhanvien_id and bhxh.hsv_luongbhxh >0 
				where  nk.ad_client_id = $P{AD_CLIENT_ID} and nk.c_period_id =  $P{C_Period_ID} 
					and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto	                                                                                                                                                                                                                                                                                                                          
					and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                         
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                      
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto					
				group by nv.hsv_nhanvien_id,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh											
			) as a
			right join (
				select  hsv_nkluongnv_id,0 as hsv_luongbhxh, nkl.ad_org_id,nkl.hsv_toluong_id,nklnv.hsv_nhanvien_id, hsv_ngaycong,nklnv.hsv_hesoluong, nklnv.hsv_ngayanca,
				nklnv.hsv_ngaytangca2, nklnv.hsv_congdem, nklnv.hsv_ckluong,nklnv.hsv_ngaytangca3,nklnv.hsv_luongspnv
				from hsv_NkluongNV nklnv
				join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 		  
				where  nkl.ad_client_id = $P{AD_CLIENT_ID} and nkl.c_period_id =  $P{C_Period_ID} and nklnv.isactive = 'Y' 								
		) as b on a.hsv_nhanvien_id =b.hsv_nhanvien_id and a.ngaycongk =  b.hsv_ngaycong 																
	) as k 
	left join ( --- che do luong----
		select tl.hsv_toluong_id ,hsv_maxHTBHXH,cdl.hsv_ht_anca,cdl.hsv_muc_tc2,cdl.hsv_muc_tc3,cdl.hsv_bddem,cdl.hsv_tlbhxh, cdl.hsv_tlkpcd,cdl.hsv_max_kpcd,cdl.hsv_muc_anca,cdl.hsv_andem,cdl.hsv_antangca2,cdl.hsv_antangca3 	
		,cdl.hsv_tlhtbhxh 
		from hsv_chedo cd 		
		left join hsv_cd_luong cdl on cd.hsv_chedo_id = cdl.hsv_chedo_id and cdl.isactive = 'Y'
		left join hsv_toluong tl on tl.hsv_chedo_id = cd.hsv_chedo_id and tl.isactive = 'Y'
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= cdl.dateto	                                                                                                                                                                                                                                                                                                                              
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=cdl.datefrom                                                                                                                                                                                                                                                                                                                            
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= cdl.datefrom                                                                                                                                                                                                                                                                                                                         
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=cdl.dateto                                                                                                                                                                                                                             		
		and cd.isactive = 'Y'
	)as w on w.hsv_toluong_id = k.hsv_toluong_id 
	left join ( --- tong luong ---
		select nkl.hsv_toluong_id,sum(nklsp.amount) as tongluong 
		from hsv_nkluongsp nklsp
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklsp.hsv_nkluong_id 			
		where nkl.c_period_id = $P{C_Period_ID} and nklsp.isactive = 'Y' and nkl.isactive = 'Y'
		group by nkl.hsv_toluong_id
	) as h on k.hsv_toluong_id = h.hsv_toluong_id 
	left join( ---- tong cong--- 
		select nkl.hsv_toluong_id, sum(nklnv.hsv_ngaycong* nklnv.hsv_hesoluong) as tongcong 
		from hsv_nkluongnv nklnv
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 
		where nkl.c_period_id = $P{C_Period_ID} and nklnv.isactive = 'Y' and nkl.isactive = 'Y'		
		group by nkl.hsv_toluong_id 
	) as z on k.hsv_toluong_id = z.hsv_toluong_id	
	---END 1--
	) as k 
	left join (		
		select lc.hsv_toluong_id, lc.hsv_nhanvien_id as a1,  coalesce(hsv_phucap,0) as hsv_phucap, coalesce(hsv_luongcd,0) as hsv_luongcd,coalesce(congmax,0) as congmax,coalesce(hsv_maxcong,0) as hsv_maxcong 
		from hsv_luongcung lc		  
			where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= lc.dateto	                                                                                                                                                                                                                                                                                                                          
				and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=lc.datefrom                                                                                                                                                                                                                                                                                                                         
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= lc.datefrom                                                                                                                                                                                                                                                                                                                      
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=lc.dateto                                                                                                                                                                                                                                                                                                                         
				and lc.ad_client_id =$P{AD_CLIENT_ID}  and lc.isactive = 'Y'				
		  
	) as t on k.hsv_toluong_id=t.hsv_toluong_id  and k.a1 =t.a1
	---end begin 2--
	) as t
	) as t 
		join hsv_toluong tl on t.hsv_toluong_id = tl.hsv_toluong_id
		join hsv_nhanvien nv on t.a1 = nv.hsv_nhanvien_id  
		join ad_org org on t.ad_org_id = org.ad_org_id 
		where (t.ad_org_id =$P{AD_Org_ID} or $P{AD_Org_ID} is null)		
		and nv.ad_client_id = $P{AD_CLIENT_ID}
	---end begin 3-----
) as z join c_bpartner cb on cb.c_bpartner_id = z.c_bpartner_id 
	join c_activity ac on ac.c_activity_id = z.c_activity_id
	join c_elementvalue ev on ev.c_elementvalue_id = z.account_id
where a9<>0
group by a0,org, cb.value,ev.value,ev.name,ac.value,cb.name
) as k
) as k on k.id =t.id 
union all 


select  k.id,k.org,'' as mota,t.cotluong,t.doitac, t.doitac_name,t.tk,k.hoatdong,t.currency , 
case when hsv_cotluong = 'ht_bhxh' then k.a5 else k.a7 end as tno 
, 0 as tco  
from( 
	select 4 as id, lb.hsv_cotluong, lb.name as cotluong,cb.value as doitac,cb.name as doitac_name, ce.value as tk,ac.value as hoatdong, cc.c_currency_id as currency
	from hsv_luongbep lb 
	join ad_client cl on cl.ad_client_id = lb.ad_client_id	
	join c_bpartner cb on cb.c_bpartner_id = lb.c_bpartner_id  
	join c_elementvalue ce on ce.c_elementvalue_id = lb.account_id 
	join c_activity ac on ac.c_activity_id = lb.c_activity_id 
	join c_currency cc on cc.c_currency_id = lb.c_currency_id 
	where lb.ad_client_id = $P{AD_CLIENT_ID}  and hsv_cotluong in ('ht_bhxh','ht_anca')
) as t
join (
select 4 as id,org,hoatdong, sum(a5) as a5,sum((a6+a7)) as a7
from(
select org,ac.value as hoatdong, sum(coalesce(a2,0)) as a2,sum(coalesce(a3,0)) as a3,sum(coalesce(a4,0)) as a4,sum(coalesce(a5,0)) as a5,sum(coalesce(a6,0)) as a6,sum(coalesce(a7,0)) as a7,sum(coalesce(a8,0)) as a8,sum(coalesce(a9,0)) as a9,sum(coalesce(a10,0)) as a10,sum(coalesce(a11,0)) as a11,sum(coalesce(a12,0)) as a12,sum(coalesce(a13,0)) as a13 ,sum(((coalesce(a4,0)+coalesce(a5,0)+coalesce(a6,0)+coalesce(a7,0)+coalesce(a8,0))-(coalesce(a10,0) +coalesce(a11,0)+coalesce(a12,0)+coalesce(a13,0)))) as a14,sum(coalesce(a15,0)) as a15 
from( 
----begin 4---
select org.name as  org,t.hsv_toluong_id,tl.name as a0,tl.c_activity_id, tl.account_id, tl.c_bpartner_id,nv.name as  a1,a2,a3,a4,a5,a6,a7,a8, a4+a5+a6+a7+a8 as a9,a10,a11,
case when a2 = 0 then 0 else  case when ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100>t.hsv_max_kpcd then t.hsv_max_kpcd else ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100 end end as a12,a13,a15
from(
---begin 3--
select t.ad_org_id,t.hsv_toluong_id,  a1, a2,  a3,   a4, case when  a2=0 then 0 else case when   (a3*a16)<a5 then (a3* a16) else a5 end end as a5,a6,a7,a8+t.hsv_phucap + case when t.hsv_maxcong <> 0  and a2 >= congmax then  t.hsv_luongcd/t.hsv_maxcong*a15*congmax  else case when t.hsv_maxcong <> 0 then t.hsv_luongcd/t.hsv_maxcong*a15*a2 else  0 end end as a8 , a10 , 
	t.hsv_tlkpcd, t.hsv_max_kpcd, a11, a13, a15
from(
--BEGIN 2--
select k.ad_org_id,k.hsv_toluong_id,k.a1 as a1, hsv_ngaycong as a2,coalesce(hsv_luongbhxh,0) as a3,
case when tongcong <>0 then(hsv_ngaycong* hsv_hesoluong)* (tongluong/tongcong) else 0 end as a4,
case when hsv_htbhxh = 'Y' then  hsv_maxHTBHXH else 0 end as a5,
hsv_ngayanca*hsv_ht_anca as a6,
(hsv_ngaytangca2*hsv_muc_tc2+ hsv_ngaytangca3*hsv_muc_tc3+hsv_congdem* hsv_bddem) as a7,
hsv_luongspnv as a8,(coalesce(hsv_luongbhxh,0)*hsv_tlbhxh/100) as a10,
hsv_tlkpcd,hsv_max_kpcd,hsv_muc_anca*hsv_ngayanca+hsv_congdem*hsv_andem + hsv_ngaytangca2 * hsv_antangca2 + hsv_ngaytangca3*hsv_antangca3 as a11,hsv_ckluong as a13,hsv_hesoluong as a15,hsv_tlhtbhxh/100 as a16,case when hsv_ngaycong  <>0 then coalesce(t.hsv_phucap,0) else 0 end as hsv_phucap,coalesce(t.hsv_luongcd,0) as hsv_luongcd, coalesce(t.congmax,0) as congmax, coalesce(t.hsv_maxcong,0) as hsv_maxcong
from
(
--BEGIN 1---
	select k.ad_org_id,k.hsv_toluong_id,k.hsv_nhanvien_id as a1, coalesce(hsv_ngaycong,0) as hsv_ngaycong, coalesce(hsv_hesoluong,0) as hsv_hesoluong, coalesce(hsv_ngayanca,0) as hsv_ngayanca, coalesce(hsv_ngaytangca2,0) as hsv_ngaytangca2,
	coalesce(hsv_congdem,0) as hsv_congdem,coalesce(hsv_ckluong,0) as hsv_ckluong ,coalesce(hsv_ngaytangca3,0) as hsv_ngaytangca3 ,coalesce(hsv_luongspnv,0) as hsv_luongspnv ,coalesce(hsv_luongbhxh,0) as hsv_luongbhxh ,
	coalesce(hsv_maxHTBHXH,0) as hsv_maxHTBHXH,coalesce(hsv_ht_anca,0) as hsv_ht_anca,coalesce(hsv_muc_tc2,0) as hsv_muc_tc2,coalesce(hsv_muc_tc3,0) as hsv_muc_tc3,coalesce(hsv_bddem,0) as hsv_bddem,coalesce(hsv_tlbhxh,0) as hsv_tlbhxh,hsv_htbhxh , coalesce(hsv_tlkpcd,0) as hsv_tlkpcd,
	coalesce(hsv_max_kpcd,0) as hsv_max_kpcd,coalesce(hsv_muc_anca,0) as hsv_muc_anca,coalesce(hsv_tlhtbhxh,0) as hsv_tlhtbhxh, coalesce(tongcong,0) as tongcong,coalesce(tongluong,0) as tongluong,coalesce(hsv_andem,0) as hsv_andem,coalesce(hsv_antangca2,0) as hsv_antangca2,coalesce(hsv_antangca3,0) as hsv_antangca3 
	from(
		select b.ad_org_id,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_luongbhxh else 0 end as hsv_luongbhxh,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_htbhxh  end as hsv_htbhxh,b.hsv_toluong_id,b.hsv_nhanvien_id, b.hsv_ngaycong,
			b.hsv_hesoluong, b.hsv_ngayanca,b.hsv_ngaytangca2, b.hsv_congdem, b.hsv_ckluong,b.hsv_ngaytangca3,b.hsv_luongspnv
		from (							
				select  nv.hsv_nhanvien_id, MAX(nv.hsv_ngaycong) as ngaycongk,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh 						
				from hsv_nkluong nk
				join hsv_nkluongnv nv on nk.hsv_nkluong_id = nv.hsv_nkluong_id 
				join hsv_luongbhxhline bhxh on bhxh.hsv_nhanvien_id = nv.hsv_nhanvien_id and bhxh.hsv_luongbhxh >0 
				where  nk.ad_client_id = $P{AD_CLIENT_ID} and nk.c_period_id =  $P{C_Period_ID} 
					and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto	                                                                                                                                                                                                                                                                                                                          
					and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                         
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                      
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto					
				group by nv.hsv_nhanvien_id,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh											
			) as a
			right join (
				select  hsv_nkluongnv_id,0 as hsv_luongbhxh, nkl.ad_org_id,nkl.hsv_toluong_id,nklnv.hsv_nhanvien_id, hsv_ngaycong,nklnv.hsv_hesoluong, nklnv.hsv_ngayanca,
				nklnv.hsv_ngaytangca2, nklnv.hsv_congdem, nklnv.hsv_ckluong,nklnv.hsv_ngaytangca3,nklnv.hsv_luongspnv
				from hsv_NkluongNV nklnv
				join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 		  
				where  nkl.ad_client_id = $P{AD_CLIENT_ID} and nkl.c_period_id =  $P{C_Period_ID} and nklnv.isactive = 'Y' 								
		) as b on a.hsv_nhanvien_id =b.hsv_nhanvien_id and a.ngaycongk =  b.hsv_ngaycong 																
	) as k 	
	left join ( --- che do luong----
		select tl.hsv_toluong_id ,hsv_maxHTBHXH,cdl.hsv_ht_anca,cdl.hsv_muc_tc2,cdl.hsv_muc_tc3,cdl.hsv_bddem,cdl.hsv_tlbhxh, cdl.hsv_tlkpcd,cdl.hsv_max_kpcd,cdl.hsv_muc_anca,cdl.hsv_andem,cdl.hsv_antangca2,cdl.hsv_antangca3 	
		,cdl.hsv_tlhtbhxh 
		from hsv_chedo cd 		
		left join hsv_cd_luong cdl on cd.hsv_chedo_id = cdl.hsv_chedo_id and cdl.isactive = 'Y'
		left join hsv_toluong tl on tl.hsv_chedo_id = cd.hsv_chedo_id and tl.isactive = 'Y'
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= cdl.dateto	                                                                                                                                                                                                                                                                                                                              
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=cdl.datefrom                                                                                                                                                                                                                                                                                                                            
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= cdl.datefrom                                                                                                                                                                                                                                                                                                                         
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=cdl.dateto                                                                                                                                                                                                                             		
		and cd.isactive = 'Y'
	)as w on w.hsv_toluong_id = k.hsv_toluong_id 
	left join ( --- tong luong ---
		select nkl.hsv_toluong_id,sum(nklsp.amount) as tongluong 
		from hsv_nkluongsp nklsp
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklsp.hsv_nkluong_id 			
		where nkl.c_period_id = $P{C_Period_ID} and nklsp.isactive = 'Y' and nkl.isactive = 'Y'
		group by nkl.hsv_toluong_id
	) as h on k.hsv_toluong_id = h.hsv_toluong_id 
	left join( ---- tong cong--- 
		select nkl.hsv_toluong_id, sum(nklnv.hsv_ngaycong* nklnv.hsv_hesoluong) as tongcong 
		from hsv_nkluongnv nklnv
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 
		where nkl.c_period_id = $P{C_Period_ID} and nklnv.isactive = 'Y' and nkl.isactive = 'Y'		
		group by nkl.hsv_toluong_id 
	) as z on k.hsv_toluong_id = z.hsv_toluong_id	
	---END 1--
	) as k 
	left join (		
		select lc.hsv_toluong_id, lc.hsv_nhanvien_id as a1,  coalesce(hsv_phucap,0) as hsv_phucap, coalesce(hsv_luongcd,0) as hsv_luongcd,coalesce(congmax,0) as congmax,coalesce(hsv_maxcong,0) as hsv_maxcong 
		from hsv_luongcung lc		  
			where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= lc.dateto	                                                                                                                                                                                                                                                                                                                          
				and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=lc.datefrom                                                                                                                                                                                                                                                                                                                         
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= lc.datefrom                                                                                                                                                                                                                                                                                                                      
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=lc.dateto                                                                                                                                                                                                                                                                                                                         
				and lc.ad_client_id =$P{AD_CLIENT_ID}  and lc.isactive = 'Y'				
		  
	) as t on k.hsv_toluong_id=t.hsv_toluong_id  and k.a1 =t.a1
	---end begin 2--
	) as t
	) as t 
		join hsv_toluong tl on t.hsv_toluong_id = tl.hsv_toluong_id
		join hsv_nhanvien nv on t.a1 = nv.hsv_nhanvien_id  
		join ad_org org on t.ad_org_id = org.ad_org_id 
		where (t.ad_org_id =$P{AD_Org_ID} or $P{AD_Org_ID} is null)		
		and nv.ad_client_id = $P{AD_CLIENT_ID}
	---end begin 3-----
) as z join c_bpartner cb on cb.c_bpartner_id = z.c_bpartner_id 
	join c_activity ac on ac.c_activity_id = z.c_activity_id
	join c_elementvalue ev on ev.c_elementvalue_id = z.account_id
where a9<>0
group by org, ac.value 
) as k
group by org,k.hoatdong
) as k on k.id =t.id 

-----5----
union all 

select  k.id,k.org,k.a0 as mota,t.cotluong,k.doitac,k.doitac_name,t.tk,t.hoatdong,t.currency ,  k.a13 as tno,0 as tco
from( 
	select 5 as id, lb.hsv_cotluong, lb.name as cotluong,cb.value as doitac,cb.name as doitac_name, ce.value as tk,ac.value as hoatdong, cc.c_currency_id as currency
	from hsv_luongbep lb 
	join ad_client cl on cl.ad_client_id = lb.ad_client_id
	join c_bpartner cb on cb.c_bpartner_id = lb.c_bpartner_id  
	join c_elementvalue ce on ce.c_elementvalue_id = lb.account_id 
	join c_activity ac on ac.c_activity_id = lb.c_activity_id 
	join c_currency cc on cc.c_currency_id = lb.c_currency_id 
	where lb.ad_client_id = $P{AD_CLIENT_ID}  and hsv_cotluong in ('luong_conlai')
) as t
join (
select 5 as id,org,a0,doitac, doitac_name, a13 
from(
select  org,a0,cb.value as doitac,cb.name as doitac_name,sum(coalesce(a2,0)) as a2,sum(coalesce(a3,0)) as a3,sum(coalesce(a4,0)) as a4,sum(coalesce(a5,0)) as a5,sum(coalesce(a6,0)) as a6,sum(coalesce(a7,0)) as a7,sum(coalesce(a8,0)) as a8,sum(coalesce(a9,0)) as a9,sum(coalesce(a10,0)) as a10,sum(coalesce(a11,0)) as a11,sum(coalesce(a12,0)) as a12,sum(coalesce(a13,0)) as a13 ,sum(((coalesce(a4,0)+coalesce(a5,0)+coalesce(a6,0)+coalesce(a7,0)+coalesce(a8,0))-(coalesce(a10,0) +coalesce(a11,0)+coalesce(a12,0)+coalesce(a13,0)))) as a14,sum(coalesce(a15,0)) as a15 
from( 
----begin 4---
select org.name as  org,t.hsv_toluong_id,tl.name as a0,tl.c_bpartner_id,nv.name as  a1,a2,a3,a4,a5,a6,a7,a8, a4+a5+a6+a7+a8 as a9,a10,a11,
case when a2 = 0 then 0 else  case when ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100>t.hsv_max_kpcd then t.hsv_max_kpcd else ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100 end end as a12,a13,a15
from(
---begin 3--
select t.ad_org_id,t.hsv_toluong_id,  a1, a2,  a3,   a4, case when  a2=0 then 0 else case when   (a3*a16)<a5 then (a3* a16) else a5 end end as a5,a6,a7,a8+t.hsv_phucap + case when t.hsv_maxcong <> 0  and a2 >= congmax then  t.hsv_luongcd/t.hsv_maxcong*a15*congmax  else case when t.hsv_maxcong <> 0 then t.hsv_luongcd/t.hsv_maxcong*a15*a2 else  0 end end as a8 , a10 , 
	t.hsv_tlkpcd, t.hsv_max_kpcd, a11, a13, a15
from(
--BEGIN 2--
select k.ad_org_id,k.hsv_toluong_id,k.a1 as a1, hsv_ngaycong as a2,coalesce(hsv_luongbhxh,0) as a3,
case when tongcong <>0 then(hsv_ngaycong* hsv_hesoluong)* (tongluong/tongcong) else 0 end as a4,
case when hsv_htbhxh = 'Y' then  hsv_maxHTBHXH else 0 end as a5,
hsv_ngayanca*hsv_ht_anca as a6,
(hsv_ngaytangca2*hsv_muc_tc2+ hsv_ngaytangca3*hsv_muc_tc3+hsv_congdem* hsv_bddem) as a7,
hsv_luongspnv as a8,(coalesce(hsv_luongbhxh,0)*hsv_tlbhxh/100) as a10,
hsv_tlkpcd,hsv_max_kpcd,hsv_muc_anca*hsv_ngayanca+hsv_congdem*hsv_andem + hsv_ngaytangca2 * hsv_antangca2 + hsv_ngaytangca3*hsv_antangca3 as a11,hsv_ckluong as a13,hsv_hesoluong as a15,hsv_tlhtbhxh/100 as a16,case when hsv_ngaycong <> 0 then coalesce(t.hsv_phucap,0) else 0 end as hsv_phucap,coalesce(t.hsv_luongcd,0) as hsv_luongcd, coalesce(t.congmax,0) as congmax, coalesce(t.hsv_maxcong,0) as hsv_maxcong
from
(
--BEGIN 1---
	select k.ad_org_id,k.hsv_toluong_id,k.hsv_nhanvien_id as a1, coalesce(hsv_ngaycong,0) as hsv_ngaycong, coalesce(hsv_hesoluong,0) as hsv_hesoluong, coalesce(hsv_ngayanca,0) as hsv_ngayanca, coalesce(hsv_ngaytangca2,0) as hsv_ngaytangca2,
	coalesce(hsv_congdem,0) as hsv_congdem,(coalesce(hsv_ckluong,0)  + coalesce(g.luongck,0)) as hsv_ckluong ,coalesce(hsv_ngaytangca3,0) as hsv_ngaytangca3 ,coalesce(hsv_luongspnv,0) as hsv_luongspnv ,coalesce(hsv_luongbhxh,0) as hsv_luongbhxh ,
	coalesce(hsv_maxHTBHXH,0) as hsv_maxHTBHXH,coalesce(hsv_ht_anca,0) as hsv_ht_anca,coalesce(hsv_muc_tc2,0) as hsv_muc_tc2,coalesce(hsv_muc_tc3,0) as hsv_muc_tc3,coalesce(hsv_bddem,0) as hsv_bddem,coalesce(hsv_tlbhxh,0) as hsv_tlbhxh,hsv_htbhxh , coalesce(hsv_tlkpcd,0) as hsv_tlkpcd,
	coalesce(hsv_max_kpcd,0) as hsv_max_kpcd,coalesce(hsv_muc_anca,0) as hsv_muc_anca,coalesce(hsv_tlhtbhxh,0) as hsv_tlhtbhxh, coalesce(tongcong,0) as tongcong,coalesce(tongluong,0) as tongluong,coalesce(hsv_andem,0) as hsv_andem,coalesce(hsv_antangca2,0) as hsv_antangca2,coalesce(hsv_antangca3,0) as hsv_antangca3 
	from(
		select b.ad_org_id,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_luongbhxh else 0 end as hsv_luongbhxh,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_htbhxh  end as hsv_htbhxh,b.hsv_toluong_id,b.hsv_nhanvien_id, b.hsv_ngaycong,
			b.hsv_hesoluong, b.hsv_ngayanca,b.hsv_ngaytangca2, b.hsv_congdem, b.hsv_ckluong,b.hsv_ngaytangca3,b.hsv_luongspnv
		from (							
				select  nv.hsv_nhanvien_id, MAX(nv.hsv_ngaycong) as ngaycongk,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh 						
				from hsv_nkluong nk
				join hsv_nkluongnv nv on nk.hsv_nkluong_id = nv.hsv_nkluong_id 
				join hsv_luongbhxhline bhxh on bhxh.hsv_nhanvien_id = nv.hsv_nhanvien_id and bhxh.hsv_luongbhxh >0 
				where  nk.ad_client_id = $P{AD_CLIENT_ID} and nk.c_period_id =  $P{C_Period_ID} 
					and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto	                                                                                                                                                                                                                                                                                                                          
					and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                         
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                      
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto					
				group by nv.hsv_nhanvien_id,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh											
			) as a
			right join (
				select  hsv_nkluongnv_id,0 as hsv_luongbhxh, nkl.ad_org_id,nkl.hsv_toluong_id,nklnv.hsv_nhanvien_id, hsv_ngaycong,nklnv.hsv_hesoluong, nklnv.hsv_ngayanca,
				nklnv.hsv_ngaytangca2, nklnv.hsv_congdem, nklnv.hsv_ckluong,nklnv.hsv_ngaytangca3,nklnv.hsv_luongspnv
				from hsv_NkluongNV nklnv
				join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 		  
				where  nkl.ad_client_id = $P{AD_CLIENT_ID} and nkl.c_period_id =  $P{C_Period_ID} and nklnv.isactive = 'Y' 								
		) as b on a.hsv_nhanvien_id =b.hsv_nhanvien_id and a.ngaycongk =  b.hsv_ngaycong 																
	) as k 	
	left join (
	--- chuyen khoan luong---
		select vck.hsv_nhanvien_id,vck.hsv_toluong_id, coalesce(vck.hsv_ckluong,0)  as luongck
		from	hsv_chuyenkhoan vck 
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= vck.dateto	                                                                                                                                                                                                                                                                                                                          
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=vck.datefrom                                                                                                                                                                                                                                                                                                                          
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= vck.datefrom                                                                                                                                                                                                                                                                                                                       
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=vck.dateto                                                                                                                                                                                                                                                                                                                          
		and vck.ad_client_id =$P{AD_CLIENT_ID} and vck.isactive = 'Y'
	) as g on k.hsv_toluong_id =g.hsv_toluong_id and k.hsv_nhanvien_id =g.hsv_nhanvien_id	
	left join ( --- che do luong----
		select tl.hsv_toluong_id ,hsv_maxHTBHXH,cdl.hsv_ht_anca,cdl.hsv_muc_tc2,cdl.hsv_muc_tc3,cdl.hsv_bddem,cdl.hsv_tlbhxh, cdl.hsv_tlkpcd,cdl.hsv_max_kpcd,cdl.hsv_muc_anca,cdl.hsv_andem,cdl.hsv_antangca2,cdl.hsv_antangca3 	
		,cdl.hsv_tlhtbhxh 
		from hsv_chedo cd 		
		left join hsv_cd_luong cdl on cd.hsv_chedo_id = cdl.hsv_chedo_id and cdl.isactive = 'Y'
		left join hsv_toluong tl on tl.hsv_chedo_id = cd.hsv_chedo_id and tl.isactive = 'Y'
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= cdl.dateto	                                                                                                                                                                                                                                                                                                                              
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=cdl.datefrom                                                                                                                                                                                                                                                                                                                            
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= cdl.datefrom                                                                                                                                                                                                                                                                                                                         
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=cdl.dateto                                                                                                                                                                                                                             		
		and cd.isactive = 'Y'
	)as w on w.hsv_toluong_id = k.hsv_toluong_id 
	left join ( --- tong luong ---
		select nkl.hsv_toluong_id,sum(nklsp.amount) as tongluong 
		from hsv_nkluongsp nklsp
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklsp.hsv_nkluong_id 			
		where nkl.c_period_id = $P{C_Period_ID} and nklsp.isactive = 'Y' and nkl.isactive = 'Y'
		group by nkl.hsv_toluong_id
	) as h on k.hsv_toluong_id = h.hsv_toluong_id 
	left join( ---- tong cong--- 
		select nkl.hsv_toluong_id, sum(nklnv.hsv_ngaycong* nklnv.hsv_hesoluong) as tongcong 
		from hsv_nkluongnv nklnv
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 
		where nkl.c_period_id = $P{C_Period_ID} and nklnv.isactive = 'Y' and nkl.isactive = 'Y'		
		group by nkl.hsv_toluong_id 
	) as z on k.hsv_toluong_id = z.hsv_toluong_id	
	---END 1--
	) as k 
	left join (		
		select lc.hsv_toluong_id, lc.hsv_nhanvien_id as a1,  coalesce(hsv_phucap,0) as hsv_phucap, coalesce(hsv_luongcd,0) as hsv_luongcd,coalesce(congmax,0) as congmax,coalesce(hsv_maxcong,0) as hsv_maxcong 
		from hsv_luongcung lc		  
			where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= lc.dateto	                                                                                                                                                                                                                                                                                                                          
				and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=lc.datefrom                                                                                                                                                                                                                                                                                                                         
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= lc.datefrom                                                                                                                                                                                                                                                                                                                      
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=lc.dateto                                                                                                                                                                                                                                                                                                                         
				and lc.ad_client_id =$P{AD_CLIENT_ID}  and lc.isactive = 'Y'				
		  
	) as t on k.hsv_toluong_id=t.hsv_toluong_id  and k.a1 =t.a1
	---end begin 2--
	) as t
	) as t 
		join hsv_toluong tl on t.hsv_toluong_id = tl.hsv_toluong_id
		join hsv_nhanvien nv on t.a1 = nv.hsv_nhanvien_id  
		join ad_org org on t.ad_org_id = org.ad_org_id 
		where (t.ad_org_id =$P{AD_Org_ID} or $P{AD_Org_ID} is null)		
		and nv.ad_client_id = $P{AD_CLIENT_ID}
	---end begin 3-----
) as z join c_bpartner cb on cb.c_bpartner_id = z.c_bpartner_id 
where a9<>0
group by a0,org, value,cb.name
) as k
) as k on k.id =t.id 

union all 


select  t.id,t.org,'' as mota,t.cotluong,t.doitac,t.doitac_name,t.tk,t.hoatdong,t.currency ,  0 as tno,a13 as tco
from( 
	select 6 as id, org.name as org, lb.hsv_cotluong, lb.name as cotluong,cb.value as doitac, cb.name as doitac_name, ce.value as tk,ac.value as hoatdong, cc.c_currency_id as currency
	from hsv_luongbep lb 
	join ad_client cl on cl.ad_client_id = lb.ad_client_id
	join ad_org org on org.ad_org_id = lb.ad_org_id 
	join c_bpartner cb on cb.c_bpartner_id = lb.c_bpartner_id  
	join c_elementvalue ce on ce.c_elementvalue_id = lb.account_id 
	join c_activity ac on ac.c_activity_id = lb.c_activity_id 
	join c_currency cc on cc.c_currency_id = lb.c_currency_id 
	where lb.ad_client_id = $P{AD_CLIENT_ID}  and hsv_cotluong in ('luong_ck')

) as t
join (
select 6 as id, sum(a13)  as a13
from(
select  org,a0,cb.value as doitac,cb.name as doitac_name,sum(coalesce(a2,0)) as a2,sum(coalesce(a3,0)) as a3,sum(coalesce(a4,0)) as a4,sum(coalesce(a5,0)) as a5,sum(coalesce(a6,0)) as a6,sum(coalesce(a7,0)) as a7,sum(coalesce(a8,0)) as a8,sum(coalesce(a9,0)) as a9,sum(coalesce(a10,0)) as a10,sum(coalesce(a11,0)) as a11,sum(coalesce(a12,0)) as a12,sum(coalesce(a13,0)) as a13 ,sum(((coalesce(a4,0)+coalesce(a5,0)+coalesce(a6,0)+coalesce(a7,0)+coalesce(a8,0))-(coalesce(a10,0) +coalesce(a11,0)+coalesce(a12,0)+coalesce(a13,0)))) as a14,sum(coalesce(a15,0)) as a15 
from( 
----begin 4---
select org.name as  org,t.hsv_toluong_id,tl.name as a0,tl.c_bpartner_id,nv.name as  a1,a2,a3,a4,a5,a6,a7,a8, a4+a5+a6+a7+a8 as a9,a10,a11,
case when a2 = 0 then 0 else  case when ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100>t.hsv_max_kpcd then t.hsv_max_kpcd else ((a4+a5+a6+a7+a8)-(a10+a11))*t.hsv_tlkpcd/100 end end as a12,a13,a15
from(
---begin 3--
select t.ad_org_id,t.hsv_toluong_id,  a1, a2,  a3,   a4, case when  a2=0 then 0 else case when   (a3*a16)<a5 then (a3* a16) else a5 end end as a5,a6,a7,a8+t.hsv_phucap + case when t.hsv_maxcong <> 0  and a2 >= congmax then  t.hsv_luongcd/t.hsv_maxcong*a15*congmax  else case when t.hsv_maxcong <> 0 then t.hsv_luongcd/t.hsv_maxcong*a15*a2 else  0 end end as a8 , a10 , 
	t.hsv_tlkpcd, t.hsv_max_kpcd, a11, a13, a15
from(
--BEGIN 2--
select k.ad_org_id,k.hsv_toluong_id,k.a1 as a1, hsv_ngaycong as a2,coalesce(hsv_luongbhxh,0) as a3,
case when tongcong <>0 then(hsv_ngaycong* hsv_hesoluong)* (tongluong/tongcong) else 0 end as a4,
case when hsv_htbhxh = 'Y' then  hsv_maxHTBHXH else 0 end as a5,
hsv_ngayanca*hsv_ht_anca as a6,
(hsv_ngaytangca2*hsv_muc_tc2+ hsv_ngaytangca3*hsv_muc_tc3+hsv_congdem* hsv_bddem) as a7,
hsv_luongspnv as a8,(coalesce(hsv_luongbhxh,0)*hsv_tlbhxh/100) as a10,
hsv_tlkpcd,hsv_max_kpcd,hsv_muc_anca*hsv_ngayanca+hsv_congdem*hsv_andem + hsv_ngaytangca2 * hsv_antangca2 + hsv_ngaytangca3*hsv_antangca3 as a11,hsv_ckluong as a13,hsv_hesoluong as a15,hsv_tlhtbhxh/100 as a16,case when hsv_ngaycong <> 0 then coalesce(t.hsv_phucap,0) else 0 end as hsv_phucap,coalesce(t.hsv_luongcd,0) as hsv_luongcd, coalesce(t.congmax,0) as congmax, coalesce(t.hsv_maxcong,0) as hsv_maxcong
from
(
--BEGIN 1---
	select k.ad_org_id,k.hsv_toluong_id,k.hsv_nhanvien_id as a1, coalesce(hsv_ngaycong,0) as hsv_ngaycong, coalesce(hsv_hesoluong,0) as hsv_hesoluong, coalesce(hsv_ngayanca,0) as hsv_ngayanca, coalesce(hsv_ngaytangca2,0) as hsv_ngaytangca2,
	coalesce(hsv_congdem,0) as hsv_congdem,(coalesce(hsv_ckluong,0)  + coalesce(g.luongck,0)) as hsv_ckluong ,coalesce(hsv_ngaytangca3,0) as hsv_ngaytangca3 ,coalesce(hsv_luongspnv,0) as hsv_luongspnv ,coalesce(hsv_luongbhxh,0) as hsv_luongbhxh ,
	coalesce(hsv_maxHTBHXH,0) as hsv_maxHTBHXH,coalesce(hsv_ht_anca,0) as hsv_ht_anca,coalesce(hsv_muc_tc2,0) as hsv_muc_tc2,coalesce(hsv_muc_tc3,0) as hsv_muc_tc3,coalesce(hsv_bddem,0) as hsv_bddem,coalesce(hsv_tlbhxh,0) as hsv_tlbhxh,hsv_htbhxh , coalesce(hsv_tlkpcd,0) as hsv_tlkpcd,
	coalesce(hsv_max_kpcd,0) as hsv_max_kpcd,coalesce(hsv_muc_anca,0) as hsv_muc_anca,coalesce(hsv_tlhtbhxh,0) as hsv_tlhtbhxh, coalesce(tongcong,0) as tongcong,coalesce(tongluong,0) as tongluong,coalesce(hsv_andem,0) as hsv_andem,coalesce(hsv_antangca2,0) as hsv_antangca2,coalesce(hsv_antangca3,0) as hsv_antangca3 
	from(
		select b.ad_org_id,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_luongbhxh else 0 end as hsv_luongbhxh,case when  a.hsv_luongbhxh > b.hsv_luongbhxh then a.hsv_htbhxh  end as hsv_htbhxh,b.hsv_toluong_id,b.hsv_nhanvien_id, b.hsv_ngaycong,
			b.hsv_hesoluong, b.hsv_ngayanca,b.hsv_ngaytangca2, b.hsv_congdem, b.hsv_ckluong,b.hsv_ngaytangca3,b.hsv_luongspnv
		from (							
				select  nv.hsv_nhanvien_id, MAX(nv.hsv_ngaycong) as ngaycongk,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh 						
				from hsv_nkluong nk
				join hsv_nkluongnv nv on nk.hsv_nkluong_id = nv.hsv_nkluong_id 
				join hsv_luongbhxhline bhxh on bhxh.hsv_nhanvien_id = nv.hsv_nhanvien_id and bhxh.hsv_luongbhxh >0 
				where  nk.ad_client_id = $P{AD_CLIENT_ID} and nk.c_period_id =  $P{C_Period_ID} 
					and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto	                                                                                                                                                                                                                                                                                                                          
					and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                         
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= bhxh.datefrom                                                                                                                                                                                                                                                                                                                      
					and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= bhxh.dateto					
				group by nv.hsv_nhanvien_id,bhxh.hsv_luongbhxh,bhxh.hsv_htbhxh											
			) as a
			right join (
				select  hsv_nkluongnv_id,0 as hsv_luongbhxh, nkl.ad_org_id,nkl.hsv_toluong_id,nklnv.hsv_nhanvien_id, hsv_ngaycong,nklnv.hsv_hesoluong, nklnv.hsv_ngayanca,
				nklnv.hsv_ngaytangca2, nklnv.hsv_congdem, nklnv.hsv_ckluong,nklnv.hsv_ngaytangca3,nklnv.hsv_luongspnv
				from hsv_NkluongNV nklnv
				join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 		  
				where  nkl.ad_client_id = $P{AD_CLIENT_ID} and nkl.c_period_id =  $P{C_Period_ID} and nklnv.isactive = 'Y' 								
		) as b on a.hsv_nhanvien_id =b.hsv_nhanvien_id and a.ngaycongk =  b.hsv_ngaycong 																
	) as k 
	left join (
	--- chuyen khoan luong---
		select vck.hsv_nhanvien_id,vck.hsv_toluong_id, coalesce(vck.hsv_ckluong,0)  as luongck
		from	hsv_chuyenkhoan vck 
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= vck.dateto	                                                                                                                                                                                                                                                                                                                          
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=vck.datefrom                                                                                                                                                                                                                                                                                                                          
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= vck.datefrom                                                                                                                                                                                                                                                                                                                       
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=vck.dateto                                                                                                                                                                                                                                                                                                                          
		and vck.ad_client_id =$P{AD_CLIENT_ID} and vck.isactive = 'Y'
	) as g on k.hsv_toluong_id =g.hsv_toluong_id and k.hsv_nhanvien_id =g.hsv_nhanvien_id	
	left join ( --- che do luong----
		select tl.hsv_toluong_id ,hsv_maxHTBHXH,cdl.hsv_ht_anca,cdl.hsv_muc_tc2,cdl.hsv_muc_tc3,cdl.hsv_bddem,cdl.hsv_tlbhxh, cdl.hsv_tlkpcd,cdl.hsv_max_kpcd,cdl.hsv_muc_anca,cdl.hsv_andem,cdl.hsv_antangca2,cdl.hsv_antangca3 	
		,cdl.hsv_tlhtbhxh 
		from hsv_chedo cd 		
		left join hsv_cd_luong cdl on cd.hsv_chedo_id = cdl.hsv_chedo_id and cdl.isactive = 'Y'
		left join hsv_toluong tl on tl.hsv_chedo_id = cd.hsv_chedo_id and tl.isactive = 'Y'
		where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= cdl.dateto	                                                                                                                                                                                                                                                                                                                              
		and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=cdl.datefrom                                                                                                                                                                                                                                                                                                                            
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= cdl.datefrom                                                                                                                                                                                                                                                                                                                         
		and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=cdl.dateto                                                                                                                                                                                                                             		
		and cd.isactive = 'Y'
	)as w on w.hsv_toluong_id = k.hsv_toluong_id 
	left join ( --- tong luong ---
		select nkl.hsv_toluong_id,sum(nklsp.amount) as tongluong 
		from hsv_nkluongsp nklsp
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklsp.hsv_nkluong_id 			
		where nkl.c_period_id = $P{C_Period_ID} and nklsp.isactive = 'Y' and nkl.isactive = 'Y'
		group by nkl.hsv_toluong_id
	) as h on k.hsv_toluong_id = h.hsv_toluong_id 
	left join( ---- tong cong--- 
		select nkl.hsv_toluong_id, sum(nklnv.hsv_ngaycong* nklnv.hsv_hesoluong) as tongcong 
		from hsv_nkluongnv nklnv
		left join hsv_nkluong nkl on nkl.hsv_nkluong_id = nklnv.hsv_nkluong_id 
		where nkl.c_period_id = $P{C_Period_ID} and nklnv.isactive = 'Y' and nkl.isactive = 'Y'		
		group by nkl.hsv_toluong_id 
	) as z on k.hsv_toluong_id = z.hsv_toluong_id	
	---END 1--
	) as k 
	left join (		
		select lc.hsv_toluong_id, lc.hsv_nhanvien_id as a1,  coalesce(hsv_phucap,0) as hsv_phucap, coalesce(hsv_luongcd,0) as hsv_luongcd,coalesce(congmax,0) as congmax,coalesce(hsv_maxcong,0) as hsv_maxcong 
		from hsv_luongcung lc		  
			where (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= lc.dateto	                                                                                                                                                                                                                                                                                                                          
				and (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})	>=lc.datefrom                                                                                                                                                                                                                                                                                                                         
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) >= lc.datefrom                                                                                                                                                                                                                                                                                                                      
				and (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <=lc.dateto                                                                                                                                                                                                                                                                                                                         
				and lc.ad_client_id =$P{AD_CLIENT_ID}  and lc.isactive = 'Y'				
		  
	) as t on k.hsv_toluong_id=t.hsv_toluong_id  and k.a1 =t.a1
	---end begin 2--
	) as t
	) as t 
		join hsv_toluong tl on t.hsv_toluong_id = tl.hsv_toluong_id
		join hsv_nhanvien nv on t.a1 = nv.hsv_nhanvien_id  
		join ad_org org on t.ad_org_id = org.ad_org_id 
		where (t.ad_org_id =$P{AD_Org_ID} or $P{AD_Org_ID} is null)		
		and nv.ad_client_id = $P{AD_CLIENT_ID}
	---end begin 3-----
) as z join c_bpartner cb on cb.c_bpartner_id = z.c_bpartner_id 
where a9<>0
group by a0,org, value,cb.name
) as k
) as k on k.id =t.id 


) as k
where tco<>0 or tno<>0
) as k group by org,mota,cotluong,doitac,tk,hoatdong,currency,id,doitac_name

) as z on t.id = z.id]]>
	</queryString>
	<field name="header_org" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_org"/>
		<property name="com.jaspersoft.studio.field.label" value="header_org"/>
	</field>
	<field name="header_sche" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_sche"/>
		<property name="com.jaspersoft.studio.field.label" value="header_sche"/>
	</field>
	<field name="header_sct" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_sct"/>
		<property name="com.jaspersoft.studio.field.label" value="header_sct"/>
	</field>
	<field name="header_desc" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_desc"/>
		<property name="com.jaspersoft.studio.field.label" value="header_desc"/>
	</field>
	<field name="header_type" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_type"/>
		<property name="com.jaspersoft.studio.field.label" value="header_type"/>
	</field>
	<field name="header_gl" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_gl"/>
		<property name="com.jaspersoft.studio.field.label" value="header_gl"/>
	</field>
	<field name="header_date" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_date"/>
		<property name="com.jaspersoft.studio.field.label" value="header_date"/>
	</field>
	<field name="header_period" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="header_period"/>
		<property name="com.jaspersoft.studio.field.label" value="header_period"/>
	</field>
	<field name="detail_org" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="detail_org"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_org"/>
	</field>
	<field name="detail_sct" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="detail_sct"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_sct"/>
	</field>
	<field name="detail_stt" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="detail_stt"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_stt"/>
	</field>
	<field name="detail_desc" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="detail_desc"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_desc"/>
	</field>
	<field name="detail_doitac" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="detail_doitac"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_doitac"/>
	</field>
	<field name="detail_tk" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="detail_tk"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_tk"/>
	</field>
	<field name="detail_hoatdong" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="detail_hoatdong"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_hoatdong"/>
	</field>
	<field name="detail_curencty" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="detail_curencty"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_curencty"/>
	</field>
	<field name="detail_tno" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="detail_tno"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_tno"/>
	</field>
	<field name="detail_tco" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="detail_tco"/>
		<property name="com.jaspersoft.studio.field.label" value="detail_tco"/>
	</field>
	<variable name="sum_co" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{detail_tco}]]></variableExpression>
	</variable>
	<variable name="sum_no" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{detail_tno}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="30">
			<staticText>
				<reportElement x="720" y="0" width="60" height="30" uuid="275cfbf3-413a-4803-9bef-0b0ff0380852">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="c51600af-23ca-415d-894f-25ef56524fa8"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>C_BPartner_ID[Value]]]></text>
			</staticText>
			<staticText>
				<reportElement x="540" y="0" width="60" height="30" uuid="e9b06c0f-b68b-4e0f-8501-af0d659f2a70">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="2a348f0e-57c6-419d-abdf-93b42d14de7a"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>GL_Journal_ID[DocumentNo]]]></text>
			</staticText>
			<staticText>
				<reportElement x="900" y="0" width="60" height="30" uuid="10b37c38-e876-414d-92cb-bc5a04b3efa5">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="4cc3b33f-9f87-4fa7-be1b-4917d65f8db9"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>C_Currency_ID]]></text>
			</staticText>
			<staticText>
				<reportElement x="360" y="0" width="60" height="30" uuid="a2fb1e67-3c70-49e4-917d-c2a17a14b006">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="066ce693-44e7-47d3-b566-b5ddb1a40057"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[DateDoc]]></text>
			</staticText>
			<staticText>
				<reportElement x="960" y="0" width="60" height="30" uuid="9e878cee-22eb-4105-a893-48a7eb08ab5d">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="49e55137-605d-43ca-a050-17b5cdee2b12"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>AmtSourceDr]]></text>
			</staticText>
			<staticText>
				<reportElement x="600" y="0" width="60" height="30" uuid="c40a141d-fa20-4c2c-ba13-987885396849">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="2a348f0e-57c6-419d-abdf-93b42d14de7a"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>Line]]></text>
			</staticText>
			<staticText>
				<reportElement x="420" y="0" width="60" height="30" uuid="af5396d7-1427-46c9-96cb-6a0da03871e8">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="f110c9d4-47d3-4800-9f5d-e1679bdd845f"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[C_Period_ID[Name]]]></text>
			</staticText>
			<staticText>
				<reportElement x="660" y="0" width="60" height="30" uuid="e30ed389-535e-4281-b025-e8aa07c8807f">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1a0d4f47-cb63-42f0-9b7e-c2478b20a465"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>Description]]></text>
			</staticText>
			<staticText>
				<reportElement x="840" y="0" width="60" height="30" uuid="43d7dfb8-a1fa-4bcd-8fa2-17572e210577">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8ddd8014-b76e-4b76-b04e-e5174041f58f"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>C_Activity_ID[Value]]]></text>
			</staticText>
			<staticText>
				<reportElement x="180" y="0" width="60" height="30" uuid="c590d63e-a247-4c94-8874-281fae26a09b">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="76663413-3feb-45fb-88cf-fee1186972c8"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[Description]]></text>
			</staticText>
			<staticText>
				<reportElement x="1020" y="0" width="60" height="30" uuid="72bd0960-489a-4c1d-bdea-a26faa9d4369">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="acf19882-8a15-4b90-802d-52cb6d3abc56"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>AmtSourceCr]]></text>
			</staticText>
			<staticText>
				<reportElement x="480" y="0" width="60" height="30" uuid="d3892bec-0543-41bb-9592-bc9b127718e1">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="2a348f0e-57c6-419d-abdf-93b42d14de7a"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>AD_Org_ID[Name]]]></text>
			</staticText>
			<staticText>
				<reportElement x="120" y="0" width="60" height="30" uuid="7fd3899f-a645-40e9-9b0f-1c8c9e6d7cc8">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3120a5d8-5ab0-444a-9b08-d77abb2badec"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[DocumentNo]]></text>
			</staticText>
			<staticText>
				<reportElement x="60" y="0" width="60" height="30" uuid="5c01d251-e3f1-465c-8c39-37f616358411">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d7fbc9af-7155-47c8-af32-db514cbe3b05"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[C_AcctSchema_ID[Name]]]></text>
			</staticText>
			<staticText>
				<reportElement x="780" y="0" width="60" height="30" uuid="4b0be2e8-4651-4531-a7cb-3e550571a145">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="c611a65f-4195-4a58-b0cc-65452e4724e7"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_JournalLine>Account_ID[Value]]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="60" height="30" uuid="d8b4e081-382a-4ac2-9a02-774489a53f09">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d7fbc9af-7155-47c8-af32-db514cbe3b05"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[AD_Org_ID[Name]]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="0" width="60" height="30" uuid="b49ba509-ab70-4e27-b976-60f53c140445">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="0ef2bc1d-b889-44dd-9e1e-fc918024a92d"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[C_DocType_ID[Name]]]></text>
			</staticText>
			<staticText>
				<reportElement x="300" y="0" width="60" height="30" uuid="c8fd2d79-5692-4bc0-be14-105d4a881606">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="0ef2bc1d-b889-44dd-9e1e-fc918024a92d"/>
				</reportElement>
				<box>
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<text><![CDATA[GL_Category_ID[Name]]]></text>
			</staticText>
		</band>
	</title>
	<detail>
		<band height="23" splitType="Stretch">
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="360" y="0" width="60" height="23" uuid="e5f5c3f0-de7a-4fbf-abc8-fec05e5cc396">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="066ce693-44e7-47d3-b566-b5ddb1a40057"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_date}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="180" y="0" width="60" height="23" uuid="50edb50e-bf51-40a0-9112-6a9bdcacb9c9">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="76663413-3feb-45fb-88cf-fee1186972c8"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_desc}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="420" y="0" width="60" height="23" uuid="5668577c-32c2-4ee7-a263-d7020802a253">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="f110c9d4-47d3-4800-9f5d-e1679bdd845f"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_period}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="720" y="0" width="60" height="23" uuid="869ca9dd-c052-467a-ab84-7a2b6e0ffd3d">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="c51600af-23ca-415d-894f-25ef56524fa8"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_doitac}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="780" y="0" width="60" height="23" uuid="786d942a-d7ea-4a38-b6de-e95802c4ff42">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="c611a65f-4195-4a58-b0cc-65452e4724e7"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_tk}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="600" y="0" width="60" height="23" uuid="e628ede4-f08a-469c-9564-5f49c8a7992b">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="2a348f0e-57c6-419d-abdf-93b42d14de7a"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_stt}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="480" y="0" width="60" height="23" uuid="15754aac-6bfa-453a-8cbb-0147dfa64c84">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="f110c9d4-47d3-4800-9f5d-e1679bdd845f"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_org}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="1020" y="0" width="60" height="23" uuid="56fb99ec-49e5-4f06-b807-30a574db5bf2">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="acf19882-8a15-4b90-802d-52cb6d3abc56"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_tco}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="240" y="0" width="60" height="23" uuid="9f2ae293-b96f-4ce9-9d2d-3c92d6a455d3">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="0ef2bc1d-b889-44dd-9e1e-fc918024a92d"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_type}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="540" y="0" width="60" height="23" uuid="c504f395-bd01-4789-8ce4-ead56d08d46c">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="f110c9d4-47d3-4800-9f5d-e1679bdd845f"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_sct}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="60" height="23" uuid="b51b7584-2793-4b13-af2e-d4544ef22af0">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d7fbc9af-7155-47c8-af32-db514cbe3b05"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_org}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" pattern="#,##0.###" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="960" y="0" width="60" height="23" uuid="77746361-1e17-4bb6-a6c8-a2233d395ff2">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="49e55137-605d-43ca-a050-17b5cdee2b12"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_tno}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="840" y="0" width="60" height="23" uuid="44ad0cee-8cf8-48f8-bd1d-c85ff711ea15">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8ddd8014-b76e-4b76-b04e-e5174041f58f"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_hoatdong}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="900" y="0" width="60" height="23" uuid="682e0e27-7f6a-4631-bdbb-35515db72398">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="4cc3b33f-9f87-4fa7-be1b-4917d65f8db9"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_curencty}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="120" y="0" width="60" height="23" uuid="f77467eb-c439-4565-a62c-83d721f2950e">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3120a5d8-5ab0-444a-9b08-d77abb2badec"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_sct}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="660" y="0" width="60" height="23" uuid="dafa3f9e-ce2d-4c56-9b77-71461059a5ff">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="1a0d4f47-cb63-42f0-9b7e-c2478b20a465"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{detail_desc}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="60" y="0" width="60" height="23" uuid="00aad88d-7911-4fcc-adbd-dcfd2949c15d">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d7fbc9af-7155-47c8-af32-db514cbe3b05"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_sche}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="300" y="0" width="60" height="23" uuid="f2f48ab1-e92b-48a1-9b2b-ded003c41278">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="0ef2bc1d-b889-44dd-9e1e-fc918024a92d"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="1" rightPadding="1">
					<pen lineWidth="0.25"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{header_gl}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
