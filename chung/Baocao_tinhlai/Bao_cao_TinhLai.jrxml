<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.20.0.final using JasperReports Library version 6.20.0-2bc7ab61c56f459e8176eb05c7705e145cd400ad  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Bao_cao_TinhLai" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="e930f431-940f-4668-9884-d44c5c485866">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="psql"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.keep.first.band.1" value="columnHeader"/>
	<property name="net.sf.jasperreports.export.xlsx.exclude.origin.keep.first.band.1" value="columnHeader"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.band.2" value="pageFooter"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.band.3" value="groupHeader"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="true"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="true"/>
	<property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="net.sf.jasperreports.export.xls.ignore.graphics" value="false"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.band.1" value="pageHeader"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.group.3" value="ProductGroup"/>
	<property name="net.sf.jasperreports.export.xls.exclude.origin.report.3" value="ProductReport"/>
	<property name="net.sf.jasperreports.export.xls.ignore.cell.border" value="false"/>
	<property name="net.sf.jasperreports.export.xlsx.exclude.origin.band.2" value="pageFooter"/>
	<property name="net.sf.jasperreports.export.xlsx.exclude.origin.band.3" value="groupHeader"/>
	<property name="net.sf.jasperreports.export.xlsx.remove.empty.space.between.rows" value="true"/>
	<property name="net.sf.jasperreports.export.xlsx.remove.empty.space.between.columns" value="true"/>
	<property name="net.sf.jasperreports.export.xlsx.white.page.background" value="false"/>
	<property name="net.sf.jasperreports.export.xlsx.detect.cell.type" value="true"/>
	<property name="net.sf.jasperreports.export.xlsx.ignore.graphics" value="false"/>
	<property name="net.sf.jasperreports.export.xlsx.exclude.origin.band.1" value="pageHeader"/>
	<property name="net.sf.jasperreports.export.xlsx.exclude.origin.group.3" value="ProductGroup"/>
	<property name="net.sf.jasperreports.export.xlsx.exclude.origin.report.3" value="ProductReport"/>
	<property name="net.sf.jasperreports.export.xlsx.ignore.cell.border" value="false"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<parameter name="C_Period_ID" class="java.lang.Integer"/>
	<parameter name="AD_CLIENT_ID" class="java.lang.Integer"/>
	<parameter name="Account_ID" class="java.lang.Integer"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["dev/"]]></defaultValueExpression>
	</parameter>
	<parameter name="C_BPartner_ID" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[select ROW_NUMBER() OVER (PARTITION BY nhom ORDER BY nhom) AS "stt", * from 
(
SELECT 'lx' as nhom,cb.value,cb.name,coalesce(rate.hsv_laisuat,null) as  hsv_laisuat, round(k.dudau,0) as dudau, round(k.ducuoi,0) as ducuoi,k.sodu*coalesce(rate.hsv_laisuat,null)/100/30  as laithang
FROM(
	select c_bpartner_id, sum(dudau) as dudau,sum(ducuoi) as ducuoi,sum(psco - psno) as sodu
	FROM(
		SELECT t.c_bpartner_id, 
			sum(CASE WHEN t.dateacct < (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctcr - t.amtacctdr)  ELSE 0 END) AS dudau,
			sum(CASE WHEN t.dateacct <= (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctcr - t.amtacctdr)  ELSE 0 END) AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t 
		where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+1 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+1 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+1<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+2 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+2 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+2<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+3 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+3 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+3<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+4 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+4 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+4<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+5 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+5 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+5<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+6 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+6 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+6<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+7 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+7 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+7<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+8 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+8 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+8<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+9 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+9 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+9<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+10 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+10 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+10<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+11 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+11 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+11<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+12 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+12 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+12<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+13 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+13 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+13<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+14 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+14 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+14<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+15 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+15 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+15<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+16 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+16 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+16<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+17 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+17 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+17<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+18 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+18 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+18<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+19 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+19 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+19<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+20 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+20 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+20<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+21 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+21 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+21<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+22 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+22 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+22<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+23 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+23 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+23<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+24 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+24 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+24<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+25 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+25 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+25<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+26 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+26 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+26<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+27 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+27 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+27<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+28 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+28 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+28<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+29 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+29 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+29<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+30 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+30 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+30<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
	) as k 

	group by c_bpartner_id 
) as k  
join c_bpartner cb on  cb.c_bpartner_id = k.c_bpartner_id
left join c_bpartner_rate rate on cb.c_bpartner_id = rate.c_bpartner_id 
where  (cb.c_bpartner_id=$P{C_BPartner_ID} or $P{C_BPartner_ID} is null ) and rate.hsv_laisuat is not null 
and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) <= rate.dateto 
and  (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})>=rate.datefrom

union all 

SELECT 'lx' as nhom,cb.value,cb.name,coalesce(rate.hsv_laisuat,null) as  hsv_laisuat, round(k.dudau,0) as dudau, round(k.ducuoi,0) as ducuoi,k.sodu*coalesce(rate.hsv_laisuat,null)/100/30  as laithang
FROM(
	select c_bpartner_id, sum(dudau) as dudau,sum(ducuoi) as ducuoi,sum(psco - psno) as sodu
	FROM(
		SELECT t.c_bpartner_id, 
			sum(CASE WHEN t.dateacct < (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctcr - t.amtacctdr)  ELSE 0 END) AS dudau,
			sum(CASE WHEN t.dateacct <= (select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctcr - t.amtacctdr)  ELSE 0 END) AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t 
		where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+1 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+1 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+1<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+2 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+2 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+2<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+3 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+3 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+3<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+4 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+4 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+4<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+5 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+5 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+5<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+6 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+6 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+6<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+7 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+7 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+7<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+8 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+8 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+8<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+9 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+9 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+9<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+10 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+10 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+10<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+11 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+11 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+11<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+12 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+12 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+12<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+13 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+13 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+13<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+14 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+14 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+14<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+15 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+15 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+15<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+16 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+16 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+16<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+17 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+17 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+17<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+18 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+18 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+18<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+19 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+19 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+19<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+20 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+20 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+20<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+21 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+21 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+21<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+22 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+22 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+22<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+23 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+23 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+23<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+24 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+24 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+24<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+25 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+25 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+25<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+26 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+26 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+26<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+27 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+27 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+27<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+28 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+28 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+28<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+29 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+29 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+29<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
		
		UNION ALL
		
		SELECT t.c_bpartner_id, 
			0 AS dudau,
			0 AS ducuoi,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+30 THEN (t.amtacctcr) ELSE 0 END) AS psco,
			sum(CASE WHEN t.dateacct <= (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+30 THEN (t.amtacctdr) ELSE 0 END) AS psno
		FROM fact_acct t  where (select startdate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID})+30<=(select enddate from c_period where c_period_id =  $P{C_Period_ID} and ad_client_id = $P{AD_CLIENT_ID}) and t.account_id=$P{Account_ID} and t.ad_client_id = $P{AD_CLIENT_ID} 
		GROUP by c_bpartner_id
	) as k 
	group by c_bpartner_id 
) as k  
join c_bpartner cb on  cb.c_bpartner_id = k.c_bpartner_id
left join c_bpartner_rate rate on cb.c_bpartner_id = rate.c_bpartner_id 
where  (cb.c_bpartner_id=$P{C_BPartner_ID} or $P{C_BPartner_ID} is null ) and rate.hsv_laisuat is null
)as k where laithang<>0]]>
	</queryString>
	<field name="stt" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.label" value="stt"/>
	</field>
	<field name="nhom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="nhom"/>
	</field>
	<field name="value" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="value"/>
	</field>
	<field name="name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="name"/>
	</field>
	<field name="hsv_laisuat" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="hsv_laisuat"/>
	</field>
	<field name="dudau" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="dudau"/>
	</field>
	<field name="ducuoi" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="ducuoi"/>
	</field>
	<field name="laithang" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="laithang"/>
	</field>
	<variable name="sum_dauky" class="java.math.BigDecimal" resetType="Group" resetGroup="nhom" calculation="Sum">
		<variableExpression><![CDATA[$F{dudau}]]></variableExpression>
	</variable>
	<variable name="sum_cuoiky" class="java.math.BigDecimal" resetType="Group" resetGroup="nhom" calculation="Sum">
		<variableExpression><![CDATA[$F{ducuoi}]]></variableExpression>
	</variable>
	<variable name="sum_phaitra" class="java.math.BigDecimal" resetType="Group" resetGroup="nhom" calculation="Sum">
		<variableExpression><![CDATA[$F{laithang}]]></variableExpression>
	</variable>
	<group name="nhom">
		<groupExpression><![CDATA[$F{nhom}]]></groupExpression>
		<groupFooter>
			<band height="23">
				<textField pattern="#,##0">
					<reportElement x="483" y="0" width="80" height="23" uuid="1c47bddb-ac83-48f4-a0fa-bfba225c8ccb">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="dd6c0c58-40a2-476e-b6f9-99b4be9c8fde"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<box leftPadding="2" rightPadding="2">
						<pen lineWidth="0.75"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="9" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_phaitra}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0">
					<reportElement x="378" y="0" width="105" height="23" uuid="150f4552-f593-4376-a807-71c19b74bfbc">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="9ea21aad-7922-475d-8ac0-6bd04a18b8fd"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<box leftPadding="2" rightPadding="2">
						<pen lineWidth="0.75"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="9" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_cuoiky}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0">
					<reportElement x="273" y="0" width="105" height="23" uuid="d0fef2e2-cd03-4c24-98e0-24b043772035">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="026994a6-2dea-4ae8-99b5-00da08abb375"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<box leftPadding="2" rightPadding="2">
						<pen lineWidth="0.75"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="9" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_dauky}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.###">
					<reportElement x="243" y="0" width="30" height="23" uuid="2cbff8d9-2f89-4c53-ad02-333ef012059a">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d4af8b32-3f0b-4856-b06b-5b745c78f341"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<box leftPadding="2" rightPadding="2">
						<pen lineWidth="0.75"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Arial" size="9"/>
					</textElement>
					<textFieldExpression><![CDATA[""]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="-5" y="0" width="248" height="23" uuid="0aa9f879-6bff-4d0e-bdd5-d560a382eca7">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="63127807-0d4b-47eb-a7f8-cc612da3a95c"/>
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<box leftPadding="2" rightPadding="2">
						<pen lineWidth="0.75"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Arial" size="9" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Tng cng"]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="126" splitType="Stretch">
			<subreport>
				<reportElement x="-5" y="76" width="568" height="25" uuid="1e953894-f231-43ce-b308-f117e059d604">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<subreportParameter name="C_Period_ID">
					<subreportParameterExpression><![CDATA[$P{C_Period_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="Account_ID">
					<subreportParameterExpression><![CDATA[$P{Account_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"sub_Ky_ketoan.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement x="-5" y="101" width="278" height="25" uuid="ae0d0a17-7548-400c-a72a-eb028da24fe0">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<subreportParameter name="C_Period_ID">
					<subreportParameterExpression><![CDATA[$P{C_Period_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="Account_ID">
					<subreportParameterExpression><![CDATA[$P{Account_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"sub_taikhoan.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement x="-5" y="44" width="568" height="30" uuid="c7bc5e36-4ee3-4507-898f-a173edba9dd1">
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="20" isBold="true"/>
				</textElement>
				<text><![CDATA[BO CO TNH LI HUY NG VN TRONG K]]></text>
			</staticText>
			<subreport>
				<reportElement x="-5" y="0" width="568" height="44" uuid="4a44f39c-fa9b-4c29-94ab-537d7a85a83f">
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<subreportParameter name="C_Period_ID">
					<subreportParameterExpression><![CDATA[$P{C_Period_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="Account_ID">
					<subreportParameterExpression><![CDATA[$P{Account_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="C_BPartner_ID">
					<subreportParameterExpression><![CDATA[$P{C_BPartner_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"CompanyHeader.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement x="273" y="101" width="290" height="25" uuid="974f70e5-eac4-475e-9fe3-b760f4697fcf">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<subreportParameter name="C_Period_ID">
					<subreportParameterExpression><![CDATA[$P{C_Period_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="AD_CLIENT_ID">
					<subreportParameterExpression><![CDATA[$P{AD_CLIENT_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="Account_ID">
					<subreportParameterExpression><![CDATA[$P{Account_ID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR}+"sub_bpartner.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</title>
	<columnHeader>
		<band height="23" splitType="Stretch">
			<printWhenExpression><![CDATA[$V{PAGE_COUNT}==1]]></printWhenExpression>
			<staticText>
				<reportElement x="-5" y="0" width="26" height="23" uuid="e935d6eb-ed4b-4ff9-a887-d7cfdf748b87">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="9d2357f2-4a51-439e-928a-515521b95402"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[STT]]></text>
			</staticText>
			<staticText>
				<reportElement x="21" y="0" width="81" height="23" uuid="ef80620b-7b69-40ec-8c8d-c3e0f02c09e9">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="63127807-0d4b-47eb-a7f8-cc612da3a95c"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[K hiu]]></text>
			</staticText>
			<staticText>
				<reportElement x="102" y="0" width="141" height="23" uuid="6c82b84d-1804-4c7a-993d-8e2a6423075e">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="59dfecf5-bb84-4a2e-8ca5-94bda78d39e3"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[Tn khch hng]]></text>
			</staticText>
			<staticText>
				<reportElement x="243" y="0" width="30" height="23" uuid="248a71e8-2f22-46b7-b853-b34eda553e89">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d4af8b32-3f0b-4856-b06b-5b745c78f341"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Arial" size="9" isBold="true"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[Li sut]]></text>
			</staticText>
			<staticText>
				<reportElement x="273" y="0" width="105" height="23" uuid="f4550308-b4be-418b-935b-4015bcd0ce19">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="026994a6-2dea-4ae8-99b5-00da08abb375"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[D u k]]></text>
			</staticText>
			<staticText>
				<reportElement x="378" y="0" width="105" height="23" uuid="67d216b9-8103-4357-a578-e8d1a9186909">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="9ea21aad-7922-475d-8ac0-6bd04a18b8fd"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[D cui k]]></text>
			</staticText>
			<staticText>
				<reportElement x="483" y="0" width="80" height="23" uuid="07ddc27b-9017-4dfe-9b08-131aa9d643d9">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="dd6c0c58-40a2-476e-b6f9-99b4be9c8fde"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9" isBold="true"/>
				</textElement>
				<text><![CDATA[Li phi tr]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="23" splitType="Stretch">
			<textField>
				<reportElement x="-5" y="0" width="26" height="23" uuid="10b3865d-7724-498c-ab68-77e63e4fd471">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="9d2357f2-4a51-439e-928a-515521b95402"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{stt}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="21" y="0" width="81" height="23" uuid="2917f806-a91f-4e60-b053-6749ba444d25">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="63127807-0d4b-47eb-a7f8-cc612da3a95c"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{value}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="102" y="0" width="141" height="23" uuid="4373ddae-7dbf-4f35-ae8c-1f8f244a167f">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="59dfecf5-bb84-4a2e-8ca5-94bda78d39e3"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{name}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.##">
				<reportElement x="243" y="0" width="30" height="23" uuid="a6f8b841-8a63-43e8-a8cf-90fa5bd8ce9f">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="d4af8b32-3f0b-4856-b06b-5b745c78f341"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{hsv_laisuat}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="273" y="0" width="105" height="23" uuid="d6ef0c88-d53e-404f-ada6-0befde497499">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="026994a6-2dea-4ae8-99b5-00da08abb375"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dudau}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="378" y="0" width="105" height="23" uuid="ffc2e493-35e3-4866-9fec-1bfeb6a95665">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="9ea21aad-7922-475d-8ac0-6bd04a18b8fd"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ducuoi}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="483" y="0" width="80" height="23" uuid="2c98499d-25e5-43df-b9b4-3a8f5af862cf">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="dd6c0c58-40a2-476e-b6f9-99b4be9c8fde"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<pen lineWidth="0.75"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{laithang}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="25">
			<textField>
				<reportElement x="-5" y="0" width="278" height="25" uuid="09004dee-e51d-44b3-b7fc-78624b12861d">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Bottom"/>
				<textFieldExpression><![CDATA["- "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="273" y="0" width="290" height="25" uuid="812819cb-f6c9-4fea-86ff-d51a73a022cf">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Bottom"/>
				<textFieldExpression><![CDATA["/" +$V{PAGE_NUMBER}+ " -"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="45">
			<staticText>
				<reportElement x="-5" y="25" width="185" height="20" uuid="9ce97cb0-4e7a-430d-84f3-9737bee0e08a">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Ngi lp]]></text>
			</staticText>
			<staticText>
				<reportElement x="180" y="25" width="198" height="20" uuid="f5b74fb4-7c78-420b-9b3e-4a4419167667">
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Kim sot]]></text>
			</staticText>
			<staticText>
				<reportElement x="378" y="25" width="185" height="20" uuid="4a35bbd3-b1a4-4af5-9379-123274a8d82e">
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Gim c]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH:mm">
				<reportElement x="-5" y="5" width="568" height="20" uuid="296052bf-a25b-4799-afd7-9003409e8e09">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="11"/>
				</textElement>
				<textFieldExpression><![CDATA["Ngy in: "+ new SimpleDateFormat("dd/MM/yyyy hh:mm").format(new Date())]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
